OBJECT Page 1309 O365 Getting Started
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Getting Started;
    SourceTable="O365 Getting Started";
    PageType=NavigatePage;
    OnInit=BEGIN
             SETRANGE("User ID",USERID);
           END;

    OnOpenPage=BEGIN
                 if not AlreadyShown then begin
                   FirstRun := true;
                   MarkAsShown;
                 end;

                 if UserTours.IsAvailable and O365GettingStartedMgt.AreUserToursEnabled then begin
                   UserTours := UserTours.Create;
                   UserTours.StopUserTour;
                 end;

                 MaxNumberOfSteps := 5;
                 LastPageIndex := 9;
                 LoadImages;
               END;

    OnQueryClosePage=BEGIN
                       if DisableConfirmationOnPageClose then
                         exit(true);

                       "Tour in Progress" := false;
                       MODIFY;

                       if UserTours.IsAvailable and O365GettingStartedMgt.AreUserToursEnabled then
                         UserTours.StartUserTour(O365GettingStartedMgt.GetReturnToGettingStartedTourID);

                       exit(true);
                     END;

    OnAfterGetCurrRecord=BEGIN
                           if CurrentPage = 0 then
                             CurrentPage := "Current Page";

                           if CurrentPage = 1 then
                             NextPageVisible := not FirstRun
                           else
                             NextPageVisible := CurrentPage < LastPageIndex;

                           UpdatePageControls;
                           SetPageCaption;
                         END;

    ActionList=ACTIONS
    {
      { 19      ;    ;ActionContainer;
                      Name=ActionContainer19;
                      ActionContainerType=ActionItems }
      { 45      ;1   ;Action    ;
                      Name=SkipWizard;
                      CaptionML=ENU=Not now;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=CurrentPage = 1;
                      InFooterBar=true;
                      OnAction=BEGIN
                                 MarkWizardAsDone;
                                 DisableConfirmationOnPageClose := false;
                                 CurrPage.CLOSE;
                               END;
                                }
      { 14      ;1   ;Action    ;
                      Name=GetStarted;
                      CaptionML=ENU=Get started;
                      ApplicationArea=#Basic,#Suite;
                      Visible=(CurrentPage = 1) AND FirstRun;
                      InFooterBar=true;
                      Image=Start;
                      OnAction=VAR
                                 ConfPersonalizationMgt@1000 : Codeunit "Conf./Personalization Mgt.";
                                 AccountantProfile@1001 : Code[30];
                               BEGIN
                                 AccountantProfile := AccountantTxt;
                                 if ConfPersonalizationMgt.GetCurrentProfileIDNoError = AccountantProfile then
                                   InvokeWalkMeButton(O365GettingStartedMgt.GetAccountantTourID)
                                 else
                                   InvokeWalkMeButton(O365GettingStartedMgt.GetGettingStartedTourID);
                               END;
                                }
      { 54      ;1   ;Action    ;
                      Name=GetStartedSecondView;
                      CaptionML=ENU=Show me welcome tour;
                      ApplicationArea=#Basic,#Suite;
                      Visible=(CurrentPage = 1) AND (NOT FirstRun);
                      InFooterBar=true;
                      Image=NextRecord;
                      OnAction=VAR
                                 ConfPersonalizationMgt@1000 : Codeunit "Conf./Personalization Mgt.";
                                 AccountantProfile@1001 : Code[30];
                               BEGIN
                                 AccountantProfile := AccountantTxt;
                                 if ConfPersonalizationMgt.GetCurrentProfileIDNoError = AccountantProfile then
                                   InvokeWalkMeButton(O365GettingStartedMgt.GetAccountantTourID)
                                 else
                                   InvokeWalkMeButton(O365GettingStartedMgt.GetGettingStartedTourID);
                               END;
                                }
      { 4       ;1   ;Action    ;
                      Name=Back;
                      CaptionML=ENU=Go Back;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=(CurrentPage > 1) AND (CurrentPage < LastPageIndex);
                      InFooterBar=true;
                      Image=PreviousRecord;
                      OnAction=BEGIN
                                 CurrentPage := GetNextPageID(-1,CurrentPage);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 53      ;1   ;Action    ;
                      Name=BackLastPage;
                      CaptionML=ENU=Go Back;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=CurrentPage = LastPageIndex;
                      InFooterBar=true;
                      OnAction=BEGIN
                                 CurrentPage := GetNextPageID(-1,CurrentPage);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 13      ;1   ;Action    ;
                      Name=ShowMeInvoicing;
                      CaptionML=ENU=Show me Invoicing;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=CurrentPage = 2;
                      InFooterBar=true;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 InvokeWalkMeButton(O365GettingStartedMgt.GetInvoicingTourID);
                               END;
                                }
      { 7       ;1   ;Action    ;
                      Name=ShowMePurchasing;
                      CaptionML=ENU=Show me Purchasing;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=CurrentPage = 3;
                      InFooterBar=true;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 InvokeWalkMeButton(-1);
                               END;
                                }
      { 46      ;1   ;Action    ;
                      Name=ShowMeInventory;
                      CaptionML=ENU=Show me Inventory;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=CurrentPage = 4;
                      InFooterBar=true;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 InvokeWalkMeButton(-1);
                               END;
                                }
      { 8       ;1   ;Action    ;
                      Name=ShowMeReporting;
                      CaptionML=ENU=Show me Reporting;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=CurrentPage = 5;
                      InFooterBar=true;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 InvokeWalkMeButton(O365GettingStartedMgt.GetReportingTourID);
                               END;
                                }
      { 51      ;1   ;Action    ;
                      Name=SetUpInOutlook;
                      CaptionML=ENU=Set up in Outlook;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=CurrentPage = 6;
                      InFooterBar=true;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 AddToOutlook;
                               END;
                                }
      { 52      ;1   ;Action    ;
                      Name=SetupDevice;
                      CaptionML=ENU=Show me how;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=CurrentPage = 7;
                      InFooterBar=true;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 PAGE.RUNMODAL(PAGE::"O365 Device Setup");
                               END;
                                }
      { 10      ;1   ;Action    ;
                      Name=ShowMeImport;
                      CaptionML=ENU=Show me Import;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=CurrentPage = 8;
                      InFooterBar=true;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 InvokeWalkMeButton(-1);
                               END;
                                }
      { 3       ;1   ;Action    ;
                      Name=Next;
                      CaptionML=ENU=Next;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=NextPageVisible;
                      InFooterBar=true;
                      Image=Approve;
                      OnAction=BEGIN
                                 CurrentPage := GetNextPageID(1,CurrentPage);
                                 CurrPage.UPDATE;
                               END;
                                }
      { 34      ;1   ;Action    ;
                      Name=Done;
                      CaptionML=ENU=Done;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Visible=CurrentPage = LastPageIndex;
                      InFooterBar=true;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 MarkWizardAsDone;
                                 CurrPage.CLOSE;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                Name=Container1;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group2;
                Visible=CurrentPage = 1;
                Editable=FALSE;
                GroupType=Group }

    { 35  ;2   ;Field     ;
                Name=Image1;
                CaptionML=ENU=Image1;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaResourcesPageData1."Media Reference";
                Editable=FALSE;
                ShowCaption=false }

    { 5   ;2   ;Group     ;
                Name=Page1Group;
                CaptionML=ENU=Welcome to Dynamics 365 for Finance and Operations. Try it out!;
                GroupType=Group }

    { 16  ;3   ;Field     ;
                Name=BodyText1;
                CaptionML=ENU=BodyText1;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BodyText;
                Editable=FALSE;
                MultiLine=true;
                ImplicitType=BigText;
                ShowCaption=false }

    { 17  ;1   ;Group     ;
                Name=Group17;
                Visible=CurrentPage = 2;
                Editable=FALSE;
                GroupType=Group }

    { 36  ;2   ;Field     ;
                Name=Image2;
                CaptionML=ENU=Image2;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaResourcesPageData2."Media Reference";
                Editable=FALSE;
                ShowCaption=false }

    { 15  ;2   ;Group     ;
                Name=Page2Group;
                CaptionML=ENU=Grow sales, manage your customers, and make billing easy;
                GroupType=Group }

    { 12  ;3   ;Field     ;
                Name=BodyText2;
                CaptionML=ENU=BodyText2;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BodyText;
                Editable=FALSE;
                MultiLine=true;
                ImplicitType=BigText;
                ShowCaption=false }

    { 21  ;1   ;Group     ;
                Name=Group21;
                Visible=CurrentPage = 3;
                Editable=FALSE;
                GroupType=Group }

    { 37  ;2   ;Field     ;
                Name=Image3;
                CaptionML=ENU=Image3;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaResourcesPageData3."Media Reference";
                Editable=FALSE;
                ShowCaption=false }

    { 20  ;2   ;Group     ;
                Name=Page3Group;
                CaptionML=ENU=Managing your vendors;
                GroupType=Group }

    { 18  ;3   ;Field     ;
                Name=BodyText3;
                CaptionML=ENU=BodyText3;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BodyText;
                Editable=FALSE;
                MultiLine=true;
                ImplicitType=BigText;
                ShowCaption=false }

    { 24  ;1   ;Group     ;
                Name=Group24;
                Visible=CurrentPage = 4;
                Editable=FALSE;
                GroupType=Group }

    { 38  ;2   ;Field     ;
                Name=Image4;
                CaptionML=ENU=Image4;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaResourcesPageData4."Media Reference";
                Editable=FALSE;
                ShowCaption=false }

    { 23  ;2   ;Group     ;
                Name=Page4Group;
                CaptionML=ENU=Do you keep stock and need to track your inventory?;
                GroupType=Group }

    { 22  ;3   ;Field     ;
                Name=BodyText4;
                CaptionML=ENU=BodyText4;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BodyText;
                Editable=FALSE;
                MultiLine=true;
                ImplicitType=BigText;
                ShowCaption=false }

    { 27  ;1   ;Group     ;
                Name=Group27;
                Visible=CurrentPage = 5;
                Editable=FALSE;
                GroupType=Group }

    { 39  ;2   ;Field     ;
                Name=Image5;
                CaptionML=ENU=Image5;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaResourcesPageData5."Media Reference";
                Editable=FALSE;
                ShowCaption=false }

    { 26  ;2   ;Group     ;
                Name=Page5Group;
                CaptionML=ENU=Simplify reporting;
                GroupType=Group }

    { 25  ;3   ;Field     ;
                Name=BodyText5;
                CaptionML=ENU=BodyText5;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BodyText;
                Editable=FALSE;
                MultiLine=true;
                ImplicitType=BigText;
                ShowCaption=false }

    { 49  ;1   ;Group     ;
                Name=Group49;
                Visible=CurrentPage = 6;
                Editable=FALSE;
                GroupType=Group }

    { 48  ;2   ;Field     ;
                Name=Image6;
                CaptionML=ENU=Image6;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaResourcesPageData6."Media Reference";
                Editable=FALSE;
                ShowCaption=false }

    { 47  ;2   ;Group     ;
                Name=Page6Group;
                CaptionML=ENU=Run your business within Office 365;
                GroupType=Group }

    { 9   ;3   ;Field     ;
                Name=BodyText6;
                CaptionML=ENU=BodyText6;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BodyText;
                Editable=FALSE;
                MultiLine=true;
                ImplicitType=BigText;
                ShowCaption=false }

    { 30  ;1   ;Group     ;
                Name=Group30;
                Visible=CurrentPage = 7;
                Editable=FALSE;
                GroupType=Group }

    { 40  ;2   ;Field     ;
                Name=Image7;
                CaptionML=ENU=Image7;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaResourcesPageData7."Media Reference";
                Editable=FALSE;
                ShowCaption=false }

    { 29  ;2   ;Group     ;
                Name=Page7Group;
                CaptionML=ENU=Do business anywhere;
                GroupType=Group }

    { 28  ;3   ;Field     ;
                Name=BodyText7;
                CaptionML=ENU=BodyText7;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BodyText;
                Editable=FALSE;
                MultiLine=true;
                ImplicitType=BigText;
                ShowCaption=false }

    { 33  ;1   ;Group     ;
                Name=Group33;
                Visible=CurrentPage = 8;
                Editable=FALSE;
                GroupType=Group }

    { 41  ;2   ;Field     ;
                Name=Image8;
                CaptionML=ENU=Image8;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaResourcesPageData8."Media Reference";
                Editable=FALSE;
                ShowCaption=false }

    { 32  ;2   ;Group     ;
                Name=Page8Group;
                CaptionML=ENU=Easily import data from your current accounting system;
                GroupType=Group }

    { 31  ;3   ;Field     ;
                Name=BodyText8;
                CaptionML=ENU=BodyText8;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BodyText;
                Editable=FALSE;
                MultiLine=true;
                ImplicitType=BigText;
                ShowCaption=false }

    { 44  ;1   ;Group     ;
                Name=Group44;
                Visible=CurrentPage = 9;
                Editable=FALSE;
                GroupType=Group }

    { 43  ;2   ;Field     ;
                Name=Image9;
                CaptionML=ENU=Image9;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaResourcesPageData9."Media Reference";
                Editable=FALSE;
                ShowCaption=false }

    { 42  ;2   ;Group     ;
                Name=Page9Group;
                CaptionML=ENU=Try it out;
                GroupType=Group }

    { 6   ;3   ;Field     ;
                Name=BodyText9;
                CaptionML=ENU=BodyText9;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=BodyText;
                Editable=FALSE;
                MultiLine=true;
                ImplicitType=BigText;
                ShowCaption=false }

    { 11  ;2   ;Field     ;
                Name=DocumentationLink;
                CaptionML=ENU=DocumentationLink;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=DocumentationLinkCaptionLbl;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              HYPERLINK(DocumentationLinkCaptionLbl);
                            END;

                ImplicitType=TextConst;
                ShowCaption=false }

  }
  CODE
  {
    VAR
      O365GettingStartedPageData1@1000 : Record "O365 Getting Started Page Data";
      O365GettingStartedPageData2@1007 : Record "O365 Getting Started Page Data";
      O365GettingStartedPageData3@1009 : Record "O365 Getting Started Page Data";
      O365GettingStartedPageData4@1010 : Record "O365 Getting Started Page Data";
      O365GettingStartedPageData5@1014 : Record "O365 Getting Started Page Data";
      O365GettingStartedPageData6@1013 : Record "O365 Getting Started Page Data";
      O365GettingStartedPageData7@1012 : Record "O365 Getting Started Page Data";
      O365GettingStartedPageData8@1011 : Record "O365 Getting Started Page Data";
      O365GettingStartedPageData9@1015 : Record "O365 Getting Started Page Data";
      MediaResourcesPageData1@1023 : Record "Media Resources";
      MediaResourcesPageData2@1024 : Record "Media Resources";
      MediaResourcesPageData3@1025 : Record "Media Resources";
      MediaResourcesPageData4@1027 : Record "Media Resources";
      MediaResourcesPageData5@1031 : Record "Media Resources";
      MediaResourcesPageData6@1030 : Record "Media Resources";
      MediaResourcesPageData7@1029 : Record "Media Resources";
      MediaResourcesPageData8@1028 : Record "Media Resources";
      MediaResourcesPageData9@1032 : Record "Media Resources";
      O365GettingStartedMgt@1002 : Codeunit "O365 Getting Started Mgt.";
      UserTours@1019 : DotNet "'Microsoft.Dynamics.Nav.ClientExtensions, Version=11.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.Capabilities.UserTours" WITHEVENTS RUNONCLIENT;
      CurrentPage@1003 : Integer INDATASET;
      NextPageVisible@1004 : Boolean;
      FirstRun@1001 : Boolean;
      BodyText@1005 : BigText;
      LastPageIndex@1006 : Integer;
      MaxNumberOfSteps@1021 : Integer;
      DisableConfirmationOnPageClose@1026 : Boolean;
      UserToursAreNotAvailableMsg@1016 : TextConst 'ENU=Tours are not available for this installation.';
      GettingStartedPageTxt@1017 : TextConst 'ENU=GETTING STARTED';
      StepCaptionTxt@1020 : TextConst '@@@=%1 Current page number, %2 total number of pages;ENU=(%1 OF %2)';
      OutlookSetupCompleteMsg@1008 : TextConst '@@@=%1 Product name;ENU=Your Business Inbox is all set up. When you''re ready, you can start using %1 in Outlook.';
      DocumentationLinkCaptionLbl@1022 : TextConst '@@@={Locked};ENU=https://aka.ms/learnbusinessedition';
      AccountantTxt@1018 : TextConst 'ENU=Accountant';

    LOCAL PROCEDURE InvokeWalkMeButton@1006(TourID@1000 : Integer);
    BEGIN
      if (not UserTours.IsAvailable) or (not O365GettingStartedMgt.AreUserToursEnabled) then begin
        MESSAGE(UserToursAreNotAvailableMsg);
        CurrPage.CLOSE;
        exit;
      end;

      if (TourID <> O365GettingStartedMgt.GetWizardDoneTourID) and
         (TourID <> O365GettingStartedMgt.GetChangeCompanyTourID)
      then begin
        "Current Page" := CurrentPage;
        "Tour in Progress" := true;
        MODIFY;
      end;

      UserTours.StartUserTour(TourID);
      DisableConfirmationOnPageClose := true;
      CurrPage.CLOSE;
    END;

    LOCAL PROCEDURE UpdatePageControls@1001();
    BEGIN
      GetBodyTextForCurrentPage;
    END;

    LOCAL PROCEDURE MarkWizardAsDone@1007();
    BEGIN
      "Tour in Progress" := false;
      "Tour Completed" := true;
      MODIFY;

      if UserTours.IsAvailable and O365GettingStartedMgt.AreUserToursEnabled then
        UserTours.StopNotifyShowTourWizard;
    END;

    LOCAL PROCEDURE GetBodyTextForCurrentPage@1002();
    VAR
      BodyTextO365GettingStartedPageData@1001 : Record "O365 Getting Started Page Data";
      MediaResourcesMgt@1000 : Codeunit "Media Resources Mgt.";
      TempBodyText@1003 : Text;
    BEGIN
      if BodyTextO365GettingStartedPageData.GetPageBodyText(BodyTextO365GettingStartedPageData,CurrentPage,PAGE::"O365 Getting Started") then begin
        TempBodyText := MediaResourcesMgt.ReadTextFromMediaResource(BodyTextO365GettingStartedPageData."Media Resources Ref");
        if TempBodyText = '' then
          exit;
        CLEAR(BodyText);
        BodyText.ADDTEXT(STRSUBSTNO(TempBodyText,PRODUCTNAME.MARKETING));
      end;
    END;

    LOCAL PROCEDURE LoadImages@1004();
    VAR
      Index@1000 : Integer;
    BEGIN
      Index := 1;
      LoadImage(O365GettingStartedPageData1,Index);
      if MediaResourcesPageData1.GET(O365GettingStartedPageData1."Media Resources Ref") then;
      LoadImage(O365GettingStartedPageData2,Index);
      if MediaResourcesPageData2.GET(O365GettingStartedPageData2."Media Resources Ref") then;
      LoadImage(O365GettingStartedPageData3,Index);
      if MediaResourcesPageData3.GET(O365GettingStartedPageData3."Media Resources Ref") then;
      LoadImage(O365GettingStartedPageData4,Index);
      if MediaResourcesPageData4.GET(O365GettingStartedPageData4."Media Resources Ref") then;
      LoadImage(O365GettingStartedPageData5,Index);
      if MediaResourcesPageData5.GET(O365GettingStartedPageData5."Media Resources Ref") then;
      LoadImage(O365GettingStartedPageData6,Index);
      if MediaResourcesPageData6.GET(O365GettingStartedPageData6."Media Resources Ref") then;
      LoadImage(O365GettingStartedPageData7,Index);
      if MediaResourcesPageData7.GET(O365GettingStartedPageData7."Media Resources Ref") then;
      LoadImage(O365GettingStartedPageData8,Index);
      if MediaResourcesPageData8.GET(O365GettingStartedPageData8."Media Resources Ref") then;
      LoadImage(O365GettingStartedPageData9,Index);
      if MediaResourcesPageData9.GET(O365GettingStartedPageData9."Media Resources Ref") then;
    END;

    LOCAL PROCEDURE LoadImage@1005(VAR O365GettingStartedPageData@1000 : Record "O365 Getting Started Page Data";VAR CurrentPageID@1001 : Integer);
    BEGIN
      O365GettingStartedPageData.GetPageImage(O365GettingStartedPageData,CurrentPageID,PAGE::"O365 Getting Started");
      CurrentPageID += 1;
    END;

    [External]
    PROCEDURE GetNextPageID@1014(Increment@1000 : Integer;CurrentPageID@1002 : Integer) NextPageID : Integer;
    BEGIN
      NextPageID := CurrentPageID + Increment;

      // Pages 3,4 and 8 are currently skipped in the wizard. They should be removed.
      if NextPageID in [3,4] then
        NextPageID += Increment * 2;

      if NextPageID in [8] then
        NextPageID += Increment;
    END;

    LOCAL PROCEDURE SetPageCaption@1003();
    VAR
      StepIndex@1000 : Integer;
    BEGIN
      CurrPage.CAPTION := GettingStartedPageTxt;
      if CurrentPage in [1,LastPageIndex] then
        exit;

      StepIndex := CurrentPage;

      if CurrentPage in [5,6,7] then
        StepIndex := CurrentPage - 2;

      CurrPage.CAPTION := STRSUBSTNO('%1 %2',GettingStartedPageTxt,STRSUBSTNO(StepCaptionTxt,StepIndex,MaxNumberOfSteps));
    END;

    LOCAL PROCEDURE AddToOutlook@1008();
    VAR
      AssistedSetup@1003 : Record "Assisted Setup";
      OfficeAddin@1001 : Record "Office Add-in";
      ExchangeAddinSetup@1002 : Codeunit "Exchange Add-in Setup";
    BEGIN
      if ExchangeAddinSetup.PromptForCredentials then begin
        ExchangeAddinSetup.DeployAddins(OfficeAddin);
        ExchangeAddinSetup.DeploySampleEmails;
        AssistedSetup.SetStatus(PAGE::"Exchange Setup Wizard",AssistedSetup.Status::Completed);
        MESSAGE(STRSUBSTNO(OutlookSetupCompleteMsg,PRODUCTNAME.FULL));
      end;
    END;

    EVENT UserTours@1019::ShowTourWizard@13(hasTourCompleted@1000 : Boolean);
    BEGIN
    END;

    EVENT UserTours@1019::IsTourInProgressResultReady@14(isInProgress@1000 : Boolean);
    BEGIN
    END;

    BEGIN
    END.
  }
}

