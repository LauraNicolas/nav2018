OBJECT Page 1122 Chart of Cost Centers
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Chart of Cost Centers;
    SourceTable="Cost Center";
    DelayedInsert=true;
    SourceTableView=SORTING("Sorting Order");
    PageType=List;
    CardPageID="Cost Center Card";
    OnAfterGetRecord=BEGIN
                       NameIndent := 0;
                       CodeOnFormat;
                       NameOnFormat;
                       NetChangeOnFormat;
                       BalanceatDateC15OnFormat;
                       BalancetoAllocateOnFormat;
                     END;

    OnDeleteRecord=BEGIN
                     CurrPage.SETSELECTIONFILTER(Rec);
                     ConfirmDeleteIfEntriesExist(Rec,false);
                     RESET;
                   END;

    ActionList=ACTIONS
    {
      { 1       ;0   ;ActionContainer;
                      Name=ActionContainer1;
                      ActionContainerType=RelatedInformation }
      { 2       ;1   ;ActionGroup;
                      Name=&Cost Center;
                      CaptionML=ENU=&Cost Center;
                      Image=CostCenter }
      { 3       ;2   ;Action    ;
                      Name=Cost E&ntries;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=Cost E&ntries;
                      ToolTipML=ENU=View cost entries, which can come from sources such as automatic transfer of general ledger entries to cost entries, manual posting for pure cost entries, internal charges, and manual allocations, and automatic allocation postings for actual costs.;
                      ApplicationArea=#CostAccounting;
                      RunObject=Page "Cost Entries";
                      RunPageView=SORTING("Cost Center Code","Cost Type No.",Allocated,"Posting Date");
                      RunPageLink="Cost Center Code"=FIELD(Code);
                      Image=CostEntries }
      { 4       ;2   ;Separator ;
                      Name=Separator4 }
      { 5       ;2   ;Action    ;
                      Name=&Balance;
                      ShortCutKey=F7;
                      CaptionML=ENU=&Balance;
                      ToolTipML=ENU=View a summary of the balance at date or the net change for different time periods for the cost center that you select. You can select different time intervals and set filters on the cost centers and cost objects that you want to see.;
                      ApplicationArea=#CostAccounting;
                      Image=Balance;
                      OnAction=BEGIN
                                 if Totaling = '' then
                                   CostType.SETFILTER("Cost Center Filter",Code)
                                 else
                                   CostType.SETFILTER("Cost Center Filter",Totaling);

                                 PAGE.RUN(PAGE::"Cost Type Balance",CostType);
                               END;
                                }
      { 6       ;0   ;ActionContainer;
                      Name=ActionContainer6;
                      ActionContainerType=ActionItems }
      { 7       ;1   ;ActionGroup;
                      Name=F&unctions;
                      CaptionML=ENU=F&unctions;
                      Image=Action }
      { 8       ;2   ;Action    ;
                      Name=I&ndent Cost Centers;
                      CaptionML=ENU=I&ndent Cost Centers;
                      ToolTipML=ENU=Indent the selected lines.;
                      ApplicationArea=#CostAccounting;
                      Promoted=true;
                      Image=IndentChartOfAccounts;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CostAccMgt.IndentCostCentersYN;
                               END;
                                }
      { 9       ;2   ;Action    ;
                      Name=Get Cost Centers From Dimension;
                      CaptionML=ENU=Get Cost Centers From Dimension;
                      ToolTipML=ENU=Transfer dimension values to the chart of cost centers.;
                      ApplicationArea=#CostAccounting;
                      Promoted=true;
                      Image=ChangeTo;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CostAccMgt.CreateCostCenters;
                               END;
                                }
      { 11      ;1   ;Action    ;
                      Name=Dimension Values;
                      AccessByPermission=TableData Dimension=R;
                      CaptionML=ENU=Dimension Values;
                      ToolTipML=ENU=View or edit the dimension values for the current dimension.;
                      ApplicationArea=#Dimensions;
                      Promoted=true;
                      Image=Dimensions;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 DimValue@1000 : Record "Dimension Value";
                               BEGIN
                                 CostAccSetup.GET;
                                 DimValue.SETRANGE("Dimension Code",CostAccSetup."Cost Center Dimension");
                                 PAGE.RUN(0,DimValue);
                               END;
                                }
      { 12      ;0   ;ActionContainer;
                      Name=ActionContainer12;
                      ActionContainerType=Reports }
      { 14      ;1   ;Action    ;
                      Name=Cost Center with Budget;
                      CaptionML=ENU=Cost Center with Budget;
                      ToolTipML=ENU=View a comparison of the balance to the budget figures and calculates the variance and the percent variance in the current accounting period, the accumulated accounting period, and the fiscal year.;
                      ApplicationArea=#CostAccounting;
                      RunObject=Report "Cost Acctg. Balance/Budget";
                      Promoted=false;
                      Image=Report;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 15  ;0   ;Container ;
                Name=Container15;
                ContainerType=ContentArea }

    { 16  ;1   ;Group     ;
                Name=Group16;
                IndentationColumnName=NameIndent;
                IndentationControls=Name;
                GroupType=Repeater }

    { 17  ;2   ;Field     ;
                Name=Code;
                ToolTipML=ENU=Specifies the code for the cost center.;
                ApplicationArea=#CostAccounting;
                SourceExpr=Code;
                Style=Strong;
                StyleExpr=Emphasize;
                ImplicitType=Code20 }

    { 18  ;2   ;Field     ;
                Name=Name;
                ToolTipML=ENU=Specifies the name of the cost center.;
                ApplicationArea=#CostAccounting;
                SourceExpr=Name;
                Style=Strong;
                StyleExpr=Emphasize;
                ImplicitType=Text50 }

    { 19  ;2   ;Field     ;
                Name=Line Type;
                ToolTipML=ENU=Specifies the purpose of the cost object, such as Cost Object, Heading, or Begin-Total. Newly created cost objects are automatically assigned the Cost Object type, but you can change this.;
                ApplicationArea=#CostAccounting;
                SourceExpr="Line Type";
                ImplicitType=Option }

    { 20  ;2   ;Field     ;
                Name=Totaling;
                ToolTipML=ENU=Specifies subtotals.;
                ApplicationArea=#CostAccounting;
                SourceExpr=Totaling;
                ImplicitType=Text250 }

    { 21  ;2   ;Field     ;
                Name=Sorting Order;
                ToolTipML=ENU=Specifies the sorting order of the cost centers.;
                ApplicationArea=#CostAccounting;
                SourceExpr="Sorting Order";
                ImplicitType=Code10 }

    { 23  ;2   ;Field     ;
                Name=Net Change;
                ToolTipML=ENU=Specifies the net change in the account balance during the time period in the Date Filter field.;
                ApplicationArea=#CostAccounting;
                SourceExpr="Net Change";
                Style=Strong;
                StyleExpr=Emphasize;
                ImplicitType=Decimal }

    { 24  ;2   ;Field     ;
                Name=Balance at Date;
                ToolTipML=ENU=Specifies the cost type balance on the last date that is included in the Date Filter field. The contents of the field are calculated by using the entries in the Amount field in the Cost Entry table.;
                ApplicationArea=#CostAccounting;
                SourceExpr="Balance at Date";
                Visible=FALSE;
                Style=Strong;
                StyleExpr=Emphasize;
                ImplicitType=Decimal }

    { 25  ;2   ;Field     ;
                Name=Balance to Allocate;
                ToolTipML=ENU=Specifies the balance that has not yet been allocated. The entry in the Allocated field determines if the entry is included in the Balance to Allocate field. The value in the Allocated field is set automatically during the cost allocation.;
                ApplicationArea=#CostAccounting;
                SourceExpr="Balance to Allocate";
                Style=Strong;
                StyleExpr=Emphasize;
                ImplicitType=Decimal }

    { 26  ;2   ;Field     ;
                Name=Cost Subtype;
                ToolTipML=ENU=Specifies the subtype of the cost center. This is an information field and is not used for any other purposes. Choose the field to select the cost subtype.;
                ApplicationArea=#CostAccounting;
                SourceExpr="Cost Subtype";
                ImplicitType=Option }

    { 27  ;2   ;Field     ;
                Name=Responsible Person;
                ToolTipML=ENU=Specifies the person who is responsible for the chart of cost centers.;
                ApplicationArea=#CostAccounting;
                SourceExpr="Responsible Person";
                ImplicitType=Code50 }

    { 28  ;2   ;Field     ;
                Name=Blocked;
                ToolTipML=ENU=Specifies if the record is blocked from being used.;
                ApplicationArea=#CostAccounting;
                SourceExpr=Blocked;
                ImplicitType=Boolean }

    { 29  ;2   ;Field     ;
                Name=New Page;
                ToolTipML=ENU=Specifies if you want a new page to start immediately after this cost center when you print the chart of cash flow accounts.;
                ApplicationArea=#CostAccounting;
                SourceExpr="New Page";
                Visible=FALSE;
                ImplicitType=Boolean }

    { 30  ;2   ;Field     ;
                Name=Blank Line;
                ToolTipML=ENU=Specifies whether you want a blank line to appear immediately after this cost center when you print the chart of cost centers. The New Page, Blank Line, and Indentation fields define the layout of the chart of cost centers.;
                ApplicationArea=#CostAccounting;
                SourceExpr="Blank Line";
                Visible=FALSE;
                ImplicitType=Boolean }

    { 31  ;2   ;Field     ;
                Name=Comment;
                ToolTipML=ENU=Specifies a comment that applies.;
                ApplicationArea=#CostAccounting;
                SourceExpr=Comment;
                Visible=FALSE;
                ImplicitType=Text50 }

  }
  CODE
  {
    VAR
      CostType@1000 : Record "Cost Type";
      CostAccSetup@1008 : Record "Cost Accounting Setup";
      CostAccMgt@1001 : Codeunit "Cost Account Mgt";
      Emphasize@1002 : Boolean INDATASET;
      NameIndent@1004 : Integer INDATASET;

    LOCAL PROCEDURE CodeOnFormat@1();
    BEGIN
      Emphasize := "Line Type" <> "Line Type"::"Cost Center";
    END;

    LOCAL PROCEDURE NameOnFormat@2();
    BEGIN
      NameIndent := Indentation;
      Emphasize := "Line Type" <> "Line Type"::"Cost Center";
    END;

    LOCAL PROCEDURE NetChangeOnFormat@3();
    BEGIN
      Emphasize := "Line Type" <> "Line Type"::"Cost Center";
    END;

    LOCAL PROCEDURE BalanceatDateC15OnFormat@4();
    BEGIN
      Emphasize := "Line Type" <> "Line Type"::"Cost Center";
    END;

    LOCAL PROCEDURE BalancetoAllocateOnFormat@5();
    BEGIN
      Emphasize := "Line Type" <> "Line Type"::"Cost Center";
    END;

    [Internal]
    PROCEDURE GetSelectionFilter@6() : Text;
    VAR
      CostCenter@1004 : Record "Cost Center";
      SelectionFilterManagement@1001 : Codeunit SelectionFilterManagement;
    BEGIN
      CurrPage.SETSELECTIONFILTER(CostCenter);
      exit(SelectionFilterManagement.GetSelectionFilterForCostCenter(CostCenter));
    END;

    BEGIN
    END.
  }
}

