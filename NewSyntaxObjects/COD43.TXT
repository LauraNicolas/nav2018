OBJECT Codeunit 43 LanguageManagement
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      SavedGlobalLanguageID@1000 : Integer;

    [Internal]
    PROCEDURE SetGlobalLanguage@1();
    VAR
      TempLanguage@1001 : TEMPORARY Record "Windows Language";
    BEGIN
      GetApplicationLanguages(TempLanguage);

      with TempLanguage do begin
        SETCURRENTKEY(Name);
        if GET(GLOBALLANGUAGE) then;
        PAGE.RUN(PAGE::"Application Languages",TempLanguage);
      end;
    END;

    PROCEDURE GetApplicationLanguages@2(VAR TempLanguage@1034 : TEMPORARY Record "Windows Language");
    VAR
      Language@1035 : Record "Windows Language";
    BEGIN
      with Language do begin
        GetLanguageFilters(Language);
        if FINDSET then
          repeat
            TempLanguage := Language;
            TempLanguage.INSERT;
          until NEXT = 0;
      end;
    END;

    [Internal]
    PROCEDURE ValidateApplicationLanguage@3(LanguageID@1037 : Integer);
    VAR
      TempLanguage@1038 : TEMPORARY Record "Windows Language";
    BEGIN
      GetApplicationLanguages(TempLanguage);

      with TempLanguage do begin
        SETRANGE("Language ID",LanguageID);
        FINDFIRST;
      end;
    END;

    [Internal]
    PROCEDURE LookupApplicationLanguage@4(VAR LanguageID@1040 : Integer);
    VAR
      TempLanguage@1039 : TEMPORARY Record "Windows Language";
    BEGIN
      GetApplicationLanguages(TempLanguage);

      with TempLanguage do begin
        if GET(LanguageID) then;
        if PAGE.RUNMODAL(PAGE::"Windows Languages",TempLanguage) = ACTION::LookupOK then
          LanguageID := "Language ID";
      end;
    END;

    [External]
    PROCEDURE LookupWindowsLocale@5(VAR LocaleID@1000 : Integer);
    VAR
      WindowsLanguage@1002 : Record "Windows Language";
    BEGIN
      with WindowsLanguage do begin
        SETCURRENTKEY(Name);
        if PAGE.RUNMODAL(PAGE::"Windows Languages",WindowsLanguage) = ACTION::LookupOK then
          LocaleID := "Language ID";
      end;
    END;

    PROCEDURE SetGlobalLanguageByCode@150(LanguageCode@1000 : Code[10]);
    VAR
      Language@1001 : Record Language;
    BEGIN
      if LanguageCode = '' then
        exit;
      SavedGlobalLanguageID := GLOBALLANGUAGE;
      GLOBALLANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    PROCEDURE RestoreGlobalLanguage@151();
    BEGIN
      if SavedGlobalLanguageID <> 0 then begin
        GLOBALLANGUAGE(SavedGlobalLanguageID);
        SavedGlobalLanguageID := 0;
      end;
    END;

    LOCAL PROCEDURE GetLanguageFilters@6(VAR WindowsLanguage@1000 : Record "Windows Language");
    BEGIN
      WindowsLanguage.SETRANGE("Localization Exist",true);
      WindowsLanguage.SETRANGE("Globally Enabled",true);
    END;

    BEGIN
    END.
  }
}

