OBJECT Codeunit 450 Job Queue Error Handler
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    TableNo="Job Queue Entry";
    OnRun=BEGIN
            if not DoesExistLocked then
              exit;
            SetError(GETLASTERRORTEXT);
            LogError(Rec);
          END;

  }
  CODE
  {

    LOCAL PROCEDURE LogError@1(JobQueueEntry@1000 : Record "Job Queue Entry");
    VAR
      JobQueueLogEntry@1002 : Record "Job Queue Log Entry";
    BEGIN
      with JobQueueLogEntry do begin
        SETRANGE(ID,JobQueueEntry.ID);
        SETRANGE(Status,Status::"In Process");
        if FINDFIRST then begin
          SetErrorMessage(JobQueueEntry.GetErrorMessage);
          Status := Status::Error;
          MODIFY;
        end else begin
          JobQueueEntry.InsertLogEntry(JobQueueLogEntry);
          JobQueueEntry.FinalizeLogEntry(JobQueueLogEntry);
        end;
      end;
    END;

    BEGIN
    END.
  }
}

