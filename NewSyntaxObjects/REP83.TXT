OBJECT Report 83 Change Global Dimensions
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    Permissions=TableData "G/L Entry"=imd,
                TableData "Cust. Ledger Entry"=imd,
                TableData "Vendor Ledger Entry"=imd,
                TableData "Item Ledger Entry"=imd,
                TableData "Sales Shipment Header"=imd,
                TableData "Sales Shipment Line"=imd,
                TableData "Sales Invoice Header"=imd,
                TableData "Sales Invoice Line"=imd,
                TableData "Sales Cr.Memo Header"=imd,
                TableData "Sales Cr.Memo Line"=imd,
                TableData "Purch. Rcpt. Header"=imd,
                TableData "Purch. Rcpt. Line"=imd,
                TableData "Purch. Inv. Header"=imd,
                TableData "Purch. Inv. Line"=imd,
                TableData "Purch. Cr. Memo Hdr."=imd,
                TableData "Purch. Cr. Memo Line"=imd,
                TableData "Job Ledger Entry"=imd,
                TableData "Standard Sales Line"=imd,
                TableData "Standard Purchase Line"=imd,
                TableData "Res. Ledger Entry"=imd,
                TableData "Bank Account Ledger Entry"=imd,
                TableData "Phys. Inventory Ledger Entry"=imd,
                TableData "Issued Reminder Header"=imd,
                TableData "Issued Fin. Charge Memo Header"=imd,
                TableData "Detailed Cust. Ledg. Entry"=imd,
                TableData "Detailed Vendor Ledg. Entry"=imd,
                TableData "Job Task"=imd,
                TableData "Job WIP Entry"=imd,
                TableData "Job WIP G/L Entry"=imd,
                TableData "Sales Header Archive"=imd,
                TableData "Sales Line Archive"=imd,
                TableData "Purchase Header Archive"=imd,
                TableData "Purchase Line Archive"=imd,
                TableData "FA Ledger Entry"=imd,
                TableData "Maintenance Ledger Entry"=imd,
                TableData "Ins. Coverage Ledger Entry"=imd,
                TableData "Value Entry"=imd,
                TableData "Capacity Ledger Entry"=imd,
                TableData "Service Ledger Entry"=imd,
                TableData "Warranty Ledger Entry"=imd,
                TableData "Service Contract Header"=imd,
                TableData "Filed Service Contract Header"=imd,
                TableData "Filed Contract Line"=imd,
                TableData "Return Shipment Header"=imd,
                TableData "Return Shipment Line"=imd,
                TableData "Return Receipt Header"=imd,
                TableData "Return Receipt Line"=imd,
                TableData "Dimensions Field Map"=imd;
    CaptionML=ENU=Change Global Dimensions;
    ProcessingOnly=true;
    OnPreReport=VAR
                  Dim@1000 : Record Dimension;
                BEGIN
                  if NewGlobalDim1Code <> GLSetup."Global Dimension 1 Code" then begin
                    ConfirmationMessage :=
                      GLSetup.FIELDCAPTION("Global Dimension 1 Code") + ' (' +
                      GLSetup.FIELDCAPTION("Shortcut Dimension 1 Code") + ')';
                    if NewGlobalDim2Code <> GLSetup."Global Dimension 2 Code" then
                      ConfirmationMessage := ConfirmationMessage + Text000 +
                        GLSetup.FIELDCAPTION("Global Dimension 2 Code") + ' (' +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 2 Code") + ')';
                  end else
                    if NewGlobalDim2Code <> GLSetup."Global Dimension 2 Code" then
                      ConfirmationMessage :=
                        GLSetup.FIELDCAPTION("Global Dimension 2 Code") + ' (' +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 2 Code") + ')';

                  if ConfirmationMessage <> '' then begin
                    if (NewGlobalDim1Code = GLSetup."Global Dimension 2 Code") and
                       (NewGlobalDim2Code = GLSetup."Global Dimension 1 Code")
                    then begin
                      MESSAGE(Text001);
                      CurrReport.QUIT;
                    end;
                    if Dim.CheckIfDimUsed(NewGlobalDim1Code,1,'','',0) then
                      ERROR(
                        Text002,
                        Dim.GetCheckDimErr,GLSetup.FIELDCAPTION("Global Dimension 1 Code"));
                    if Dim.CheckIfDimUsed(NewGlobalDim2Code,2,'','',0) then
                      ERROR(
                        Text002,
                        Dim.GetCheckDimErr,GLSetup.FIELDCAPTION("Global Dimension 2 Code"));
                    if not CONFIRM(Text003,false,ConfirmationMessage) then
                      CurrReport.QUIT;
                  end else
                    CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   if ChangeGlobalDim then begin
                     GLSetup.VALIDATE("Global Dimension 1 Code",NewGlobalDim1Code);
                     GLSetup.VALIDATE("Global Dimension 2 Code",NewGlobalDim2Code);
                     GLSetup.MODIFY(true);
                     MESSAGE(
                       Text004,
                       ConfirmationMessage);
                   end;
                 END;

  }
  DATASET
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   GLSetup.GET;
                   NewGlobalDim1Code := GLSetup."Global Dimension 1 Code";
                   NewGlobalDim2Code := GLSetup."Global Dimension 2 Code";
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  Name=Container1900000001;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  Name=Options;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  Name=Global Dimension 1 Code;
                  CaptionML=ENU=Global Dimension 1 Code;
                  ToolTipML=ENU=Specifies the dimension that is currently defined as Global Dimension 1.;
                  ApplicationArea=#Suite;
                  SourceExpr=NewGlobalDim1Code;
                  TableRelation=Dimension;
                  OnValidate=BEGIN
                               if NewGlobalDim1Code = NewGlobalDim2Code then
                                 NewGlobalDim2Code := '';
                             END;
                              }

      { 3   ;2   ;Field     ;
                  Name=Global Dimension 2 Code;
                  CaptionML=ENU=Global Dimension 2 Code;
                  ToolTipML=ENU=Specifies the dimension that is currently defined as Global Dimension 2.;
                  ApplicationArea=#Suite;
                  SourceExpr=NewGlobalDim2Code;
                  TableRelation=Dimension;
                  OnValidate=BEGIN
                               if NewGlobalDim1Code = NewGlobalDim2Code then
                                 NewGlobalDim1Code := '';
                             END;
                              }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=" and "';
      Text001@1001 : TextConst 'ENU=You must run this batch job twice to reverse the global dimensions.';
      Text002@1002 : TextConst 'ENU=%1\You cannot use it as %2.';
      Text003@1003 : TextConst 'ENU=Are you sure that you want to change:\%1?';
      Text004@1004 : TextConst 'ENU=The following dimensions have been successfully changed:\%1.';
      Text005@1005 : TextConst 'ENU=Database information\';
      Text006@1006 : TextConst 'ENU=" No. of Records        #1######\"';
      Text007@1007 : TextConst 'ENU=" Progress              @2@@@@@@@@@@@@@\"';
      Text008@1008 : TextConst 'ENU=" Estimated Ending Time #3#######################\"';
      Text009@1009 : TextConst 'ENU=Table information\';
      Text010@1010 : TextConst 'ENU=" Company               #4#######################\"';
      Text011@1011 : TextConst 'ENU=" Table                 #5#######################\"';
      Text012@1012 : TextConst 'ENU=" No. of Records        #6######\"';
      Text013@1013 : TextConst 'ENU=" Progress              @7@@@@@@@@@@@@@"';
      Text014@1014 : TextConst 'ENU=Please wait while the operation is being completed.';
      Text015@1015 : TextConst 'ENU=<Hours24>:<Minutes,2>';
      DimVal@1105 : Record "Dimension Value";
      ItemBudgetEntry@1141 : Record "Item Budget Entry";
      GLSetup@1016 : Record "General Ledger Setup";
      GLAcc@1017 : Record "G/L Account";
      GLEntry@1018 : Record "G/L Entry";
      Cust@1019 : Record Customer;
      CustLedgEntry@1020 : Record "Cust. Ledger Entry";
      DtldCustLedgEntry@1021 : Record "Detailed Cust. Ledg. Entry";
      Vend@1022 : Record Vendor;
      VendorLedgEntry@1023 : Record "Vendor Ledger Entry";
      DtldVendLedgEntry@1024 : Record "Detailed Vendor Ledg. Entry";
      Item@1113 : Record Item;
      ItemLedgEntry@1025 : Record "Item Ledger Entry";
      SalesHeader@1026 : Record "Sales Header";
      SalesLine@1027 : Record "Sales Line";
      PurchHeader@1028 : Record "Purchase Header";
      PurchLine@1029 : Record "Purchase Line";
      GenJnlLine@1030 : Record "Gen. Journal Line";
      ItemJnlLine@1031 : Record "Item Journal Line";
      GLBudgetEntry@1033 : Record "G/L Budget Entry";
      SalesShptHeader@1034 : Record "Sales Shipment Header";
      SaleShptLine@1035 : Record "Sales Shipment Line";
      SalesInvHeader@1036 : Record "Sales Invoice Header";
      SalesInvLine@1037 : Record "Sales Invoice Line";
      ReturnRcptHeader@1038 : Record "Return Receipt Header";
      ReturnRcptLine@1039 : Record "Return Receipt Line";
      SalesCrMemoHeader@1040 : Record "Sales Cr.Memo Header";
      SalesCrMemoLine@1041 : Record "Sales Cr.Memo Line";
      PurchRcptHeader@1042 : Record "Purch. Rcpt. Header";
      PurchRcptLine@1043 : Record "Purch. Rcpt. Line";
      PurchInvHeader@1044 : Record "Purch. Inv. Header";
      PurchInvLine@1045 : Record "Purch. Inv. Line";
      PurchCrMemoHeader@1046 : Record "Purch. Cr. Memo Hdr.";
      PurchCrMemoLine@1047 : Record "Purch. Cr. Memo Line";
      ServHeader@1048 : Record "Service Header";
      ServLine@1049 : Record "Service Line";
      ServShptHeader@1129 : Record "Service Shipment Header";
      ServShptLine@1128 : Record "Service Shipment Line";
      ServInvHeader@1127 : Record "Service Invoice Header";
      ServInvLine@1124 : Record "Service Invoice Line";
      ServCrMemoHeader@1131 : Record "Service Cr.Memo Header";
      ServCrMemoLine@1130 : Record "Service Cr.Memo Line";
      ReturnShptHeader@1053 : Record "Return Shipment Header";
      ReturnShptLine@1054 : Record "Return Shipment Line";
      ResGr@1055 : Record "Resource Group";
      Res@1056 : Record Resource;
      Job@1057 : Record Job;
      JobLedgEntry@1058 : Record "Job Ledger Entry";
      ResLedgEntry@1059 : Record "Res. Ledger Entry";
      StdSalesLine@1114 : Record "Standard Sales Line";
      StdPurchLine@1115 : Record "Standard Purchase Line";
      ValueEntry@1060 : Record "Value Entry";
      CapLedgEntry@1106 : Record "Capacity Ledger Entry";
      ResJnlLine@1061 : Record "Res. Journal Line";
      JobJnlLine@1062 : Record "Job Journal Line";
      GenJnlAlloc@1063 : Record "Gen. Jnl. Allocation";
      ReqLine@1064 : Record "Requisition Line";
      BankAcc@1065 : Record "Bank Account";
      BankAccLedgEntry@1066 : Record "Bank Account Ledger Entry";
      PhysInvtLedgEntry@1067 : Record "Phys. Inventory Ledger Entry";
      ReminderHeader@1068 : Record "Reminder Header";
      IssuedReminderHeader@1069 : Record "Issued Reminder Header";
      FinChrgMemoHeader@1070 : Record "Finance Charge Memo Header";
      IssuedFinChrgMemoHeader@1071 : Record "Issued Fin. Charge Memo Header";
      Employee@1072 : Record Employee;
      ProdOrder@1107 : Record "Production Order";
      ProdOrderLine@1073 : Record "Prod. Order Line";
      ProdOrderComp@1074 : Record "Prod. Order Component";
      FA@1075 : Record "Fixed Asset";
      FALedgEntry@1076 : Record "FA Ledger Entry";
      FAAlloc@1077 : Record "FA Allocation";
      FAJnlLine@1078 : Record "FA Journal Line";
      MaintenanceLedgEntry@1079 : Record "Maintenance Ledger Entry";
      Insurance@1080 : Record Insurance;
      InsCovLedgEntry@1081 : Record "Ins. Coverage Ledger Entry";
      InsuranceJnlLine@1082 : Record "Insurance Journal Line";
      RespCenter@1083 : Record "Responsibility Center";
      SalespersonPurchaser@1084 : Record "Salesperson/Purchaser";
      Campaign@1085 : Record Campaign;
      CustomerTemplate@1108 : Record "Customer Template";
      SalesHeaderArchive@1109 : Record "Sales Header Archive";
      SalesLineArchive@1110 : Record "Sales Line Archive";
      PurchHeaderArchive@1111 : Record "Purchase Header Archive";
      PurchLineArchive@1112 : Record "Purchase Line Archive";
      DimSetEntry@1050 : Record "Dimension Set Entry";
      DefaultDim@1086 : Record "Default Dimension";
      WarrantyLedgerEntry@1134 : Record "Warranty Ledger Entry";
      ServiceLedgerEntry@1118 : Record "Service Ledger Entry";
      ItemCharge@1117 : Record "Item Charge";
      TransferHeader@1116 : Record "Transfer Header";
      TransferLine@1119 : Record "Transfer Line";
      TransferShipmentHeader@1120 : Record "Transfer Shipment Header";
      TransferShipmentLine@1121 : Record "Transfer Shipment Line";
      TransferReceiptHeader@1122 : Record "Transfer Receipt Header";
      TransferReceiptLine@1123 : Record "Transfer Receipt Line";
      WorkCenter@1125 : Record "Work Center";
      PlanningComponent@1126 : Record "Planning Component";
      ServItemLine@1156 : Record "Service Item Line";
      JobTask@1155 : Record "Job Task";
      JobTaskDim@1154 : Record "Job Task Dimension";
      JobWIPEntry@1153 : Record "Job WIP Entry";
      JobWIPGLEntry@1152 : Record "Job WIP G/L Entry";
      StdGenJnlLine@1151 : Record "Standard General Journal Line";
      StdItemJnlLine@1150 : Record "Standard Item Journal Line";
      ServCtrHeader@1149 : Record "Service Contract Header";
      FiledServCtrHeader@1148 : Record "Filed Service Contract Header";
      StdServLine@1147 : Record "Standard Service Line";
      TempDefaultDimDimensionsFieldMap@1146 : TEMPORARY Record "Dimensions Field Map";
      TempDimSetDimensionsFieldMap@1145 : TEMPORARY Record "Dimensions Field Map";
      IndicatorWindow@1051 : Dialog;
      NewGlobalDim1Code@1095 : Code[20];
      NewGlobalDim2Code@1096 : Code[20];
      DatabaseRecords@1097 : Integer;
      CheckedDatabaseRecords@1098 : Integer;
      TableRecords@1099 : Integer;
      CheckedTableRecords@1100 : Integer;
      StartTime@1102 : Time;
      StartDate@1103 : Date;
      ConfirmationMessage@1104 : Text[250];

    LOCAL PROCEDURE ChangeGlobalDim@1() : Boolean;
    VAR
      DimFilter@1000 : Text[250];
      TempTableOption@1005 : 'DefaultDimTables,DimSetTables';
    BEGIN
      InitializeTablesForModification;
      OpenIndicator;
      CountRowsAndLockTable(TempDefaultDimDimensionsFieldMap);
      CountRowsAndLockTable(TempDimSetDimensionsFieldMap);
      CountRowsAndLockExceptionalCases;

      DimVal.SETCURRENTKEY(Code,"Global Dimension No.");
      DimVal.SETRANGE("Global Dimension No.",1,2);
      DimVal.MODIFYALL("Global Dimension No.",0);
      DimVal.RESET;
      if NewGlobalDim1Code <> '' then begin
        DimVal.SETRANGE("Dimension Code",NewGlobalDim1Code);
        DimVal.MODIFYALL("Global Dimension No.",1);
      end;
      if NewGlobalDim2Code <> '' then begin
        DimVal.SETRANGE("Dimension Code",NewGlobalDim2Code);
        DimVal.MODIFYALL("Global Dimension No.",2);
      end;

      if NewGlobalDim1Code <> '' then
        if NewGlobalDim2Code <> '' then
          DimFilter := NewGlobalDim1Code + '|' + NewGlobalDim2Code
        else
          DimFilter := NewGlobalDim1Code
      else
        if NewGlobalDim2Code <> '' then
          DimFilter := NewGlobalDim2Code
        else
          DimFilter := '';
      DefaultDim.SETFILTER("Dimension Code",DimFilter);
      JobTaskDim.SETFILTER("Dimension Code",DimFilter);

      StartTime := TIME;
      StartDate := TODAY;

      ChangeGlobalsInTables(TempTableOption::DefaultDimTables);
      ChangeGlobalsInTables(TempTableOption::DimSetTables);
      UpdateExceptionalCases;

      IndicatorWindow.CLOSE;
      exit(true);
    END;

    LOCAL PROCEDURE GetDefaultJobTaskDim@11(JobNo@1000 : Code[20];JobTaskNo@1001 : Code[20];VAR GlobalDim1Value@1002 : Code[20];VAR GlobalDim2Value@1003 : Code[20]);
    BEGIN
      GlobalDim1Value := '';
      GlobalDim2Value := '';

      JobTaskDim.SETRANGE("Job No.",JobNo);
      JobTaskDim.SETRANGE("Job Task No.",JobTaskNo);
      if JobTaskDim.FINDSET then
        repeat
          if JobTaskDim."Dimension Code" = NewGlobalDim1Code then
            GlobalDim1Value := JobTaskDim."Dimension Value Code";
          if JobTaskDim."Dimension Code" = NewGlobalDim2Code then
            GlobalDim2Value := JobTaskDim."Dimension Value Code";
        until JobTaskDim.NEXT = 0;
    END;

    LOCAL PROCEDURE OpenIndicator@9();
    BEGIN
      IndicatorWindow.OPEN(
        Text005 +
        Text006 +
        Text007 +
        Text008 +
        Text009 +
        Text010 +
        Text011 +
        Text012 +
        Text013);
    END;

    LOCAL PROCEDURE UpdateGeneralInfo@6(CompanyName@1000 : Text[100];TableName@1001 : Text[50];CurrentTableRecords@1002 : Integer);
    BEGIN
      TableRecords := CurrentTableRecords;
      CheckedTableRecords := 0;
      IndicatorWindow.UPDATE(1,DatabaseRecords);
      if DatabaseRecords <> 0 then
        IndicatorWindow.UPDATE(2,ROUND(CheckedDatabaseRecords / DatabaseRecords * 10000,1))
      else
        IndicatorWindow.UPDATE(2,0);
      if CheckedDatabaseRecords <> 0 then
        IndicatorWindow.UPDATE(3,CalcEndingTime(TODAY,TIME))
      else
        IndicatorWindow.UPDATE(3,Text014);
      IndicatorWindow.UPDATE(4,CompanyName);
      IndicatorWindow.UPDATE(5,TableName);
      IndicatorWindow.UPDATE(6,CurrentTableRecords);
      CheckedDatabaseRecords := CheckedDatabaseRecords + CurrentTableRecords;
    END;

    LOCAL PROCEDURE UpdateProgressInfo@7();
    BEGIN
      if TableRecords <> 0 then
        IndicatorWindow.UPDATE(7,ROUND(CheckedTableRecords / TableRecords * 10000,1))
      else
        IndicatorWindow.UPDATE(7,0);
    END;

    LOCAL PROCEDURE CalcEndingTime@2(PresentDate@1000 : Date;PresentTime@1001 : Time) : Text[250];
    VAR
      RemainingTime@1002 : Integer;
      EndingDate@1003 : Date;
      EndingTime@1004 : Time;
    BEGIN
      if PresentDate > StartDate then
        RemainingTime := ((PresentDate - StartDate) * 8640000) + (235959T - StartTime) + (PresentTime - 000000T)
      else
        RemainingTime := (PresentTime - StartTime);
      RemainingTime := ROUND((RemainingTime / CheckedDatabaseRecords) * (DatabaseRecords - CheckedDatabaseRecords),1);
      EndingDate := StartDate + ABS(ROUND(RemainingTime / 360000,1));
      EndingTime := StartTime + ABS(ROUND(RemainingTime mod 360000,1));
      if EndingTime < StartTime then
        EndingDate := EndingDate + 1;
      exit(FORMAT(EndingDate) + ' ' + FORMAT(EndingTime,0,Text015));
    END;

    [External]
    PROCEDURE InitializeRequest@3(NewGlobalDim1CodeFrom@1000 : Code[20];NewGlobalDim2CodeFrom@1001 : Code[20]);
    BEGIN
      GLSetup.GET;
      NewGlobalDim1Code := NewGlobalDim1CodeFrom;
      NewGlobalDim2Code := NewGlobalDim2CodeFrom;
    END;

    LOCAL PROCEDURE GetDefaultDim@16(No@1000 : Code[20];Global1FieldRef@1001 : FieldRef;Global2FieldRef@1002 : FieldRef);
    BEGIN
      Global1FieldRef.VALUE := '';
      Global2FieldRef.VALUE := '';

      DefaultDim.SETRANGE("Table ID",Global1FieldRef.RECORD.NUMBER);
      DefaultDim.SETRANGE("No.",No);
      if DefaultDim.FINDSET then
        repeat
          if DefaultDim."Dimension Code" = NewGlobalDim1Code then
            Global1FieldRef.VALUE := DefaultDim."Dimension Value Code";
          if DefaultDim."Dimension Code" = NewGlobalDim2Code then
            Global2FieldRef.VALUE := DefaultDim."Dimension Value Code";
        until DefaultDim.NEXT = 0;
    END;

    LOCAL PROCEDURE AddToDefaultDimTempTable@148(TableNo@1003 : Integer;Global1FieldNo@1002 : Integer;Global2FieldNo@1001 : Integer;IDFieldNo@1000 : Integer);
    BEGIN
      AddToTempTable(TempDefaultDimDimensionsFieldMap,TableNo,Global1FieldNo,Global2FieldNo,IDFieldNo);
    END;

    LOCAL PROCEDURE AddToDimSetTempTable@151(TableNo@1003 : Integer;Global1FieldNo@1002 : Integer;Global2FieldNo@1001 : Integer;IDFieldNo@1000 : Integer);
    BEGIN
      AddToTempTable(TempDimSetDimensionsFieldMap,TableNo,Global1FieldNo,Global2FieldNo,IDFieldNo);
    END;

    LOCAL PROCEDURE ChangeGlobalsInTables@42(TempTableOption@1003 : 'DefaultDimTables,DimSetTables');
    VAR
      FieldRecordRef@1004 : RecordRef;
      TempRecRef@1000 : RecordRef;
      TableNoFieldRef@1005 : FieldRef;
      TableNumber@1002 : Integer;
      TableNoFieldNumber@1006 : Integer;
    BEGIN
      case TempTableOption of
        TempTableOption::DefaultDimTables:
          FieldRecordRef.GETTABLE(TempDefaultDimDimensionsFieldMap);
        TempTableOption::DimSetTables:
          FieldRecordRef.GETTABLE(TempDimSetDimensionsFieldMap);
      end;

      // Get the field no when the "Table No." is stored.
      TableNoFieldNumber := TempDimSetDimensionsFieldMap.FIELDNO("Table No.");
      with FieldRecordRef do begin
        TableNoFieldRef := FIELD(TableNoFieldNumber);
        if FINDSET then begin
          repeat
            TableNumber := TableNoFieldRef.VALUE;
            TempRecRef.OPEN(TableNumber);
            case TempTableOption of
              TempTableOption::DefaultDimTables:
                ChangeGlobalsWithDefaultDim(TempRecRef);
              TempTableOption::DimSetTables:
                ChangeGlobalsWithDimensionSet(TempRecRef);
            end;
            TempRecRef.CLOSE;
          until NEXT = 0;
        end
      end;
    END;

    LOCAL PROCEDURE ChangeGlobalsWithDefaultDim@194(RecordRefForProcessing@1000 : RecordRef);
    VAR
      Global1FieldNo@1001 : Integer;
      Global2FieldNo@1002 : Integer;
      NoFieldNo@1003 : Integer;
      No@1004 : Code[20];
    BEGIN
      GetFieldNumbersFromTempTable(
        TempDefaultDimDimensionsFieldMap,RecordRefForProcessing.NUMBER,Global1FieldNo,Global2FieldNo,NoFieldNo);
      UpdateGeneralInfo(COMPANYNAME,RecordRefForProcessing.CAPTION,RecordRefForProcessing.COUNT);
      with RecordRefForProcessing do
        if FINDFIRST then begin
          repeat
            No := FIELD(NoFieldNo).VALUE;
            GetDefaultDim(No,FIELD(Global1FieldNo),FIELD(Global2FieldNo));
            MODIFY;
            CheckedTableRecords := CheckedTableRecords + 1;
            UpdateProgressInfo;
          until NEXT = 0;
        end;
    END;

    LOCAL PROCEDURE ChangeGlobalsWithDimensionSet@109(RecordRefForProcessing@1000 : RecordRef);
    VAR
      Global1FieldNo@1001 : Integer;
      Global2FieldNo@1002 : Integer;
      DimSetIDFieldNo@1003 : Integer;
      DimSetID@1004 : Integer;
    BEGIN
      GetFieldNumbersFromTempTable(
        TempDimSetDimensionsFieldMap,RecordRefForProcessing.NUMBER,Global1FieldNo,Global2FieldNo,DimSetIDFieldNo);
      UpdateGeneralInfo(COMPANYNAME,RecordRefForProcessing.CAPTION,RecordRefForProcessing.COUNT);
      with RecordRefForProcessing do
        if FIND('-') then begin
          repeat
            DimSetID := FIELD(DimSetIDFieldNo).VALUE;
            GetDimSetEntry(DimSetID,FIELD(Global1FieldNo),FIELD(Global2FieldNo));
            MODIFY;
            CheckedTableRecords := CheckedTableRecords + 1;
            UpdateProgressInfo;
          until NEXT = 0;
        end;
    END;

    LOCAL PROCEDURE GetDimSetEntry@94(DimSetID@1000 : Integer;Global1FieldRef@1001 : FieldRef;Global2FieldRef@1002 : FieldRef);
    BEGIN
      Global1FieldRef.VALUE := '';
      Global2FieldRef.VALUE := '';

      DimSetEntry.SETRANGE("Dimension Set ID",DimSetID);
      if DimSetEntry.FINDSET then
        repeat
          if DimSetEntry."Dimension Code" = NewGlobalDim1Code then
            Global1FieldRef.VALUE := DimSetEntry."Dimension Value Code";
          if DimSetEntry."Dimension Code" = NewGlobalDim2Code then
            Global2FieldRef.VALUE := DimSetEntry."Dimension Value Code";
        until DimSetEntry.NEXT = 0;
    END;

    LOCAL PROCEDURE CountRowsAndLockExceptionalCases@12();
    VAR
      TempRecRef@1000 : RecordRef;
    BEGIN
      TempRecRef.GETTABLE(SalesLineArchive);
      CountRowsAndLock(TempRecRef,DatabaseRecords);
      TempRecRef.GETTABLE(PurchLineArchive);
      CountRowsAndLock(TempRecRef,DatabaseRecords);
      TempRecRef.GETTABLE(CustLedgEntry);
      CountRowsAndLock(TempRecRef,DatabaseRecords);
      TempRecRef.GETTABLE(VendorLedgEntry);
      CountRowsAndLock(TempRecRef,DatabaseRecords);
      TempRecRef.GETTABLE(JobTask);
      CountRowsAndLock(TempRecRef,DatabaseRecords);
    END;

    LOCAL PROCEDURE UpdateExceptionalCases@231();
    VAR
      TempRecRef@1000 : RecordRef;
    BEGIN
      UpdateGeneralInfo(COMPANYNAME,SalesLineArchive.TABLECAPTION,SalesLineArchive.COUNT);
      with SalesLineArchive do begin
        SETCURRENTKEY("Document Type","Document No.","Line No.","Doc. No. Occurrence","Version No.");
        if FIND('-') then begin
          repeat
            TempRecRef.GETTABLE(SalesLineArchive);
            GetDimSetEntry(
              "Dimension Set ID",
              TempRecRef.FIELD(FIELDNO("Shortcut Dimension 1 Code")),TempRecRef.FIELD(FIELDNO("Shortcut Dimension 2 Code")));
            MODIFY;
            CheckedTableRecords := CheckedTableRecords + 1;
            UpdateProgressInfo;
          until NEXT = 0;
        end;
      end;

      UpdateGeneralInfo(COMPANYNAME,PurchLineArchive.TABLECAPTION,PurchLineArchive.COUNT);
      with PurchLineArchive do begin
        SETCURRENTKEY("Document Type","Document No.","Line No.","Doc. No. Occurrence","Version No.");
        if FIND('-') then begin
          repeat
            TempRecRef.GETTABLE(PurchLineArchive);
            GetDimSetEntry(
              "Dimension Set ID",
              TempRecRef.FIELD(FIELDNO("Shortcut Dimension 1 Code")),TempRecRef.FIELD(FIELDNO("Shortcut Dimension 2 Code")));
            MODIFY;
            CheckedTableRecords := CheckedTableRecords + 1;
            UpdateProgressInfo;
          until NEXT = 0;
        end;
      end;

      UpdateGeneralInfo(COMPANYNAME,CustLedgEntry.TABLECAPTION,CustLedgEntry.COUNT);
      with CustLedgEntry do
        if FIND('-') then begin
          repeat
            TempRecRef.GETTABLE(CustLedgEntry);
            GetDimSetEntry(
              "Dimension Set ID",
              TempRecRef.FIELD(FIELDNO("Global Dimension 1 Code")),TempRecRef.FIELD(FIELDNO("Global Dimension 2 Code")));
            MODIFY;
            DtldCustLedgEntry.SETRANGE("Cust. Ledger Entry No.","Entry No.");
            DtldCustLedgEntry.MODIFYALL("Initial Entry Global Dim. 1","Global Dimension 1 Code");
            DtldCustLedgEntry.MODIFYALL("Initial Entry Global Dim. 2","Global Dimension 2 Code");
            CheckedTableRecords := CheckedTableRecords + 1;
            UpdateProgressInfo;
          until NEXT = 0;
        end;

      UpdateGeneralInfo(COMPANYNAME,VendorLedgEntry.TABLECAPTION,VendorLedgEntry.COUNT);
      with VendorLedgEntry do
        if FIND('-') then begin
          repeat
            TempRecRef.GETTABLE(VendorLedgEntry);
            GetDimSetEntry(
              "Dimension Set ID",
              TempRecRef.FIELD(FIELDNO("Global Dimension 1 Code")),TempRecRef.FIELD(FIELDNO("Global Dimension 2 Code")));
            MODIFY;
            DtldVendLedgEntry.SETRANGE("Vendor Ledger Entry No.","Entry No.");
            DtldVendLedgEntry.MODIFYALL("Initial Entry Global Dim. 1","Global Dimension 1 Code");
            DtldVendLedgEntry.MODIFYALL("Initial Entry Global Dim. 2","Global Dimension 2 Code");
            CheckedTableRecords := CheckedTableRecords + 1;
            UpdateProgressInfo;
          until NEXT = 0;
        end;

      UpdateGeneralInfo(COMPANYNAME,JobTask.TABLECAPTION,JobTask.COUNT);
      with JobTask do
        if FINDSET then begin
          repeat
            GetDefaultJobTaskDim(
              "Job No.",
              "Job Task No.",
              "Global Dimension 1 Code",
              "Global Dimension 2 Code");
            MODIFY;
            CheckedTableRecords := CheckedTableRecords + 1;
            UpdateProgressInfo;
          until NEXT = 0;
        end;
    END;

    LOCAL PROCEDURE CountRowsAndLock@164(RecRef@1000 : RecordRef;VAR NumberOfRecords@1001 : Integer);
    BEGIN
      with RecRef do begin
        LOCKTABLE;
        if FINDLAST then;
      end;
      NumberOfRecords := NumberOfRecords + RecRef.COUNT;
    END;

    LOCAL PROCEDURE CountRowsAndLockTable@34(VAR TempDimensionsFieldMap@1000 : TEMPORARY Record "Dimensions Field Map");
    VAR
      TempRecRef@1006 : RecordRef;
    BEGIN
      with TempDimensionsFieldMap do begin
        FINDSET;
        repeat
          TempRecRef.OPEN("Table No.");
          CountRowsAndLock(TempRecRef,DatabaseRecords);
          TempRecRef.CLOSE;
        until NEXT = 0;
      end;
    END;

    LOCAL PROCEDURE AddToTempTable@26(VAR TempDimensionsFieldMap@1000 : TEMPORARY Record "Dimensions Field Map";TableNo@1001 : Integer;Global1FieldNo@1002 : Integer;Global2FieldNo@1003 : Integer;IDFieldNo@1004 : Integer);
    BEGIN
      // populate the table with rows of the field numbers that we will use.
      TempDimensionsFieldMap."Table No." := TableNo;
      TempDimensionsFieldMap."Global Dim.1 Field No." := Global1FieldNo;
      TempDimensionsFieldMap."Global Dim.2 Field No." := Global2FieldNo;
      TempDimensionsFieldMap."ID Field No." := IDFieldNo;
      TempDimensionsFieldMap.INSERT;
    END;

    LOCAL PROCEDURE GetFieldNumbersFromTempTable@28(VAR TempDimensionsFieldMap@1003 : TEMPORARY Record "Dimensions Field Map";TableNo@1004 : Integer;VAR Global1FieldNo@1000 : Integer;VAR Global2FieldNo@1001 : Integer;VAR IDFieldNo@1002 : Integer);
    BEGIN
      TempDimensionsFieldMap.GET(TableNo);
      Global1FieldNo := TempDimensionsFieldMap."Global Dim.1 Field No.";
      Global2FieldNo := TempDimensionsFieldMap."Global Dim.2 Field No.";
      IDFieldNo := TempDimensionsFieldMap."ID Field No.";
    END;

    [External]
    PROCEDURE InitializeTablesForModification@199();
    BEGIN
      TempDefaultDimDimensionsFieldMap.DELETEALL;
      TempDimSetDimensionsFieldMap.DELETEALL;

      AddingDefaultValueDim;

      // Initialize the tables using the Dimension Set
      AddToDimSetTempTable(
        DATABASE::"G/L Entry",GLEntry.FIELDNO("Global Dimension 1 Code"),GLEntry.FIELDNO("Global Dimension 2 Code"),
        GLEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Cust. Ledger Entry",CustLedgEntry.FIELDNO("Global Dimension 1 Code"),
        CustLedgEntry.FIELDNO("Global Dimension 2 Code"),CustLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Vendor Ledger Entry",VendorLedgEntry.FIELDNO("Global Dimension 1 Code"),
        VendorLedgEntry.FIELDNO("Global Dimension 2 Code"),VendorLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Item Ledger Entry",ItemLedgEntry.FIELDNO("Global Dimension 1 Code"),
        ItemLedgEntry.FIELDNO("Global Dimension 2 Code"),ItemLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Job Ledger Entry",JobLedgEntry.FIELDNO("Global Dimension 1 Code"),JobLedgEntry.FIELDNO("Global Dimension 2 Code"),
        JobLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Res. Ledger Entry",ResLedgEntry.FIELDNO("Global Dimension 1 Code"),
        ResLedgEntry.FIELDNO("Global Dimension 2 Code"),ResLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Value Entry",ValueEntry.FIELDNO("Global Dimension 1 Code"),ValueEntry.FIELDNO("Global Dimension 2 Code"),
        ValueEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Capacity Ledger Entry",CapLedgEntry.FIELDNO("Global Dimension 1 Code"),
        CapLedgEntry.FIELDNO("Global Dimension 2 Code"),CapLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Bank Account Ledger Entry",BankAccLedgEntry.FIELDNO("Global Dimension 1 Code"),
        BankAccLedgEntry.FIELDNO("Global Dimension 2 Code"),BankAccLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Phys. Inventory Ledger Entry",PhysInvtLedgEntry.FIELDNO("Global Dimension 1 Code"),
        PhysInvtLedgEntry.FIELDNO("Global Dimension 2 Code"),PhysInvtLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"FA Ledger Entry",FALedgEntry.FIELDNO("Global Dimension 1 Code"),FALedgEntry.FIELDNO("Global Dimension 2 Code"),
        FALedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Maintenance Ledger Entry",MaintenanceLedgEntry.FIELDNO("Global Dimension 1 Code"),
        MaintenanceLedgEntry.FIELDNO("Global Dimension 2 Code"),MaintenanceLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Ins. Coverage Ledger Entry",InsCovLedgEntry.FIELDNO("Global Dimension 1 Code"),
        InsCovLedgEntry.FIELDNO("Global Dimension 2 Code"),InsCovLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Ledger Entry",ServiceLedgerEntry.FIELDNO("Global Dimension 1 Code"),
        ServiceLedgerEntry.FIELDNO("Global Dimension 2 Code"),ServiceLedgerEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Warranty Ledger Entry",WarrantyLedgerEntry.FIELDNO("Global Dimension 1 Code"),
        WarrantyLedgerEntry.FIELDNO("Global Dimension 2 Code"),WarrantyLedgerEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Gen. Journal Line",GenJnlLine.FIELDNO("Shortcut Dimension 1 Code"),
        GenJnlLine.FIELDNO("Shortcut Dimension 2 Code"),GenJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Item Journal Line",ItemJnlLine.FIELDNO("Shortcut Dimension 1 Code"),
        ItemJnlLine.FIELDNO("Shortcut Dimension 2 Code"),ItemJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Res. Journal Line",ResJnlLine.FIELDNO("Shortcut Dimension 1 Code"),
        ResJnlLine.FIELDNO("Shortcut Dimension 2 Code"),ResJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Job Journal Line",JobJnlLine.FIELDNO("Shortcut Dimension 1 Code"),JobJnlLine.FIELDNO("Shortcut Dimension 2 Code"),
        JobJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Gen. Jnl. Allocation",GenJnlAlloc.FIELDNO("Shortcut Dimension 1 Code"),
        GenJnlAlloc.FIELDNO("Shortcut Dimension 2 Code"),GenJnlAlloc.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Requisition Line",ReqLine.FIELDNO("Shortcut Dimension 1 Code"),ReqLine.FIELDNO("Shortcut Dimension 2 Code"),
        ReqLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"FA Journal Line",FAJnlLine.FIELDNO("Shortcut Dimension 1 Code"),FAJnlLine.FIELDNO("Shortcut Dimension 2 Code"),
        FAJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Insurance Journal Line",InsuranceJnlLine.FIELDNO("Shortcut Dimension 1 Code"),
        InsuranceJnlLine.FIELDNO("Shortcut Dimension 2 Code"),InsuranceJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Planning Component",PlanningComponent.FIELDNO("Shortcut Dimension 1 Code"),
        PlanningComponent.FIELDNO("Shortcut Dimension 2 Code"),PlanningComponent.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Standard General Journal Line",StdGenJnlLine.FIELDNO("Shortcut Dimension 1 Code"),
        StdGenJnlLine.FIELDNO("Shortcut Dimension 2 Code"),StdGenJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Standard Item Journal Line",StdItemJnlLine.FIELDNO("Shortcut Dimension 1 Code"),
        StdItemJnlLine.FIELDNO("Shortcut Dimension 2 Code"),StdItemJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Header",SalesHeader.FIELDNO("Shortcut Dimension 1 Code"),SalesHeader.FIELDNO("Shortcut Dimension 2 Code"),
        SalesHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Line",SalesLine.FIELDNO("Shortcut Dimension 1 Code"),SalesLine.FIELDNO("Shortcut Dimension 2 Code"),
        SalesLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purchase Header",PurchHeader.FIELDNO("Shortcut Dimension 1 Code"),
        PurchHeader.FIELDNO("Shortcut Dimension 2 Code"),PurchHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purchase Line",PurchLine.FIELDNO("Shortcut Dimension 1 Code"),PurchLine.FIELDNO("Shortcut Dimension 2 Code"),
        PurchLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Standard Sales Line",StdSalesLine.FIELDNO("Shortcut Dimension 1 Code"),
        StdSalesLine.FIELDNO("Shortcut Dimension 2 Code"),StdSalesLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Standard Purchase Line",StdPurchLine.FIELDNO("Shortcut Dimension 1 Code"),
        StdPurchLine.FIELDNO("Shortcut Dimension 2 Code"),StdPurchLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Reminder Header",ReminderHeader.FIELDNO("Shortcut Dimension 1 Code"),
        ReminderHeader.FIELDNO("Shortcut Dimension 2 Code"),ReminderHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Finance Charge Memo Header",FinChrgMemoHeader.FIELDNO("Shortcut Dimension 1 Code"),
        FinChrgMemoHeader.FIELDNO("Shortcut Dimension 2 Code"),FinChrgMemoHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Header",ServHeader.FIELDNO("Shortcut Dimension 1 Code"),ServHeader.FIELDNO("Shortcut Dimension 2 Code"),
        ServHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Item Line",ServItemLine.FIELDNO("Shortcut Dimension 1 Code"),
        ServItemLine.FIELDNO("Shortcut Dimension 2 Code"),ServItemLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Line",ServLine.FIELDNO("Shortcut Dimension 1 Code"),ServLine.FIELDNO("Shortcut Dimension 2 Code"),
        ServLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Header Archive",SalesHeaderArchive.FIELDNO("Shortcut Dimension 1 Code"),
        SalesHeaderArchive.FIELDNO("Shortcut Dimension 2 Code"),SalesHeaderArchive.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purchase Header Archive",PurchHeaderArchive.FIELDNO("Shortcut Dimension 1 Code"),
        PurchHeaderArchive.FIELDNO("Shortcut Dimension 2 Code"),PurchHeaderArchive.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Transfer Header",TransferHeader.FIELDNO("Shortcut Dimension 1 Code"),
        TransferHeader.FIELDNO("Shortcut Dimension 2 Code"),TransferHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Transfer Line",TransferLine.FIELDNO("Shortcut Dimension 1 Code"),
        TransferLine.FIELDNO("Shortcut Dimension 2 Code"),TransferLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Standard Service Line",StdServLine.FIELDNO("Shortcut Dimension 1 Code"),
        StdServLine.FIELDNO("Shortcut Dimension 2 Code"),StdServLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Production Order",ProdOrder.FIELDNO("Shortcut Dimension 1 Code"),ProdOrder.FIELDNO("Shortcut Dimension 2 Code"),
        ProdOrder.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Prod. Order Line",ProdOrderLine.FIELDNO("Shortcut Dimension 1 Code"),
        ProdOrderLine.FIELDNO("Shortcut Dimension 2 Code"),ProdOrderLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Prod. Order Component",ProdOrderComp.FIELDNO("Shortcut Dimension 1 Code"),
        ProdOrderComp.FIELDNO("Shortcut Dimension 2 Code"),ProdOrderComp.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Shipment Header",SalesShptHeader.FIELDNO("Shortcut Dimension 1 Code"),
        SalesShptHeader.FIELDNO("Shortcut Dimension 2 Code"),SalesShptHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Shipment Line",SaleShptLine.FIELDNO("Shortcut Dimension 1 Code"),
        SaleShptLine.FIELDNO("Shortcut Dimension 2 Code"),SaleShptLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Invoice Header",SalesInvHeader.FIELDNO("Shortcut Dimension 1 Code"),
        SalesInvHeader.FIELDNO("Shortcut Dimension 2 Code"),SalesInvHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Invoice Line",SalesInvLine.FIELDNO("Shortcut Dimension 1 Code"),
        SalesInvLine.FIELDNO("Shortcut Dimension 2 Code"),SalesInvLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Return Receipt Header",ReturnRcptHeader.FIELDNO("Shortcut Dimension 1 Code"),
        ReturnRcptHeader.FIELDNO("Shortcut Dimension 2 Code"),ReturnRcptHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Return Receipt Line",ReturnRcptLine.FIELDNO("Shortcut Dimension 1 Code"),
        ReturnRcptLine.FIELDNO("Shortcut Dimension 2 Code"),ReturnRcptLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Cr.Memo Header",SalesCrMemoHeader.FIELDNO("Shortcut Dimension 1 Code"),
        SalesCrMemoHeader.FIELDNO("Shortcut Dimension 2 Code"),SalesCrMemoHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Cr.Memo Line",SalesCrMemoLine.FIELDNO("Shortcut Dimension 1 Code"),
        SalesCrMemoLine.FIELDNO("Shortcut Dimension 2 Code"),SalesCrMemoLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Shipment Header",ServShptHeader.FIELDNO("Shortcut Dimension 1 Code"),
        ServShptHeader.FIELDNO("Shortcut Dimension 2 Code"),ServShptHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Shipment Line",ServShptLine.FIELDNO("Shortcut Dimension 1 Code"),
        ServShptLine.FIELDNO("Shortcut Dimension 2 Code"),ServShptLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Invoice Header",ServInvHeader.FIELDNO("Shortcut Dimension 1 Code"),
        ServInvHeader.FIELDNO("Shortcut Dimension 2 Code"),ServInvHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Invoice Line",ServInvLine.FIELDNO("Shortcut Dimension 1 Code"),
        ServInvLine.FIELDNO("Shortcut Dimension 2 Code"),ServInvLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Cr.Memo Header",ServCrMemoHeader.FIELDNO("Shortcut Dimension 1 Code"),
        ServCrMemoHeader.FIELDNO("Shortcut Dimension 2 Code"),ServCrMemoHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Cr.Memo Line",ServCrMemoLine.FIELDNO("Shortcut Dimension 1 Code"),
        ServCrMemoLine.FIELDNO("Shortcut Dimension 2 Code"),ServCrMemoLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purch. Rcpt. Header",PurchRcptHeader.FIELDNO("Shortcut Dimension 1 Code"),
        PurchRcptHeader.FIELDNO("Shortcut Dimension 2 Code"),PurchRcptHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purch. Rcpt. Line",PurchRcptLine.FIELDNO("Shortcut Dimension 1 Code"),
        PurchRcptLine.FIELDNO("Shortcut Dimension 2 Code"),PurchRcptLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purch. Inv. Header",PurchInvHeader.FIELDNO("Shortcut Dimension 1 Code"),
        PurchInvHeader.FIELDNO("Shortcut Dimension 2 Code"),PurchInvHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purch. Inv. Line",PurchInvLine.FIELDNO("Shortcut Dimension 1 Code"),
        PurchInvLine.FIELDNO("Shortcut Dimension 2 Code"),PurchInvLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Return Shipment Header",ReturnShptHeader.FIELDNO("Shortcut Dimension 1 Code"),
        ReturnShptHeader.FIELDNO("Shortcut Dimension 2 Code"),ReturnShptHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Return Shipment Line",ReturnShptLine.FIELDNO("Shortcut Dimension 1 Code"),
        ReturnShptLine.FIELDNO("Shortcut Dimension 2 Code"),ReturnShptLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purch. Cr. Memo Hdr.",PurchCrMemoHeader.FIELDNO("Shortcut Dimension 1 Code"),
        PurchCrMemoHeader.FIELDNO("Shortcut Dimension 2 Code"),PurchCrMemoHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purch. Cr. Memo Line",PurchCrMemoLine.FIELDNO("Shortcut Dimension 1 Code"),
        PurchCrMemoLine.FIELDNO("Shortcut Dimension 2 Code"),PurchCrMemoLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Issued Reminder Header",IssuedReminderHeader.FIELDNO("Shortcut Dimension 1 Code"),
        IssuedReminderHeader.FIELDNO("Shortcut Dimension 2 Code"),IssuedReminderHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Issued Fin. Charge Memo Header",IssuedFinChrgMemoHeader.FIELDNO("Shortcut Dimension 1 Code"),
        IssuedFinChrgMemoHeader.FIELDNO("Shortcut Dimension 2 Code"),IssuedFinChrgMemoHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Transfer Shipment Header",TransferShipmentHeader.FIELDNO("Shortcut Dimension 1 Code"),
        TransferShipmentHeader.FIELDNO("Shortcut Dimension 2 Code"),TransferShipmentHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Transfer Shipment Line",TransferShipmentLine.FIELDNO("Shortcut Dimension 1 Code"),
        TransferShipmentLine.FIELDNO("Shortcut Dimension 2 Code"),TransferShipmentLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Transfer Receipt Header",TransferReceiptHeader.FIELDNO("Shortcut Dimension 1 Code"),
        TransferReceiptHeader.FIELDNO("Shortcut Dimension 2 Code"),TransferReceiptHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Transfer Receipt Line",TransferReceiptLine.FIELDNO("Shortcut Dimension 1 Code"),
        TransferReceiptLine.FIELDNO("Shortcut Dimension 2 Code"),TransferReceiptLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"G/L Budget Entry",GLBudgetEntry.FIELDNO("Global Dimension 1 Code"),
        GLBudgetEntry.FIELDNO("Global Dimension 2 Code"),GLBudgetEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"FA Allocation",FAAlloc.FIELDNO("Global Dimension 1 Code"),FAAlloc.FIELDNO("Global Dimension 2 Code"),
        FAAlloc.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Contract Header",ServCtrHeader.FIELDNO("Shortcut Dimension 1 Code"),
        ServCtrHeader.FIELDNO("Shortcut Dimension 2 Code"),ServCtrHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Filed Service Contract Header",FiledServCtrHeader.FIELDNO("Shortcut Dimension 1 Code"),
        FiledServCtrHeader.FIELDNO("Shortcut Dimension 2 Code"),FiledServCtrHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Job WIP Entry",JobWIPEntry.FIELDNO("Global Dimension 1 Code"),JobWIPEntry.FIELDNO("Global Dimension 2 Code"),
        JobWIPEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Job WIP G/L Entry",JobWIPGLEntry.FIELDNO("Global Dimension 1 Code"),
        JobWIPGLEntry.FIELDNO("Global Dimension 2 Code"),JobWIPGLEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Item Budget Entry",ItemBudgetEntry.FIELDNO("Global Dimension 1 Code"),
        ItemBudgetEntry.FIELDNO("Global Dimension 2 Code"),ItemBudgetEntry.FIELDNO("Dimension Set ID"));
    END;

    LOCAL PROCEDURE AddingDefaultValueDim@4();
    BEGIN
      AddToDefaultDimTempTable(
        DATABASE::"G/L Account",GLAcc.FIELDNO("Global Dimension 1 Code"),GLAcc.FIELDNO("Global Dimension 2 Code"),
        GLAcc.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::Customer,Cust.FIELDNO("Global Dimension 1 Code"),Cust.FIELDNO("Global Dimension 2 Code"),Cust.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::Vendor,Vend.FIELDNO("Global Dimension 1 Code"),Vend.FIELDNO("Global Dimension 2 Code"),Vend.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::Item,Item.FIELDNO("Global Dimension 1 Code"),Item.FIELDNO("Global Dimension 2 Code"),Item.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::"Resource Group",ResGr.FIELDNO("Global Dimension 1 Code"),ResGr.FIELDNO("Global Dimension 2 Code"),
        ResGr.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::Resource,Res.FIELDNO("Global Dimension 1 Code"),Res.FIELDNO("Global Dimension 2 Code"),Res.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::Job,Job.FIELDNO("Global Dimension 1 Code"),Job.FIELDNO("Global Dimension 2 Code"),Job.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::"Bank Account",BankAcc.FIELDNO("Global Dimension 1 Code"),BankAcc.FIELDNO("Global Dimension 2 Code"),
        BankAcc.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::Employee,Employee.FIELDNO("Global Dimension 1 Code"),Employee.FIELDNO("Global Dimension 2 Code"),
        Employee.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::"Fixed Asset",FA.FIELDNO("Global Dimension 1 Code"),FA.FIELDNO("Global Dimension 2 Code"),FA.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::Insurance,Insurance.FIELDNO("Global Dimension 1 Code"),Insurance.FIELDNO("Global Dimension 2 Code"),
        Insurance.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::"Responsibility Center",RespCenter.FIELDNO("Global Dimension 1 Code"),
        RespCenter.FIELDNO("Global Dimension 2 Code"),RespCenter.FIELDNO(Code));
      AddToDefaultDimTempTable(
        DATABASE::"Salesperson/Purchaser",SalespersonPurchaser.FIELDNO("Global Dimension 1 Code"),
        SalespersonPurchaser.FIELDNO("Global Dimension 2 Code"),SalespersonPurchaser.FIELDNO(Code));
      AddToDefaultDimTempTable(
        DATABASE::Campaign,Campaign.FIELDNO("Global Dimension 1 Code"),Campaign.FIELDNO("Global Dimension 2 Code"),
        Campaign.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::"Customer Template",CustomerTemplate.FIELDNO("Global Dimension 1 Code"),
        CustomerTemplate.FIELDNO("Global Dimension 2 Code"),CustomerTemplate.FIELDNO(Code));
      AddToDefaultDimTempTable(
        DATABASE::"Item Charge",ItemCharge.FIELDNO("Global Dimension 1 Code"),ItemCharge.FIELDNO("Global Dimension 2 Code"),
        ItemCharge.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::"Work Center",WorkCenter.FIELDNO("Global Dimension 1 Code"),WorkCenter.FIELDNO("Global Dimension 2 Code"),
        WorkCenter.FIELDNO("No."));
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

