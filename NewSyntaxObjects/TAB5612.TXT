OBJECT Table 5612 FA Depreciation Book
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    Permissions=TableData "FA Ledger Entry"=r,
                TableData "Maintenance Ledger Entry"=r;
    OnInsert=BEGIN
               "Acquisition Date" := 0D;
               "G/L Acquisition Date" := 0D;
               "Last Acquisition Cost Date" := 0D;
               "Last Salvage Value Date" := 0D;
               "Last Depreciation Date" := 0D;
               "Last Write-Down Date" := 0D;
               "Last Appreciation Date" := 0D;
               "Last Custom 1 Date" := 0D;
               "Last Custom 2 Date" := 0D;
               "Disposal Date" := 0D;
               "Last Maintenance Date" := 0D;
               LOCKTABLE;
               FA.LOCKTABLE;
               DeprBook.LOCKTABLE;
               FA.GET("FA No.");
               DeprBook.GET("Depreciation Book Code");
               Description := FA.Description;
               "Main Asset/Component" := FA."Main Asset/Component";
               "Component of Main Asset" := FA."Component of Main Asset";
               if ("No. of Depreciation Years" <> 0) or ("No. of Depreciation Months" <> 0) then
                 DeprBook.TESTFIELD("Fiscal Year 365 Days",false);
             END;

    OnModify=BEGIN
               "Last Date Modified" := TODAY;
               LOCKTABLE;
               DeprBook.LOCKTABLE;
               DeprBook.GET("Depreciation Book Code");
               if ("No. of Depreciation Years" <> 0) or ("No. of Depreciation Months" <> 0) then
                 DeprBook.TESTFIELD("Fiscal Year 365 Days",false);
             END;

    OnDelete=BEGIN
               FAMoveEntries.MoveFAEntries(Rec);
             END;

    OnRename=BEGIN
               ERROR(Text000,TABLECAPTION);
             END;

    CaptionML=ENU=FA Depreciation Book;
  }
  FIELDS
  {
    { 1   ;   ;FA No.              ;Code20        ;TableRelation="Fixed Asset";
                                                   CaptionML=ENU=FA No.;
                                                   NotBlank=true }
    { 2   ;   ;Depreciation Book Code;Code10      ;TableRelation="Depreciation Book";
                                                   CaptionML=ENU=Depreciation Book Code;
                                                   NotBlank=true }
    { 3   ;   ;Depreciation Method ;Option        ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                case "Depreciation Method" of
                                                                  "Depreciation Method"::"Straight-Line":
                                                                    begin
                                                                      "Declining-Balance %" := 0;
                                                                      "Depreciation Table Code" := '';
                                                                      "First User-Defined Depr. Date" := 0D;
                                                                      "Use DB% First Fiscal Year" := false;
                                                                    end;
                                                                  "Depreciation Method"::"Declining-Balance 1",
                                                                  "Depreciation Method"::"Declining-Balance 2":
                                                                    begin
                                                                      "Straight-Line %" := 0;
                                                                      "No. of Depreciation Years" := 0;
                                                                      "No. of Depreciation Months" := 0;
                                                                      "Fixed Depr. Amount" := 0;
                                                                      "Depreciation Ending Date" := 0D;
                                                                      "Depreciation Table Code" := '';
                                                                      "First User-Defined Depr. Date" := 0D;
                                                                      "Use DB% First Fiscal Year" := false;
                                                                    end;
                                                                  "Depreciation Method"::"DB1/SL",
                                                                  "Depreciation Method"::"DB2/SL":
                                                                    begin
                                                                      "Depreciation Table Code" := '';
                                                                      "First User-Defined Depr. Date" := 0D;
                                                                    end;
                                                                  "Depreciation Method"::"User-Defined":
                                                                    begin
                                                                      "Straight-Line %" := 0;
                                                                      "No. of Depreciation Years" := 0;
                                                                      "No. of Depreciation Months" := 0;
                                                                      "Fixed Depr. Amount" := 0;
                                                                      "Depreciation Ending Date" := 0D;
                                                                      "Declining-Balance %" := 0;
                                                                      "Use DB% First Fiscal Year" := false;
                                                                    end;
                                                                  "Depreciation Method"::Manual:
                                                                    begin
                                                                      "Straight-Line %" := 0;
                                                                      "No. of Depreciation Years" := 0;
                                                                      "No. of Depreciation Months" := 0;
                                                                      "Fixed Depr. Amount" := 0;
                                                                      "Depreciation Ending Date" := 0D;
                                                                      "Declining-Balance %" := 0;
                                                                      "Depreciation Table Code" := '';
                                                                      "First User-Defined Depr. Date" := 0D;
                                                                      "Use DB% First Fiscal Year" := false;
                                                                    end;
                                                                end;
                                                                TestHalfYearConventionMethod;
                                                              END;

                                                   CaptionML=ENU=Depreciation Method;
                                                   OptionCaptionML=ENU=Straight-Line,Declining-Balance 1,Declining-Balance 2,DB1/SL,DB2/SL,User-Defined,Manual;
                                                   OptionString="Straight-Line","Declining-Balance 1","Declining-Balance 2","DB1/SL","DB2/SL","User-Defined",Manual }
    { 4   ;   ;Depreciation Starting Date;Date    ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                CalcDeprPeriod;
                                                              END;

                                                   CaptionML=ENU=Depreciation Starting Date;
                                                   Editable=true }
    { 5   ;   ;Straight-Line %     ;Decimal       ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                if ("Straight-Line %" <> 0) and not LinearMethod then
                                                                  DeprMethodError;
                                                                AdjustLinearMethod("No. of Depreciation Years","Fixed Depr. Amount");
                                                              END;

                                                   CaptionML=ENU=Straight-Line %;
                                                   DecimalPlaces=2:8;
                                                   MinValue=0 }
    { 6   ;   ;No. of Depreciation Years;Decimal  ;OnValidate=VAR
                                                                DeprBook2@1000 : Record "Depreciation Book";
                                                              BEGIN
                                                                DeprBook2.GET("Depreciation Book Code");
                                                                DeprBook2.TESTFIELD("Fiscal Year 365 Days",false);

                                                                TESTFIELD("Depreciation Starting Date");
                                                                ModifyDeprFields;
                                                                if ("No. of Depreciation Years" <> 0) and not LinearMethod then
                                                                  DeprMethodError;

                                                                "No. of Depreciation Months" := ROUND("No. of Depreciation Years" * 12,0.00000001);
                                                                AdjustLinearMethod("Straight-Line %","Fixed Depr. Amount");
                                                                "Depreciation Ending Date" := CalcEndingDate;
                                                              END;

                                                   CaptionML=ENU=No. of Depreciation Years;
                                                   DecimalPlaces=2:8;
                                                   MinValue=0;
                                                   BlankZero=true }
    { 7   ;   ;No. of Depreciation Months;Decimal ;OnValidate=VAR
                                                                DeprBook2@1000 : Record "Depreciation Book";
                                                              BEGIN
                                                                DeprBook2.GET("Depreciation Book Code");
                                                                DeprBook2.TESTFIELD("Fiscal Year 365 Days",false);

                                                                TESTFIELD("Depreciation Starting Date");
                                                                ModifyDeprFields;
                                                                if ("No. of Depreciation Months" <> 0) and not LinearMethod then
                                                                  DeprMethodError;

                                                                "No. of Depreciation Years" := ROUND("No. of Depreciation Months" / 12,0.00000001);
                                                                AdjustLinearMethod("Straight-Line %","Fixed Depr. Amount");
                                                                "Depreciation Ending Date" := CalcEndingDate;
                                                              END;

                                                   CaptionML=ENU=No. of Depreciation Months;
                                                   DecimalPlaces=2:8;
                                                   MinValue=0;
                                                   BlankZero=true }
    { 8   ;   ;Fixed Depr. Amount  ;Decimal       ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                if ("Fixed Depr. Amount" <> 0) and not LinearMethod then
                                                                  DeprMethodError;
                                                                AdjustLinearMethod("Straight-Line %","No. of Depreciation Years");
                                                              END;

                                                   CaptionML=ENU=Fixed Depr. Amount;
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 9   ;   ;Declining-Balance % ;Decimal       ;OnValidate=BEGIN
                                                                if "Declining-Balance %" >= 100 then
                                                                  FIELDERROR("Declining-Balance %",Text001);
                                                                ModifyDeprFields;
                                                                if ("Declining-Balance %" <> 0) and not DecliningMethod then
                                                                  DeprMethodError;
                                                              END;

                                                   CaptionML=ENU=Declining-Balance %;
                                                   DecimalPlaces=2:8;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 10  ;   ;Depreciation Table Code;Code10     ;TableRelation="Depreciation Table Header";
                                                   OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                if ("Depreciation Table Code" <> '') and not UserDefinedMethod then
                                                                  DeprMethodError;
                                                              END;

                                                   CaptionML=ENU=Depreciation Table Code }
    { 11  ;   ;Final Rounding Amount;Decimal      ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=ENU=Final Rounding Amount;
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 12  ;   ;Ending Book Value   ;Decimal       ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=ENU=Ending Book Value;
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 13  ;   ;FA Posting Group    ;Code20        ;TableRelation="FA Posting Group";
                                                   OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=ENU=FA Posting Group }
    { 14  ;   ;Depreciation Ending Date;Date      ;OnValidate=BEGIN
                                                                TESTFIELD("Depreciation Starting Date");
                                                                if ("Depreciation Ending Date" <> 0D) and not LinearMethod then
                                                                  DeprMethodError;
                                                                ModifyDeprFields;
                                                                CalcDeprPeriod;
                                                              END;

                                                   CaptionML=ENU=Depreciation Ending Date }
    { 15  ;   ;Acquisition Cost    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE ("FA No."=FIELD("FA No."),
                                                                                                   "Depreciation Book Code"=FIELD("Depreciation Book Code"),
                                                                                                   "FA Posting Category"=CONST(" "),
                                                                                                   "FA Posting Type"=CONST("Acquisition Cost"),
                                                                                                   "FA Posting Date"=FIELD("FA Posting Date Filter")));
                                                   CaptionML=ENU=Acquisition Cost;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 16  ;   ;Depreciation        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE ("FA No."=FIELD("FA No."),
                                                                                                   "Depreciation Book Code"=FIELD("Depreciation Book Code"),
                                                                                                   "FA Posting Category"=CONST(" "),
                                                                                                   "FA Posting Type"=CONST(Depreciation),
                                                                                                   "FA Posting Date"=FIELD("FA Posting Date Filter")));
                                                   CaptionML=ENU=Depreciation;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 17  ;   ;Book Value          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE ("FA No."=FIELD("FA No."),
                                                                                                   "Depreciation Book Code"=FIELD("Depreciation Book Code"),
                                                                                                   "Part of Book Value"=CONST(true),
                                                                                                   "FA Posting Date"=FIELD("FA Posting Date Filter")));
                                                   CaptionML=ENU=Book Value;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 18  ;   ;Proceeds on Disposal;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE ("FA No."=FIELD("FA No."),
                                                                                                   "Depreciation Book Code"=FIELD("Depreciation Book Code"),
                                                                                                   "FA Posting Category"=CONST(" "),
                                                                                                   "FA Posting Type"=CONST("Proceeds on Disposal"),
                                                                                                   "FA Posting Date"=FIELD("FA Posting Date Filter")));
                                                   CaptionML=ENU=Proceeds on Disposal;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 19  ;   ;Gain/Loss           ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE ("FA No."=FIELD("FA No."),
                                                                                                   "Depreciation Book Code"=FIELD("Depreciation Book Code"),
                                                                                                   "FA Posting Category"=CONST(" "),
                                                                                                   "FA Posting Type"=CONST("Gain/Loss"),
                                                                                                   "FA Posting Date"=FIELD("FA Posting Date Filter")));
                                                   CaptionML=ENU=Gain/Loss;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 20  ;   ;Write-Down          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE ("FA No."=FIELD("FA No."),
                                                                                                   "Depreciation Book Code"=FIELD("Depreciation Book Code"),
                                                                                                   "FA Posting Category"=CONST(" "),
                                                                                                   "FA Posting Type"=CONST("Write-Down"),
                                                                                                   "FA Posting Date"=FIELD("FA Posting Date Filter")));
                                                   CaptionML=ENU=Write-Down;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 21  ;   ;Appreciation        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE ("FA No."=FIELD("FA No."),
                                                                                                   "Depreciation Book Code"=FIELD("Depreciation Book Code"),
                                                                                                   "FA Posting Category"=CONST(" "),
                                                                                                   "FA Posting Type"=CONST(Appreciation),
                                                                                                   "FA Posting Date"=FIELD("FA Posting Date Filter")));
                                                   CaptionML=ENU=Appreciation;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 22  ;   ;Custom 1            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE ("FA No."=FIELD("FA No."),
                                                                                                   "Depreciation Book Code"=FIELD("Depreciation Book Code"),
                                                                                                   "FA Posting Category"=CONST(" "),
                                                                                                   "FA Posting Type"=CONST("Custom 1"),
                                                                                                   "FA Posting Date"=FIELD("FA Posting Date Filter")));
                                                   CaptionML=ENU=Custom 1;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 23  ;   ;Custom 2            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE ("FA No."=FIELD("FA No."),
                                                                                                   "Depreciation Book Code"=FIELD("Depreciation Book Code"),
                                                                                                   "FA Posting Category"=CONST(" "),
                                                                                                   "FA Posting Type"=CONST("Custom 2"),
                                                                                                   "FA Posting Date"=FIELD("FA Posting Date Filter")));
                                                   CaptionML=ENU=Custom 2;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 24  ;   ;Depreciable Basis   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE ("FA No."=FIELD("FA No."),
                                                                                                   "Depreciation Book Code"=FIELD("Depreciation Book Code"),
                                                                                                   "Part of Depreciable Basis"=CONST(true),
                                                                                                   "FA Posting Date"=FIELD("FA Posting Date Filter")));
                                                   CaptionML=ENU=Depreciable Basis;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 25  ;   ;Salvage Value       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE ("FA No."=FIELD("FA No."),
                                                                                                   "Depreciation Book Code"=FIELD("Depreciation Book Code"),
                                                                                                   "FA Posting Category"=CONST(" "),
                                                                                                   "FA Posting Type"=CONST("Salvage Value"),
                                                                                                   "FA Posting Date"=FIELD("FA Posting Date Filter")));
                                                   CaptionML=ENU=Salvage Value;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 26  ;   ;Book Value on Disposal;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE ("FA No."=FIELD("FA No."),
                                                                                                   "Depreciation Book Code"=FIELD("Depreciation Book Code"),
                                                                                                   "FA Posting Category"=CONST(Disposal),
                                                                                                   "FA Posting Type"=CONST("Book Value on Disposal"),
                                                                                                   "FA Posting Date"=FIELD("FA Posting Date Filter")));
                                                   CaptionML=ENU=Book Value on Disposal;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 27  ;   ;Maintenance         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Maintenance Ledger Entry".Amount WHERE ("FA No."=FIELD("FA No."),
                                                                                                            "Depreciation Book Code"=FIELD("Depreciation Book Code"),
                                                                                                            "Maintenance Code"=FIELD("Maintenance Code Filter"),
                                                                                                            "FA Posting Date"=FIELD("FA Posting Date Filter")));
                                                   CaptionML=ENU=Maintenance;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 28  ;   ;Maintenance Code Filter;Code10     ;FieldClass=FlowFilter;
                                                   TableRelation=Maintenance;
                                                   CaptionML=ENU=Maintenance Code Filter }
    { 29  ;   ;FA Posting Date Filter;Date        ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=FA Posting Date Filter }
    { 30  ;   ;Acquisition Date    ;Date          ;CaptionML=ENU=Acquisition Date;
                                                   Editable=false }
    { 31  ;   ;G/L Acquisition Date;Date          ;CaptionML=ENU=G/L Acquisition Date;
                                                   Editable=false }
    { 32  ;   ;Disposal Date       ;Date          ;CaptionML=ENU=Disposal Date;
                                                   Editable=false }
    { 33  ;   ;Last Acquisition Cost Date;Date    ;CaptionML=ENU=Last Acquisition Cost Date;
                                                   Editable=false }
    { 34  ;   ;Last Depreciation Date;Date        ;CaptionML=ENU=Last Depreciation Date;
                                                   Editable=false }
    { 35  ;   ;Last Write-Down Date;Date          ;CaptionML=ENU=Last Write-Down Date;
                                                   Editable=false }
    { 36  ;   ;Last Appreciation Date;Date        ;CaptionML=ENU=Last Appreciation Date;
                                                   Editable=false }
    { 37  ;   ;Last Custom 1 Date  ;Date          ;CaptionML=ENU=Last Custom 1 Date;
                                                   Editable=false }
    { 38  ;   ;Last Custom 2 Date  ;Date          ;CaptionML=ENU=Last Custom 2 Date;
                                                   Editable=false }
    { 39  ;   ;Last Salvage Value Date;Date       ;CaptionML=ENU=Last Salvage Value Date;
                                                   Editable=false }
    { 40  ;   ;FA Exchange Rate    ;Decimal       ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=ENU=FA Exchange Rate;
                                                   DecimalPlaces=4:4;
                                                   MinValue=0 }
    { 41  ;   ;Fixed Depr. Amount below Zero;Decimal;
                                                   OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                "Depr. below Zero %" := 0;
                                                                if "Fixed Depr. Amount below Zero" > 0 then begin
                                                                  DeprBook.GET("Depreciation Book Code");
                                                                  DeprBook.TESTFIELD("Allow Depr. below Zero",true);
                                                                  TESTFIELD("Use FA Ledger Check",true);
                                                                end;
                                                              END;

                                                   CaptionML=ENU=Fixed Depr. Amount below Zero;
                                                   MinValue=0;
                                                   BlankZero=true;
                                                   AutoFormatType=1 }
    { 42  ;   ;Last Date Modified  ;Date          ;CaptionML=ENU=Last Date Modified;
                                                   Editable=false }
    { 43  ;   ;First User-Defined Depr. Date;Date ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                if ("First User-Defined Depr. Date" <> 0D) and not UserDefinedMethod then
                                                                  DeprMethodError;
                                                              END;

                                                   CaptionML=ENU=First User-Defined Depr. Date }
    { 44  ;   ;Use FA Ledger Check ;Boolean       ;InitValue=true;
                                                   OnValidate=BEGIN
                                                                if not "Use FA Ledger Check" then begin
                                                                  DeprBook.GET("Depreciation Book Code");
                                                                  DeprBook.TESTFIELD("Use FA Ledger Check",false);
                                                                  TESTFIELD("Fixed Depr. Amount below Zero",0);
                                                                  TESTFIELD("Depr. below Zero %",0);
                                                                end;
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=ENU=Use FA Ledger Check }
    { 45  ;   ;Last Maintenance Date;Date         ;CaptionML=ENU=Last Maintenance Date;
                                                   Editable=false }
    { 46  ;   ;Depr. below Zero %  ;Decimal       ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                "Fixed Depr. Amount below Zero" := 0;
                                                                if "Depr. below Zero %" > 0 then begin
                                                                  DeprBook.GET("Depreciation Book Code");
                                                                  DeprBook.TESTFIELD("Allow Depr. below Zero",true);
                                                                  TESTFIELD("Use FA Ledger Check",true);
                                                                end;
                                                              END;

                                                   CaptionML=ENU=Depr. below Zero %;
                                                   DecimalPlaces=2:8;
                                                   MinValue=0;
                                                   BlankZero=true }
    { 47  ;   ;Projected Disposal Date;Date       ;CaptionML=ENU=Projected Disposal Date }
    { 48  ;   ;Projected Proceeds on Disposal;Decimal;
                                                   CaptionML=ENU=Projected Proceeds on Disposal;
                                                   MinValue=0;
                                                   BlankZero=true;
                                                   AutoFormatType=1 }
    { 50  ;   ;Depr. Starting Date (Custom 1);Date;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=ENU=Depr. Starting Date (Custom 1) }
    { 51  ;   ;Depr. Ending Date (Custom 1);Date  ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=ENU=Depr. Ending Date (Custom 1) }
    { 52  ;   ;Accum. Depr. % (Custom 1);Decimal  ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=ENU=Accum. Depr. % (Custom 1);
                                                   DecimalPlaces=2:8;
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   BlankZero=true }
    { 53  ;   ;Depr. This Year % (Custom 1);Decimal;
                                                   CaptionML=ENU=Depr. This Year % (Custom 1);
                                                   DecimalPlaces=2:8;
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   BlankZero=true }
    { 54  ;   ;Property Class (Custom 1);Option   ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=ENU=Property Class (Custom 1);
                                                   OptionCaptionML=ENU=" ,Personal Property,Real Property";
                                                   OptionString=" ","Personal Property","Real Property" }
    { 55  ;   ;Description         ;Text50        ;CaptionML=ENU=Description;
                                                   Editable=false }
    { 56  ;   ;Main Asset/Component;Option        ;CaptionML=ENU=Main Asset/Component;
                                                   OptionCaptionML=ENU=" ,Main Asset,Component";
                                                   OptionString=" ","Main Asset",Component;
                                                   Editable=false }
    { 57  ;   ;Component of Main Asset;Code20     ;TableRelation="Fixed Asset";
                                                   CaptionML=ENU=Component of Main Asset;
                                                   Editable=false }
    { 58  ;   ;FA Add.-Currency Factor;Decimal    ;CaptionML=ENU=FA Add.-Currency Factor;
                                                   DecimalPlaces=0:15;
                                                   MinValue=0 }
    { 59  ;   ;Use Half-Year Convention;Boolean   ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                TestHalfYearConventionMethod;
                                                              END;

                                                   CaptionML=ENU=Use Half-Year Convention }
    { 60  ;   ;Use DB% First Fiscal Year;Boolean  ;OnValidate=BEGIN
                                                                if "Use DB% First Fiscal Year" then
                                                                  if not (("Depreciation Method" = "Depreciation Method"::"DB1/SL") or
                                                                          ("Depreciation Method" = "Depreciation Method"::"DB2/SL"))
                                                                  then
                                                                    DeprMethodError;
                                                              END;

                                                   CaptionML=ENU=Use DB% First Fiscal Year }
    { 61  ;   ;Temp. Ending Date   ;Date          ;CaptionML=ENU=Temp. Ending Date }
    { 62  ;   ;Temp. Fixed Depr. Amount;Decimal   ;CaptionML=ENU=Temp. Fixed Depr. Amount;
                                                   AutoFormatType=1 }
    { 63  ;   ;Ignore Def. Ending Book Value;Boolean;
                                                   OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=ENU=Ignore Def. Ending Book Value }
    { 70  ;   ;Default FA Depreciation Book;Boolean;
                                                   OnValidate=VAR
                                                                DefaultFADeprBook@1000 : Record "FA Depreciation Book";
                                                              BEGIN
                                                                DefaultFADeprBook.SETRANGE("FA No.","FA No.");
                                                                DefaultFADeprBook.SETRANGE("Default FA Depreciation Book",true);
                                                                if not DefaultFADeprBook.ISEMPTY then
                                                                  FIELDERROR("Default FA Depreciation Book",OnlyOneDefaultDeprBookErr);
                                                              END;

                                                   CaptionML=ENU=Default FA Depreciation Book }
  }
  KEYS
  {
    {    ;"FA No.","Depreciation Book Code"       ;Clustered=true }
    {    ;"Depreciation Book Code","FA No."        }
    {    ;"Depreciation Book Code","Component of Main Asset","Main Asset/Component" }
    {    ;"Main Asset/Component","Depreciation Book Code" }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You cannot rename a %1.';
      Text001@1001 : TextConst 'ENU=must not be 100';
      Text002@1002 : TextConst 'ENU=%1 is later than %2.';
      Text003@1003 : TextConst 'ENU=must not be %1';
      Text004@1004 : TextConst 'ENU=untitled';
      FA@1005 : Record "Fixed Asset";
      DeprBook@1006 : Record "Depreciation Book";
      FAMoveEntries@1007 : Codeunit "FA MoveEntries";
      FADateCalc@1008 : Codeunit "FA Date Calculation";
      DepreciationCalc@1009 : Codeunit "Depreciation Calculation";
      OnlyOneDefaultDeprBookErr@1010 : TextConst 'ENU=Only one fixed asset depreciation book can be marked as the default book';

    LOCAL PROCEDURE AdjustLinearMethod@1(VAR Amount1@1000 : Decimal;VAR Amount2@1001 : Decimal);
    BEGIN
      Amount1 := 0;
      Amount2 := 0;
      if "No. of Depreciation Years" = 0 then begin
        "No. of Depreciation Months" := 0;
        "Depreciation Ending Date" := 0D;
      end;
    END;

    LOCAL PROCEDURE ModifyDeprFields@2();
    BEGIN
      if ("Last Depreciation Date" > 0D) or
         ("Last Write-Down Date" > 0D) or
         ("Last Appreciation Date" > 0D) or
         ("Last Custom 1 Date" > 0D) or
         ("Last Custom 2 Date" > 0D) or
         ("Disposal Date" > 0D)
      then begin
        DeprBook.GET("Depreciation Book Code");
        DeprBook.TESTFIELD("Allow Changes in Depr. Fields",true);
      end;
    END;

    [External]
    PROCEDURE CalcDeprPeriod@4();
    VAR
      DeprBook2@1000 : Record "Depreciation Book";
    BEGIN
      if "Depreciation Starting Date" = 0D then begin
        "Depreciation Ending Date" := 0D;
        "No. of Depreciation Years" := 0;
        "No. of Depreciation Months" := 0;
      end;
      if ("Depreciation Starting Date" = 0D) or ("Depreciation Ending Date" = 0D) then begin
        "No. of Depreciation Years" := 0;
        "No. of Depreciation Months" := 0;
      end else begin
        if "Depreciation Starting Date" > "Depreciation Ending Date" then
          ERROR(
            Text002,
            FIELDCAPTION("Depreciation Starting Date"),FIELDCAPTION("Depreciation Ending Date"));
        DeprBook2.GET("Depreciation Book Code");
        if DeprBook2."Fiscal Year 365 Days" then begin
          "No. of Depreciation Months" := 0;
          "No. of Depreciation Years" := 0;
        end;
        if not DeprBook2."Fiscal Year 365 Days" then begin
          "No. of Depreciation Months" :=
            DepreciationCalc.DeprDays("Depreciation Starting Date","Depreciation Ending Date",false) / 30;
          "No. of Depreciation Months" := ROUND("No. of Depreciation Months",0.00000001);
          "No. of Depreciation Years" := ROUND("No. of Depreciation Months" / 12,0.00000001);
        end;
        "Straight-Line %" := 0;
        "Fixed Depr. Amount" := 0;
      end;
    END;

    LOCAL PROCEDURE CalcEndingDate@3() : Date;
    VAR
      EndingDate@1000 : Date;
    BEGIN
      if "No. of Depreciation Years" = 0 then
        exit(0D);
      EndingDate := FADateCalc.CalculateDate(
          "Depreciation Starting Date",ROUND("No. of Depreciation Years" * 360,1),false);
      EndingDate := DepreciationCalc.Yesterday(EndingDate,false);
      if EndingDate < "Depreciation Starting Date" then
        EndingDate := "Depreciation Starting Date";
      exit(EndingDate);
    END;

    [External]
    PROCEDURE GetExchangeRate@5() : Decimal;
    VAR
      DeprBook@1000 : Record "Depreciation Book";
    BEGIN
      DeprBook.GET("Depreciation Book Code");
      if not DeprBook."Use FA Exch. Rate in Duplic." then
        exit(0);
      if "FA Exchange Rate" > 0 then
        exit("FA Exchange Rate");
      exit(DeprBook."Default Exchange Rate");
    END;

    LOCAL PROCEDURE LinearMethod@9() : Boolean;
    BEGIN
      exit(
        "Depreciation Method" in
        ["Depreciation Method"::"Straight-Line",
         "Depreciation Method"::"DB1/SL",
         "Depreciation Method"::"DB2/SL"]);
    END;

    LOCAL PROCEDURE DecliningMethod@10() : Boolean;
    BEGIN
      exit(
        "Depreciation Method" in
        ["Depreciation Method"::"Declining-Balance 1",
         "Depreciation Method"::"Declining-Balance 2",
         "Depreciation Method"::"DB1/SL",
         "Depreciation Method"::"DB2/SL"]);
    END;

    LOCAL PROCEDURE UserDefinedMethod@11() : Boolean;
    BEGIN
      exit("Depreciation Method" = "Depreciation Method"::"User-Defined");
    END;

    LOCAL PROCEDURE TestHalfYearConventionMethod@8();
    BEGIN
      if "Depreciation Method" in
         ["Depreciation Method"::"Declining-Balance 2",
          "Depreciation Method"::"DB2/SL",
          "Depreciation Method"::"User-Defined"]
      then
        TESTFIELD("Use Half-Year Convention",false);
    END;

    LOCAL PROCEDURE DeprMethodError@7();
    BEGIN
      FIELDERROR("Depreciation Method",STRSUBSTNO(Text003,"Depreciation Method"));
    END;

    [External]
    PROCEDURE Caption@6() : Text[120];
    VAR
      FA@1000 : Record "Fixed Asset";
      DeprBook@1001 : Record "Depreciation Book";
    BEGIN
      if "FA No." = '' then
        exit(Text004);
      FA.GET("FA No.");
      DeprBook.GET("Depreciation Book Code");
      exit(
        STRSUBSTNO(
          '%1 %2 %3 %4',"FA No.",FA.Description,"Depreciation Book Code",DeprBook.Description));
    END;

    [External]
    PROCEDURE ShowBookValueAfterDisposal@12();
    VAR
      TempFALedgEntry@1000 : TEMPORARY Record "FA Ledger Entry";
      FALedgEntry@1001 : Record "FA Ledger Entry";
    BEGIN
      if "Disposal Date" > 0D then begin
        CLEAR(TempFALedgEntry);
        TempFALedgEntry.DELETEALL;
        TempFALedgEntry.SETCURRENTKEY("FA No.","Depreciation Book Code","FA Posting Date");
        DepreciationCalc.SetFAFilter(FALedgEntry,"FA No.","Depreciation Book Code",false);
        with FALedgEntry do begin
          if FIND('-') then
            repeat
              if (("FA Posting Category" = "FA Posting Category"::Disposal) and
                  ("FA Posting Type" <> "FA Posting Type"::"Book Value on Disposal") and
                  ("FA Posting Type" <> "FA Posting Type"::"Salvage Value")) or
                 "Part of Book Value"
              then begin
                TempFALedgEntry := FALedgEntry;
                TempFALedgEntry.INSERT;
              end;
            until NEXT = 0;
          TempFALedgEntry.SETRANGE("FA No.",TempFALedgEntry."FA No.");
          TempFALedgEntry.SETRANGE("Depreciation Book Code",TempFALedgEntry."Depreciation Book Code");
          PAGE.RUN(0,TempFALedgEntry);
        end;
      end else begin
        FALedgEntry.SETCURRENTKEY("FA No.","Depreciation Book Code","Part of Book Value","FA Posting Date");
        FALedgEntry.SETRANGE("FA No.","FA No.");
        FALedgEntry.SETRANGE("Depreciation Book Code","Depreciation Book Code");
        FALedgEntry.SETRANGE("Part of Book Value",true);
        PAGE.RUN(0,FALedgEntry);
      end;
    END;

    [External]
    PROCEDURE CalcBookValue@1001();
    BEGIN
      if "Disposal Date" > 0D then
        "Book Value" := 0
      else
        CALCFIELDS("Book Value");
    END;

    [External]
    PROCEDURE SetBookValueFiltersOnFALedgerEntry@13(VAR FALedgEntry@1000 : Record "FA Ledger Entry");
    BEGIN
      FALedgEntry.SETCURRENTKEY("FA No.","Depreciation Book Code","Part of Book Value","FA Posting Date");
      FALedgEntry.SETRANGE("FA No.","FA No.");
      FALedgEntry.SETRANGE("Depreciation Book Code","Depreciation Book Code");
      FALedgEntry.SETRANGE("Part of Book Value",true);
    END;

    [External]
    PROCEDURE LineIsReadyForAcquisition@14(FANo@1000 : Code[20]) : Boolean;
    VAR
      FADepreciationBook@1001 : Record "FA Depreciation Book";
      FASetup@1002 : Record "FA Setup";
    BEGIN
      FASetup.GET;
      exit(FADepreciationBook.GET(FANo,FASetup."Default Depr. Book") and FADepreciationBook.RecIsReadyForAcquisition);
    END;

    [External]
    PROCEDURE RecIsReadyForAcquisition@17() : Boolean;
    VAR
      FASetup@1000 : Record "FA Setup";
    BEGIN
      FASetup.GET;
      exit(
        ("Depreciation Book Code" = FASetup."Default Depr. Book") and
        ("FA Posting Group" <> '') and
        ("Depreciation Starting Date" > 0D) and
        ("No. of Depreciation Years" > 0) );
    END;

    [External]
    PROCEDURE UpdateBookValue@15();
    BEGIN
      if "Disposal Date" > 0D then
        "Book Value" := 0;
    END;

    BEGIN
    END.
  }
}

