OBJECT Codeunit 5458 Graph Collection Mgt - Contact
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      JSONManagement@1000 : Codeunit "JSON Management";
      WebsiteType@1003 : 'Other,Home,Work,Blog,Profile';
      PhoneType@1002 : 'Home,Business,Mobile,Other,Assistant,HomeFax,BusinessFax,OtherFax,Pager,Radio';
      AddressType@1004 : 'Unknown,Home,Business,Other';
      BusinessType@1005 : 'Company,Individual';
      FlagStatusOption@1001 : 'NotFlagged,Complete,Flagged';
      PropertyIdErr@1006 : TextConst '@@@="%1 and %2 are a string like: ''Integer {47ac1412-279b-41cb-891e-58904a94a48b} Name IsCustomer'' ";ENU=The PropertyId is not correct. Expected: %1, Actual %2.';
      BusinessTypePropertyIdTxt@1007 : TextConst '@@@={Locked};ENU=String {bdba944b-fc2b-47a1-8ba4-cafc4ae13ea2} Name BusinessType';
      IsCustomerPropertyIdTxt@1008 : TextConst '@@@={Locked};ENU=Integer {47ac1412-279b-41cb-891e-58904a94a48b} Name IsCustomer';
      IsVendorPropertyIdTxt@1009 : TextConst '@@@={Locked};ENU=Integer {ccf57c46-c10e-41bb-b8c5-362b185d2f98} Name IsVendor';
      IsBankPropertyIdTxt@1010 : TextConst '@@@={Locked};ENU=Integer {a8ef117a-16d9-4cc6-965a-d2fbe0177e61} Name IsBank';
      IsNavCreatedPropertyIdTxt@1014 : TextConst '@@@={Locked};ENU=Integer {6023a623-3b6c-492d-9ef5-811850c088ac} Name IsNavCreated';
      IsLeadPropertyIdTxt@1011 : TextConst '@@@={Locked};ENU=Integer {37829b75-e5e4-4582-ae12-36f754e4bd7b} Name IsLead';
      IsContactPropertyIdTxt@1012 : TextConst '@@@={Locked};ENU=Integer {f4be2302-782e-483d-8ba4-26fb6535f665} Name IsContact';
      IsPartnerPropertyIdTxt@1013 : TextConst '@@@={Locked};ENU=Integer {65ebabde-6946-455f-b918-a88ee36182a9} Name IsPartner';
      NavIntegrationIdTxt@1015 : TextConst '@@@={Locked};ENU=String {d048f561-4dd0-443c-a8d8-f397fb74f1df} Name NavIntegrationId';

    [External]
    PROCEDURE GetEmailAddress@6(Index@1001 : Integer;VAR Name@1002 : Text;VAR Address@1003 : Text);
    VAR
      JObject@1007 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      CLEAR(Name);
      CLEAR(Address);
      if Index >= JSONManagement.GetCollectionCount then
        exit;

      JSONManagement.GetJObjectFromCollectionByIndex(JObject,Index);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'Name',Name);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'Address',Address);
    END;

    [External]
    PROCEDURE AddEmailAddress@5(Name@1000 : Text;Address@1001 : Text);
    VAR
      JObject@1002 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      if Address = '' then
        exit;

      JObject := JObject.JObject;
      JSONManagement.AddJPropertyToJObject(JObject,'Name',Name);
      JSONManagement.AddJPropertyToJObject(JObject,'Address',Address);
      JSONManagement.AddJObjectToCollection(JObject);
    END;

    [External]
    PROCEDURE UpdateEmailAddress@76(EmailAddressesString@1003 : Text;Index@1002 : Integer;Address@1000 : Text) : Text;
    VAR
      JObject@1001 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      JSONManagement.InitializeCollection(EmailAddressesString);
      if Index > JSONManagement.GetCollectionCount then // cannot add where index would leave empty slots.
        exit(EmailAddressesString);

      if JSONManagement.GetJObjectFromCollectionByIndex(JObject,Index) then begin
        JSONManagement.ReplaceOrAddJPropertyInJObject(JObject,'Name','');
        JSONManagement.ReplaceOrAddJPropertyInJObject(JObject,'Address',Address)
      end else
        AddEmailAddress('',Address);

      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE GetWebsiteByIndex@8(Index@1000 : Integer;VAR Type@1004 : Option;VAR Address@1003 : Text;VAR DisplayName@1002 : Text;VAR Name@1001 : Text);
    VAR
      JObject@1007 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      if Index >= JSONManagement.GetCollectionCount then
        exit;

      JSONManagement.GetJObjectFromCollectionByIndex(JObject,Index);
      JSONManagement.GetEnumPropertyValueFromJObjectByName(JObject,'Type',Type);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'Address',Address);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'DisplayName',DisplayName);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'Name',Name);
    END;

    LOCAL PROCEDURE GetWebsiteByType@81(Type@1003 : Option;VAR Address@1002 : Text;VAR DisplayName@1001 : Text;VAR Name@1000 : Text);
    VAR
      JObject@1004 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      WebsiteType := Type;
      if not JSONManagement.GetJObjectFromCollectionByPropertyValue(JObject,'Type',FORMAT(WebsiteType,0,0)) then
        exit;
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'Address',Address);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'DisplayName',DisplayName);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'Name',Name);
    END;

    [External]
    PROCEDURE AddWebsite@10(Type@1000 : Option;Address@1001 : Text;DisplayName@1002 : Text;Name@1003 : Text);
    VAR
      JObject@1004 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      if Address = '' then
        exit;
      JObject := JObject.JObject;
      WebsiteType := Type;
      JSONManagement.AddJPropertyToJObject(JObject,'Type',FORMAT(WebsiteType,0,0));
      JSONManagement.AddJPropertyToJObject(JObject,'Address',Address);
      JSONManagement.AddJPropertyToJObject(JObject,'DisplayName',DisplayName);
      JSONManagement.AddJPropertyToJObject(JObject,'Name',Name);
      JSONManagement.AddJObjectToCollection(JObject);
    END;

    [External]
    PROCEDURE UpdateWebsite@78(Type@1000 : Option;Address@1001 : Text);
    VAR
      JObject@1004 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      WebsiteType := Type;
      if not JSONManagement.GetJObjectFromCollectionByPropertyValue(JObject,'Type',FORMAT(WebsiteType,0,0)) then begin
        if Address = '' then
          exit;
        JObject := JObject.JObject;
        JSONManagement.AddJObjectToCollection(JObject);
      end else
        JObject.Remove('Type');
      JSONManagement.ReplaceOrAddJPropertyInJObject(JObject,'Address',Address);
    END;

    [External]
    PROCEDURE GetImAddress@17(Index@1000 : Integer;VAR ImAddress@1001 : Text);
    VAR
      JObject@1004 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      if Index >= JSONManagement.GetCollectionCount then
        exit;

      JSONManagement.GetJObjectFromCollectionByIndex(JObject,Index);
      JSONManagement.GetStringValueFromJObject(JObject,ImAddress);
    END;

    [External]
    PROCEDURE AddImAddress@18(ImAddress@1000 : Text);
    VAR
      JObject@1001 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      if ImAddress = '' then
        exit;

      JObject := JObject.JObject;
      JSONManagement.AddJValueToJObject(JObject,ImAddress);
      JSONManagement.AddJObjectToCollection(JObject);
    END;

    [External]
    PROCEDURE GetPhoneByIndex@26(Index@1000 : Integer;VAR Type@1001 : Option;VAR Number@1002 : Text);
    VAR
      JObject@1005 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      if Index >= JSONManagement.GetCollectionCount then
        exit;

      JSONManagement.GetJObjectFromCollectionByIndex(JObject,Index);
      JSONManagement.GetEnumPropertyValueFromJObjectByName(JObject,'Type',Type);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'Number',Number);
    END;

    [External]
    PROCEDURE GetPhoneByType@60(Type@1001 : Option;VAR Number@1002 : Text);
    VAR
      JObject@1005 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      PhoneType := Type;
      if not JSONManagement.GetJObjectFromCollectionByPropertyValue(JObject,'Type',FORMAT(PhoneType,0,0)) then
        exit;

      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'Number',Number);
    END;

    [External]
    PROCEDURE AddPhone@27(Type@1001 : Option;Number@1000 : Text);
    VAR
      JObject@1002 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      PhoneType := Type;
      if Number = '' then
        exit;

      JObject := JObject.JObject;
      JSONManagement.AddJPropertyToJObject(JObject,'Type',FORMAT(PhoneType,0,0));
      JSONManagement.AddJPropertyToJObject(JObject,'Number',Number);
      JSONManagement.AddJObjectToCollection(JObject);
    END;

    [External]
    PROCEDURE GetPostalAddressByIndex@23(Index@1001 : Integer;VAR Type@1002 : Option;VAR PostOfficeBox@1003 : Text;VAR Street@1000 : Text;VAR City@1004 : Text;VAR State@1008 : Text;VAR CountryOrRegion@1009 : Text;VAR PostalCode@1010 : Text);
    VAR
      JObject@1007 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      if Index >= JSONManagement.GetCollectionCount then
        exit;

      JSONManagement.GetJObjectFromCollectionByIndex(JObject,Index);
      JSONManagement.GetEnumPropertyValueFromJObjectByName(JObject,'Type',Type);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'PostOfficeBox',PostOfficeBox);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'Street',Street);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'City',City);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'State',State);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'CountryOrRegion',CountryOrRegion);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'PostalCode',PostalCode);
    END;

    LOCAL PROCEDURE GetPostalAddressByType@41(Type@1005 : Option;VAR Address@1009 : Text[50];VAR Address2@1008 : Text[50];VAR City@1004 : Text[30];VAR County@1003 : Text[30];VAR CountryRegionCode@1002 : Code[10];VAR PostCode@1001 : Code[20]);
    VAR
      JObject@1006 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      value@1007 : Text;
    BEGIN
      AddressType := Type;
      if not JSONManagement.GetJObjectFromCollectionByPropertyValue(JObject,'Type',FORMAT(AddressType,0,0)) then
        exit;

      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'Street',value);
      SplitStreet(value,Address,Address2);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'City',value);
      City := COPYSTR(value,1,MAXSTRLEN(value));
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'State',value);
      County := COPYSTR(value,1,MAXSTRLEN(value));
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'CountryOrRegion',value);
      CountryRegionCode := FindCountryRegionCode(value);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JObject,'PostalCode',value);
      PostCode := COPYSTR(value,1,MAXSTRLEN(PostCode));
    END;

    [External]
    PROCEDURE AddPostalAddress@20(Type@1007 : Option;PostOfficeBox@1006 : Text;Street@1005 : Text;City@1004 : Text;State@1002 : Text;CountryOrRegion@1001 : Text;PostalCode@1000 : Text);
    VAR
      JObject@1003 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      JObject := JObject.JObject;
      AddressType := Type;
      JSONManagement.AddJPropertyToJObject(JObject,'Type',FORMAT(AddressType,0,0));
      JSONManagement.AddJPropertyToJObject(JObject,'PostOfficeBox',PostOfficeBox);
      JSONManagement.AddJPropertyToJObject(JObject,'Street',Street);
      JSONManagement.AddJPropertyToJObject(JObject,'City',City);
      JSONManagement.AddJPropertyToJObject(JObject,'State',State);
      JSONManagement.AddJPropertyToJObject(JObject,'CountryOrRegion',CountryOrRegion);
      JSONManagement.AddJPropertyToJObject(JObject,'PostalCode',PostalCode);
      JSONManagement.AddJObjectToCollection(JObject);
    END;

    [External]
    PROCEDURE GetChildren@11(Index@1000 : Integer;VAR Child@1001 : Text);
    VAR
      JObject@1004 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      if Index >= JSONManagement.GetCollectionCount then
        exit;

      JSONManagement.GetJObjectFromCollectionByIndex(JObject,Index);
      JSONManagement.GetStringValueFromJObject(JObject,Child);
    END;

    [External]
    PROCEDURE AddChildren@9(Child@1000 : Text);
    VAR
      JObject@1001 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      if Child = '' then
        exit;

      JObject := JObject.JObject;
      JSONManagement.AddJValueToJObject(JObject,Child);
      JSONManagement.AddJObjectToCollection(JObject);
    END;

    [External]
    PROCEDURE GetFlag@30(VAR CompletedDateTime@1000 : Text;VAR CompletedTimeZone@1007 : Text;VAR DueDateTime@1001 : Text;VAR DueTimeZone@1008 : Text;VAR StartDateTime@1002 : Text;VAR StartTimeZone@1009 : Text;VAR FlagStatus@1003 : Option);
    VAR
      JsonObject@1004 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      JObjectVariant@1010 : Variant;
    BEGIN
      JSONManagement.GetJSONObject(JsonObject);
      if JSONManagement.GetPropertyValueFromJObjectByName(JsonObject,'CompletedDateTime',JObjectVariant) then begin
        JSONManagement.GetStringPropertyValueFromJObjectByName(JObjectVariant,'CompletedDateTime',CompletedDateTime);
        JSONManagement.GetStringPropertyValueFromJObjectByName(JObjectVariant,'CompletedTimeZone',CompletedTimeZone);
      end;
      if JSONManagement.GetPropertyValueFromJObjectByName(JsonObject,'DueDateTime',JObjectVariant) then begin;
        JSONManagement.GetStringPropertyValueFromJObjectByName(JObjectVariant,'DateTime',DueDateTime);
        JSONManagement.GetStringPropertyValueFromJObjectByName(JObjectVariant,'TimeZone',DueTimeZone);
      end;
      if JSONManagement.GetPropertyValueFromJObjectByName(JsonObject,'StartDateTime',JObjectVariant) then begin;
        JSONManagement.GetStringPropertyValueFromJObjectByName(JObjectVariant,'DateTime',StartDateTime);
        JSONManagement.GetStringPropertyValueFromJObjectByName(JObjectVariant,'TimeZone',StartTimeZone);
      end;

      JSONManagement.GetEnumPropertyValueFromJObjectByName(JsonObject,'FlagStatus',FlagStatusOption);
      FlagStatus := FlagStatusOption;
    END;

    [External]
    PROCEDURE AddFlag@31(CompletedDateTime@1007 : Text;CompletedTimeZone@1006 : Text;DueDateTime@1005 : Text;DueTimeZone@1003 : Text;StartDateTime@1002 : Text;StartTimeZone@1001 : Text;FlagStatus@1000 : Option);
    VAR
      JObject@1004 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      JsonObject@1008 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      JSONManagement.GetJSONObject(JsonObject);

      JObject := JObject.JObject;
      JSONManagement.AddJPropertyToJObject(JObject,'DateTime',CompletedDateTime);
      JSONManagement.AddJPropertyToJObject(JObject,'TimeZone',CompletedTimeZone);
      JSONManagement.AddJObjectToJObject(JsonObject,'CompletedDateTime',JObject);
      JObject := JObject.JObject;

      JSONManagement.AddJPropertyToJObject(JObject,'DateTime',DueDateTime);
      JSONManagement.AddJPropertyToJObject(JObject,'TimeZone',DueTimeZone);
      JSONManagement.AddJObjectToJObject(JsonObject,'DueDateTime',JObject);
      JObject := JObject.JObject;
      JSONManagement.AddJPropertyToJObject(JObject,'DateTime',StartDateTime);
      JSONManagement.AddJPropertyToJObject(JObject,'TimeZone',StartTimeZone);
      JSONManagement.AddJObjectToJObject(JsonObject,'StartDateTime',JObject);
      FlagStatusOption := FlagStatus;
      JSONManagement.AddJPropertyToJObject(JsonObject,'FlagStatus',FORMAT(FlagStatusOption,0,0));
    END;

    [External]
    PROCEDURE GetCategory@15(Index@1001 : Integer;VAR Category@1002 : Text);
    VAR
      JObject@1007 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      if Index >= JSONManagement.GetCollectionCount then
        exit;

      JSONManagement.GetJObjectFromCollectionByIndex(JObject,Index);
      JSONManagement.GetStringValueFromJObject(JObject,Category);
    END;

    [External]
    PROCEDURE AddCategory@12(Category@1000 : Text);
    VAR
      JObject@1003 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      JObject := JObject.JObject;
      JSONManagement.AddJValueToJObject(JObject,Category);
      JSONManagement.AddJObjectToCollection(JObject);
    END;

    LOCAL PROCEDURE HasPostalAddress@42(Type@1000 : Option) : Boolean;
    VAR
      JObject@1001 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      AddressType := Type;
      exit(JSONManagement.GetJObjectFromCollectionByPropertyValue(JObject,'Type',FORMAT(AddressType,0,0)))
    END;

    [External]
    PROCEDURE HasHomeAddressOrPhone@43(PostalAddressesString@1000 : Text;PhonesString@1002 : Text;WebsitesString@1006 : Text) : Boolean;
    VAR
      HasAddress@1004 : Boolean;
      HasPhones@1007 : Boolean;
    BEGIN
      JSONManagement.InitializeCollection(PostalAddressesString);
      HasAddress := HasPostalAddress(AddressType::Home);
      JSONManagement.InitializeCollection(PhonesString);
      HasPhones := HasPhone(PhoneType::Home) or HasPhone(PhoneType::HomeFax);
      JSONManagement.InitializeCollection(WebsitesString);
      exit(HasAddress or HasPhones or HasWebsite(WebsiteType::Home));
    END;

    [External]
    PROCEDURE HasBusinessAddressOrPhone@53(PostalAddressesString@1000 : Text;PhonesString@1002 : Text;WebsitesString@1006 : Text) : Boolean;
    VAR
      HasAddress@1001 : Boolean;
      HasPhones@1007 : Boolean;
    BEGIN
      JSONManagement.InitializeCollection(PostalAddressesString);
      HasAddress := HasPostalAddress(AddressType::Business);
      JSONManagement.InitializeCollection(PhonesString);
      HasPhones := HasPhone(PhoneType::Business) or HasPhone(PhoneType::BusinessFax);
      JSONManagement.InitializeCollection(WebsitesString);
      exit(HasAddress or HasPhones or HasWebsite(WebsiteType::Work));
    END;

    [External]
    PROCEDURE HasBusinessAddress@100(PostalAddressesString@1000 : Text) : Boolean;
    BEGIN
      JSONManagement.InitializeCollection(PostalAddressesString);
      exit(HasPostalAddress(AddressType::Business));
    END;

    [External]
    PROCEDURE HasOtherAddressOrPhone@75(PostalAddressesString@1000 : Text;PhonesString@1002 : Text;WebsitesString@1006 : Text) : Boolean;
    VAR
      HasAddress@1001 : Boolean;
      HasPhones@1007 : Boolean;
    BEGIN
      JSONManagement.InitializeCollection(PostalAddressesString);
      HasAddress := HasPostalAddress(AddressType::Other);
      JSONManagement.InitializeCollection(PhonesString);
      HasPhones := HasPhone(PhoneType::Other) or HasPhone(PhoneType::OtherFax);
      JSONManagement.InitializeCollection(WebsitesString);
      exit(HasAddress or HasPhones or HasWebsite(WebsiteType::Other));
    END;

    LOCAL PROCEDURE UpdatePostalAddress@56(Type@1010 : Option;Address@1005 : Text[50];Address2@1007 : Text[50];City@1004 : Text[30];County@1003 : Text[30];CountryRegionCode@1002 : Code[10];PostCode@1001 : Code[20]);
    VAR
      JObject@1006 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      AddressType := Type;
      if (Address = '') and (Address2 = '') and (City = '') and (County = '') and (PostCode = '') then begin
        if JSONManagement.GetJObjectFromCollectionByPropertyValue(JObject,'Type',FORMAT(AddressType,0,0)) then
          JObject.Remove;
        exit;
      end;

      if not JSONManagement.GetJObjectFromCollectionByPropertyValue(JObject,'Type',FORMAT(AddressType,0,0)) then begin
        JObject := JObject.JObject;
        JSONManagement.AddJPropertyToJObject(JObject,'Type',FORMAT(AddressType,0,0));
        JSONManagement.AddJObjectToCollection(JObject);
        JSONManagement.GetJObjectFromCollectionByPropertyValue(JObject,'Type',FORMAT(AddressType,0,0));
      end;
      JSONManagement.ReplaceOrAddJPropertyInJObject(JObject,'Street',ConcatenateStreet(Address,Address2));
      JSONManagement.ReplaceOrAddJPropertyInJObject(JObject,'City',City);
      JSONManagement.ReplaceOrAddJPropertyInJObject(JObject,'State',County);
      JSONManagement.ReplaceOrAddJPropertyInJObject(JObject,'CountryOrRegion',CountryRegionCode);
      JSONManagement.ReplaceOrAddJPropertyInJObject(JObject,'PostalCode',PostCode);
    END;

    [External]
    PROCEDURE UpdateHomeAddress@1(PostalAddressesString@1000 : Text;Address@1007 : Text[50];Address2@1005 : Text[50];City@1004 : Text[30];County@1003 : Text[30];CountryRegionCode@1002 : Code[10];PostCode@1001 : Code[20]) : Text;
    BEGIN
      JSONManagement.InitializeCollection(PostalAddressesString);
      UpdatePostalAddress(AddressType::Home,Address,Address2,City,County,CountryRegionCode,PostCode);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE UpdateBusinessAddress@61(PostalAddressesString@1000 : Text;Address@1007 : Text[50];Address2@1005 : Text[50];City@1004 : Text[30];County@1003 : Text[30];CountryRegionCode@1002 : Code[10];PostCode@1001 : Code[20]) : Text;
    BEGIN
      JSONManagement.InitializeCollection(PostalAddressesString);
      UpdatePostalAddress(AddressType::Business,Address,Address2,City,County,CountryRegionCode,PostCode);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE UpdateOtherAddress@64(PostalAddressesString@1000 : Text;Address@1007 : Text[50];Address2@1005 : Text[50];City@1004 : Text[30];County@1003 : Text[30];CountryRegionCode@1002 : Code[10];PostCode@1001 : Code[20]) : Text;
    BEGIN
      JSONManagement.InitializeCollection(PostalAddressesString);
      UpdatePostalAddress(AddressType::Other,Address,Address2,City,County,CountryRegionCode,PostCode);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE GetHomeAddress@38(PostalAddressesString@1005 : Text;VAR Address@1007 : Text[50];VAR Address2@1004 : Text[50];VAR City@1003 : Text[30];VAR County@1002 : Text[30];VAR CountryRegionCode@1001 : Code[10];VAR PostCode@1000 : Code[20]);
    BEGIN
      JSONManagement.InitializeCollection(PostalAddressesString);
      GetPostalAddressByType(AddressType::Home,Address,Address2,City,County,CountryRegionCode,PostCode);
    END;

    [External]
    PROCEDURE GetBusinessAddress@39(PostalAddressesString@1005 : Text;VAR Address@1007 : Text[50];VAR Address2@1004 : Text[50];VAR City@1003 : Text[30];VAR County@1002 : Text[30];VAR CountryRegionCode@1001 : Code[10];VAR PostCode@1000 : Code[20]);
    BEGIN
      JSONManagement.InitializeCollection(PostalAddressesString);
      GetPostalAddressByType(AddressType::Business,Address,Address2,City,County,CountryRegionCode,PostCode);
    END;

    [External]
    PROCEDURE GetOtherAddress@40(PostalAddressesString@1005 : Text;VAR Address@1007 : Text[50];VAR Address2@1004 : Text[50];VAR City@1003 : Text[30];VAR County@1002 : Text[30];VAR CountryRegionCode@1001 : Code[10];VAR PostCode@1000 : Code[20]);
    BEGIN
      JSONManagement.InitializeCollection(PostalAddressesString);
      GetPostalAddressByType(AddressType::Other,Address,Address2,City,County,CountryRegionCode,PostCode);
    END;

    LOCAL PROCEDURE HasPhone@77(Type@1000 : Option) : Boolean;
    VAR
      JObject@1001 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      PhoneType := Type;
      exit(JSONManagement.GetJObjectFromCollectionByPropertyValue(JObject,'Type',FORMAT(PhoneType,0,0)));
    END;

    LOCAL PROCEDURE UpdatePhone@45(Type@1001 : Option;Number@1000 : Text);
    VAR
      JObject@1002 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      PhoneType := Type;
      if not JSONManagement.GetJObjectFromCollectionByPropertyValue(JObject,'Type',FORMAT(PhoneType,0,0)) then begin
        if Number = '' then
          exit;
        JObject := JObject.JObject;
        JSONManagement.AddJPropertyToJObject(JObject,'Type',FORMAT(PhoneType,0,0));
        JSONManagement.AddJObjectToCollection(JObject);
        JSONManagement.GetJObjectFromCollectionByPropertyValue(JObject,'Type',FORMAT(PhoneType,0,0))
      end;
      JSONManagement.ReplaceOrAddJPropertyInJObject(JObject,'Number',Number);
    END;

    [External]
    PROCEDURE UpdateHomePhone@46(PhonesString@1000 : Text;Number@1001 : Text) : Text;
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      UpdatePhone(PhoneType::Home,Number);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE UpdateBusinessPhone@48(PhonesString@1001 : Text;Number@1000 : Text) : Text;
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      UpdatePhone(PhoneType::Business,Number);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE UpdateMobilePhone@49(PhonesString@1001 : Text;Number@1000 : Text) : Text;
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      UpdatePhone(PhoneType::Mobile,Number);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE UpdateOtherPhone@50(PhonesString@1001 : Text;Number@1000 : Text) : Text;
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      UpdatePhone(PhoneType::Other,Number);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE UpdateAssistantPhone@52(PhonesString@1001 : Text;Number@1000 : Text) : Text;
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      UpdatePhone(PhoneType::Assistant,Number);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE UpdateHomeFaxPhone@54(PhonesString@1001 : Text;Number@1000 : Text) : Text;
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      UpdatePhone(PhoneType::HomeFax,Number);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE UpdateBusinessFaxPhone@55(PhonesString@1001 : Text;Number@1000 : Text) : Text;
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      UpdatePhone(PhoneType::BusinessFax,Number);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE UpdateOtherFaxPhone@57(PhonesString@1001 : Text;Number@1000 : Text) : Text;
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      UpdatePhone(PhoneType::OtherFax,Number);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE UpdatePagerPhone@58(PhonesString@1001 : Text;Number@1000 : Text) : Text;
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      UpdatePhone(PhoneType::Pager,Number);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE UpdateRadioPhone@59(PhonesString@1001 : Text;Number@1000 : Text) : Text;
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      UpdatePhone(PhoneType::Radio,Number);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE GetHomePhone@74(PhonesString@1000 : Text;VAR Number@1001 : Text);
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      GetPhoneByType(PhoneType::Home,Number);
    END;

    [External]
    PROCEDURE GetBusinessPhone@73(PhonesString@1001 : Text;VAR Number@1000 : Text);
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      GetPhoneByType(PhoneType::Business,Number);
    END;

    [External]
    PROCEDURE GetMobilePhone@72(PhonesString@1001 : Text;VAR Number@1000 : Text);
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      GetPhoneByType(PhoneType::Mobile,Number);
    END;

    [External]
    PROCEDURE GetOtherPhone@71(PhonesString@1001 : Text;VAR Number@1000 : Text);
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      GetPhoneByType(PhoneType::Other,Number);
    END;

    [External]
    PROCEDURE GetAssistantPhone@70(PhonesString@1001 : Text;VAR Number@1000 : Text);
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      GetPhoneByType(PhoneType::Assistant,Number);
    END;

    [External]
    PROCEDURE GetHomeFaxPhone@69(PhonesString@1001 : Text;VAR Number@1000 : Text);
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      GetPhoneByType(PhoneType::HomeFax,Number);
    END;

    [External]
    PROCEDURE GetBusinessFaxPhone@68(PhonesString@1001 : Text;VAR Number@1000 : Text);
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      GetPhoneByType(PhoneType::BusinessFax,Number);
    END;

    [External]
    PROCEDURE GetOtherFaxPhone@67(PhonesString@1001 : Text;VAR Number@1000 : Text);
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      GetPhoneByType(PhoneType::OtherFax,Number);
    END;

    [External]
    PROCEDURE GetPagerPhone@66(PhonesString@1001 : Text;VAR Number@1000 : Text);
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      GetPhoneByType(PhoneType::Pager,Number);
    END;

    [External]
    PROCEDURE GetRadioPhone@65(PhonesString@1001 : Text;VAR Number@1000 : Text);
    BEGIN
      JSONManagement.InitializeCollection(PhonesString);
      GetPhoneByType(PhoneType::Radio,Number);
    END;

    LOCAL PROCEDURE HasWebsite@89(Type@1002 : Option) : Boolean;
    VAR
      JObject@1001 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      WebsiteType := Type;
      exit(JSONManagement.GetJObjectFromCollectionByPropertyValue(JObject,'Type',FORMAT(WebsiteType,0,0)));
    END;

    [External]
    PROCEDURE GetWorkWebsite@79(WebsitesString@1000 : Text;VAR Address@1001 : Text[80]);
    VAR
      Name@1003 : Text;
      DisplayName@1004 : Text;
    BEGIN
      JSONManagement.InitializeCollection(WebsitesString);
      GetWebsiteByType(WebsiteType::Work,Address,Name,DisplayName);
    END;

    [External]
    PROCEDURE GetHomeWebsite@82(WebsitesString@1000 : Text;VAR Address@1001 : Text[80]);
    VAR
      Name@1003 : Text;
      DisplayName@1004 : Text;
    BEGIN
      JSONManagement.InitializeCollection(WebsitesString);
      GetWebsiteByType(WebsiteType::Home,Address,Name,DisplayName);
    END;

    [External]
    PROCEDURE UpdateWorkWebsite@80(WebsitesString@1001 : Text;Address@1000 : Text[80]) : Text;
    BEGIN
      JSONManagement.InitializeCollection(WebsitesString);
      UpdateWebsite(WebsiteType::Work,Address);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE UpdateHomeWebsite@85(WebsitesString@1001 : Text;Address@1000 : Text[80]) : Text;
    BEGIN
      JSONManagement.InitializeCollection(WebsitesString);
      UpdateWebsite(WebsiteType::Home,Address);
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE HasBusinessType@3(BusinessTypeString@1000 : Text) : Boolean;
    BEGIN
      exit(HasExtendedProperty(BusinessTypeString,BusinessTypePropertyIdTxt));
    END;

    [TryFunction]
    [External]
    PROCEDURE TryGetBusinessTypeValue@7(BusinessTypeString@1000 : Text;VAR Value@1003 : Text);
    VAR
      JsonObject@1004 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      PropertyId@1002 : Text;
    BEGIN
      JSONManagement.InitializeObject(BusinessTypeString);
      JSONManagement.GetJSONObject(JsonObject);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JsonObject,'PropertyId',PropertyId);
      if not (PropertyId = BusinessTypePropertyIdTxt) then
        ERROR(PropertyIdErr,BusinessTypePropertyIdTxt,PropertyId);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JsonObject,'Value',Value);
      EVALUATE(BusinessType,Value,0);
    END;

    [External]
    PROCEDURE GetBusinessType@33(BusinessTypeString@1001 : Text;VAR Type@1000 : Option);
    VAR
      JsonObject@1002 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      PropertyId@1003 : Text;
    BEGIN
      JSONManagement.InitializeObject(BusinessTypeString);
      JSONManagement.GetJSONObject(JsonObject);
      if JSONManagement.GetStringPropertyValueFromJObjectByName(JsonObject,'PropertyId',PropertyId) then
        if PropertyId = BusinessTypePropertyIdTxt then begin
          JSONManagement.GetEnumPropertyValueFromJObjectByName(JsonObject,'Value',BusinessType);
          Type := BusinessType;
          exit;
        end;

      Type := BusinessType::Individual;
    END;

    [External]
    PROCEDURE AddBusinessType@34(Type@1000 : Option) : Text;
    VAR
      JsonObject@1002 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      JSONManagement.InitializeEmptyObject;
      JSONManagement.GetJSONObject(JsonObject);
      BusinessType := Type;
      JSONManagement.AddJPropertyToJObject(JsonObject,'PropertyId',BusinessTypePropertyIdTxt);
      JSONManagement.AddJPropertyToJObject(JsonObject,'Value',FORMAT(BusinessType,0,0));
      exit(JSONManagement.WriteObjectToString);
    END;

    LOCAL PROCEDURE HasExtendedProperty@14(ExtendedPropertyString@1000 : Text;ExpectedPropertyId@1001 : Text) : Boolean;
    VAR
      JsonObject@1003 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      PropertyId@1002 : Text;
    BEGIN
      JSONManagement.InitializeObject(ExtendedPropertyString);
      JSONManagement.GetJSONObject(JsonObject);
      if JSONManagement.GetStringPropertyValueFromJObjectByName(JsonObject,'PropertyId',PropertyId) then
        exit(ExpectedPropertyId = PropertyId);
    END;

    LOCAL PROCEDURE GetExtendedPropertyBoolValue@16(ExtendedPropertyString@1001 : Text;ExpectedPropertyId@1000 : Text;VAR Value@1002 : Text);
    VAR
      JsonObject@1004 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      PropertyId@1003 : Text;
      BooleanValue@1005 : Boolean;
    BEGIN
      JSONManagement.InitializeObject(ExtendedPropertyString);
      JSONManagement.GetJSONObject(JsonObject);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JsonObject,'PropertyId',PropertyId);
      if not (PropertyId = ExpectedPropertyId) then
        ERROR(PropertyIdErr,ExpectedPropertyId,PropertyId);
      JSONManagement.GetStringPropertyValueFromJObjectByName(JsonObject,'Value',Value);
      EVALUATE(BooleanValue,Value,2);
    END;

    [External]
    PROCEDURE HasIsCustomer@13(IsCustomerString@1000 : Text) : Boolean;
    BEGIN
      exit(HasExtendedProperty(IsCustomerString,IsCustomerPropertyIdTxt));
    END;

    [External]
    PROCEDURE GetIsCustomer@83(IsCustomerString@1001 : Text) IsCustomer : Boolean;
    VAR
      JsonObject@1000 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      PropertyId@1003 : Text;
    BEGIN
      JSONManagement.InitializeObject(IsCustomerString);
      JSONManagement.GetJSONObject(JsonObject);

      if JSONManagement.GetStringPropertyValueFromJObjectByName(JsonObject,'PropertyId',PropertyId) then
        if PropertyId = IsCustomerPropertyIdTxt then begin
          JSONManagement.GetBoolPropertyValueFromJObjectByName(JsonObject,'Value',IsCustomer);
          exit(IsCustomer);
        end;

      exit(false);
    END;

    [TryFunction]
    [External]
    PROCEDURE TryGetIsCustomerValue@63(IsCustomerString@1000 : Text;VAR Value@1001 : Text);
    BEGIN
      GetExtendedPropertyBoolValue(IsCustomerString,IsCustomerPropertyIdTxt,Value);
    END;

    [External]
    PROCEDURE AddIsCustomer@47(IsCustomer@1000 : Boolean) : Text;
    VAR
      JsonObject@1001 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      JSONManagement.InitializeEmptyObject;
      JSONManagement.GetJSONObject(JsonObject);

      JSONManagement.AddJPropertyToJObject(JsonObject,'PropertyId',IsCustomerPropertyIdTxt);
      JSONManagement.AddJPropertyToJObject(JsonObject,'Value',FORMAT(IsCustomer,0,2));

      exit(JSONManagement.WriteObjectToString);
    END;

    [External]
    PROCEDURE HasIsVendor@21(IsVendorString@1000 : Text) : Boolean;
    BEGIN
      exit(HasExtendedProperty(IsVendorString,IsVendorPropertyIdTxt));
    END;

    [External]
    PROCEDURE GetIsVendor@92(IsVendorString@1001 : Text) IsVendor : Boolean;
    VAR
      JsonObject@1000 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      PropertyId@1003 : Text;
    BEGIN
      JSONManagement.InitializeObject(IsVendorString);
      JSONManagement.GetJSONObject(JsonObject);

      if JSONManagement.GetStringPropertyValueFromJObjectByName(JsonObject,'PropertyId',PropertyId) then
        if PropertyId = IsVendorPropertyIdTxt then begin
          JSONManagement.GetBoolPropertyValueFromJObjectByName(JsonObject,'Value',IsVendor);
          exit(IsVendor);
        end;
      exit(false);
    END;

    [TryFunction]
    [External]
    PROCEDURE TryGetIsVendorValue@19(IsVendorString@1000 : Text;VAR Value@1001 : Text);
    BEGIN
      GetExtendedPropertyBoolValue(IsVendorString,IsVendorPropertyIdTxt,Value);
    END;

    [External]
    PROCEDURE AddIsVendor@91(IsVendor@1000 : Boolean) : Text;
    VAR
      JsonObject@1001 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      JSONManagement.InitializeEmptyObject;
      JSONManagement.GetJSONObject(JsonObject);

      JSONManagement.AddJPropertyToJObject(JsonObject,'PropertyId',IsVendorPropertyIdTxt);
      JSONManagement.AddJPropertyToJObject(JsonObject,'Value',FORMAT(IsVendor,0,2));

      exit(JSONManagement.WriteObjectToString);
    END;

    [External]
    PROCEDURE HasIsBank@22(IsBankString@1000 : Text) : Boolean;
    BEGIN
      exit(HasExtendedProperty(IsBankString,IsBankPropertyIdTxt));
    END;

    [External]
    PROCEDURE GetIsBank@90(IsBankString@1001 : Text) IsBank : Boolean;
    VAR
      JsonObject@1000 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      PropertyId@1003 : Text;
    BEGIN
      JSONManagement.InitializeObject(IsBankString);
      JSONManagement.GetJSONObject(JsonObject);

      if JSONManagement.GetStringPropertyValueFromJObjectByName(JsonObject,'PropertyId',PropertyId) then
        if PropertyId = IsBankPropertyIdTxt then begin
          JSONManagement.GetBoolPropertyValueFromJObjectByName(JsonObject,'Value',IsBank);
          exit(IsBank);
        end;
      exit(false);
    END;

    [TryFunction]
    [External]
    PROCEDURE TryGetIsBankValue@93(IsBankString@1000 : Text;VAR Value@1001 : Text);
    BEGIN
      GetExtendedPropertyBoolValue(IsBankString,IsBankPropertyIdTxt,Value);
    END;

    [External]
    PROCEDURE AddIsBank@84(IsBank@1000 : Boolean) : Text;
    VAR
      JsonObject@1001 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      JSONManagement.InitializeEmptyObject;
      JSONManagement.GetJSONObject(JsonObject);

      JSONManagement.AddJPropertyToJObject(JsonObject,'PropertyId',IsBankPropertyIdTxt);
      JSONManagement.AddJPropertyToJObject(JsonObject,'Value',FORMAT(IsBank,0,2));

      exit(JSONManagement.WriteObjectToString);
    END;

    [External]
    PROCEDURE GetIsNavCreated@101(IsNavCreatedString@1001 : Text) IsNavCreated : Boolean;
    VAR
      JsonObject@1000 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      PropertyId@1003 : Text;
    BEGIN
      JSONManagement.InitializeObject(IsNavCreatedString);
      JSONManagement.GetJSONObject(JsonObject);

      if JSONManagement.GetStringPropertyValueFromJObjectByName(JsonObject,'PropertyId',PropertyId) then
        if PropertyId = IsNavCreatedPropertyIdTxt then begin
          JSONManagement.GetBoolPropertyValueFromJObjectByName(JsonObject,'Value',IsNavCreated);
          exit(IsNavCreated);
        end;
      exit(false);
    END;

    [External]
    PROCEDURE AddIsNavCreated@102(IsNavCreated@1000 : Boolean) : Text;
    VAR
      JsonObject@1001 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      JSONManagement.InitializeEmptyObject;
      JSONManagement.GetJSONObject(JsonObject);

      JSONManagement.AddJPropertyToJObject(JsonObject,'PropertyId',IsNavCreatedPropertyIdTxt);
      JSONManagement.AddJPropertyToJObject(JsonObject,'Value',FORMAT(IsNavCreated,0,2));

      exit(JSONManagement.WriteObjectToString);
    END;

    [External]
    PROCEDURE GetNavIntegrationId@62(NavIntegrationIdString@1001 : Text) NavIntegrationId : GUID;
    VAR
      JsonObject@1000 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      PropertyId@1003 : Text;
    BEGIN
      JSONManagement.InitializeObject(NavIntegrationIdString);
      JSONManagement.GetJSONObject(JsonObject);
      if JSONManagement.GetStringPropertyValueFromJObjectByName(JsonObject,'PropertyId',PropertyId) then
        if PropertyId = NavIntegrationIdTxt then
          JSONManagement.GetGuidPropertyValueFromJObjectByName(JsonObject,'Value',NavIntegrationId);

      exit(NavIntegrationId);
    END;

    [External]
    PROCEDURE AddNavIntegrationId@103(IntegrationId@1000 : GUID) : Text;
    VAR
      JsonObject@1001 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      JSONManagement.InitializeEmptyObject;
      JSONManagement.GetJSONObject(JsonObject);
      JSONManagement.AddJPropertyToJObject(JsonObject,'PropertyId',NavIntegrationIdTxt);
      JSONManagement.AddJPropertyToJObject(JsonObject,'Value',IntegrationId);

      exit(JSONManagement.WriteObjectToString);
    END;

    PROCEDURE HasIsContact@24(IsContactString@1000 : Text) : Boolean;
    BEGIN
      exit(HasExtendedProperty(IsContactString,IsContactPropertyIdTxt));
    END;

    [External]
    PROCEDURE GetIsContact@32(IsContactString@1001 : Text) IsContact : Boolean;
    VAR
      JsonObject@1000 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      PropertyId@1003 : Text;
    BEGIN
      JSONManagement.InitializeObject(IsContactString);
      JSONManagement.GetJSONObject(JsonObject);

      if JSONManagement.GetStringPropertyValueFromJObjectByName(JsonObject,'PropertyId',PropertyId) then
        if PropertyId = IsContactPropertyIdTxt then begin
          JSONManagement.GetBoolPropertyValueFromJObjectByName(JsonObject,'Value',IsContact);
          exit(IsContact);
        end;

      exit(false);
    END;

    [TryFunction]
    [External]
    PROCEDURE TryGetIsContactValue@97(IsContactString@1000 : Text;VAR Value@1001 : Text);
    BEGIN
      GetExtendedPropertyBoolValue(IsContactString,IsContactPropertyIdTxt,Value);
    END;

    [External]
    PROCEDURE AddIsContact@29(IsContact@1000 : Boolean) : Text;
    VAR
      JsonObject@1001 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
    BEGIN
      JSONManagement.InitializeEmptyObject;
      JSONManagement.GetJSONObject(JsonObject);

      JSONManagement.AddJPropertyToJObject(JsonObject,'PropertyId',IsContactPropertyIdTxt);
      JSONManagement.AddJPropertyToJObject(JsonObject,'Value',FORMAT(IsContact,0,2));

      exit(JSONManagement.WriteObjectToString);
    END;

    [External]
    PROCEDURE HasIsLead@25(IsLeadString@1000 : Text) : Boolean;
    BEGIN
      exit(HasExtendedProperty(IsLeadString,IsLeadPropertyIdTxt));
    END;

    [External]
    PROCEDURE GetIsLead@35(IsLeadString@1001 : Text) IsLead : Boolean;
    VAR
      JsonObject@1000 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      PropertyId@1003 : Text;
    BEGIN
      JSONManagement.InitializeObject(IsLeadString);
      JSONManagement.GetJSONObject(JsonObject);

      if JSONManagement.GetStringPropertyValueFromJObjectByName(JsonObject,'PropertyId',PropertyId) then
        if PropertyId = IsLeadPropertyIdTxt then begin
          JSONManagement.GetBoolPropertyValueFromJObjectByName(JsonObject,'Value',IsLead);
          exit(IsLead);
        end;

      exit(false);
    END;

    [TryFunction]
    [External]
    PROCEDURE TryGetIsLeadValue@98(IsLeadString@1000 : Text;VAR Value@1001 : Text);
    BEGIN
      GetExtendedPropertyBoolValue(IsLeadString,IsLeadPropertyIdTxt,Value);
    END;

    [External]
    PROCEDURE HasIsPartner@28(IsPartnerString@1000 : Text) : Boolean;
    BEGIN
      exit(HasExtendedProperty(IsPartnerString,IsPartnerPropertyIdTxt));
    END;

    [External]
    PROCEDURE GetIsPartner@36(IsPartnerString@1001 : Text) IsPartner : Boolean;
    VAR
      JsonObject@1000 : DotNet "'Newtonsoft.Json'.Newtonsoft.Json.Linq.JObject";
      PropertyId@1003 : Text;
    BEGIN
      JSONManagement.InitializeObject(IsPartnerString);
      JSONManagement.GetJSONObject(JsonObject);

      if JSONManagement.GetStringPropertyValueFromJObjectByName(JsonObject,'PropertyId',PropertyId) then
        if PropertyId = IsPartnerPropertyIdTxt then begin
          JSONManagement.GetBoolPropertyValueFromJObjectByName(JsonObject,'Value',IsPartner);
          exit(IsPartner);
        end;

      exit(false);
    END;

    [TryFunction]
    [External]
    PROCEDURE TryGetIsPartnerValue@99(IsPartnerString@1000 : Text;VAR Value@1001 : Text);
    BEGIN
      GetExtendedPropertyBoolValue(IsPartnerString,IsPartnerPropertyIdTxt,Value);
    END;

    PROCEDURE ConcatenateStreet@86(Address@1000 : Text;Address2@1001 : Text) : Text;
    VAR
      CrLf@1002 : Text[2];
    BEGIN
      if Address2 = '' then
        exit(Address);

      CrLf[1] := 13;
      CrLf[2] := 10;
      exit(Address + CrLf + Address2);
    END;

    PROCEDURE SplitStreet@87(Street@1001 : Text;VAR Address@1002 : Text[50];VAR Address2@1003 : Text[50]);
    VAR
      CrLf@1000 : Text[2];
      NewLinePos@1004 : Integer;
    BEGIN
      CrLf[1] := 13;
      CrLf[2] := 10;
      NewLinePos := STRPOS(Street,CrLf);
      if NewLinePos = 0 then begin
        Address := COPYSTR(Street,1,MAXSTRLEN(Address));
        exit;
      end;

      if NewLinePos > MAXSTRLEN(Address) then
        Address := COPYSTR(Street,1,MAXSTRLEN(Address))
      else
        Address := COPYSTR(Street,1,NewLinePos - 1);
      Address2 := COPYSTR(Street,NewLinePos + 2);
    END;

    PROCEDURE FindCountryRegionCode@88(CountryOrRegion@1001 : Text) : Code[10];
    VAR
      CountryRegion@1000 : Record "Country/Region";
      Regex@1002 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Text.RegularExpressions.Regex";
      Match@1005 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Text.RegularExpressions.Match";
      Matches@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Text.RegularExpressions.MatchCollection";
      Abbreviation@1004 : Text;
    BEGIN
      if CountryOrRegion = '' then
        exit('');

      if STRLEN(CountryOrRegion) <= MAXSTRLEN(CountryRegion.Code) then
        if CountryRegion.GET(CountryOrRegion) then
          exit(CountryRegion.Code);

      CountryRegion.SETRANGE(Name,CountryOrRegion);
      if CountryRegion.COUNT = 1 then begin
        CountryRegion.FINDFIRST;
        exit(CountryRegion.Code);
      end;

      if STRPOS(CountryOrRegion,' ') > 0 then begin
        Matches := Regex.Matches(CountryOrRegion,'\b([A-Z])');
        if Matches.Count > 0 then begin
          foreach Match in Matches do
            Abbreviation += Match.Value;
          if CountryRegion.GET(Abbreviation) then
            exit(CountryRegion.Code);
        end;
      end;

      CountryRegion.INIT;
      CountryRegion.Code := COPYSTR(CountryOrRegion,1,MAXSTRLEN(CountryRegion.Code));
      CountryRegion.Name := COPYSTR(CountryOrRegion,1,MAXSTRLEN(CountryRegion.Name));
      CountryRegion.INSERT(true);
      exit(CountryRegion.Code);
    END;

    [External]
    PROCEDURE GetContactComments@96(Contact@1000 : Record Contact) : Text;
    VAR
      RlshpMgtCommentLine@1001 : Record "Rlshp. Mgt. Comment Line";
      CommentString@1002 : Text;
      CrLf@1003 : Text[2];
    BEGIN
      CrLf[1] := 13;
      CrLf[2] := 10;
      RlshpMgtCommentLine.SETRANGE("Table Name",RlshpMgtCommentLine."Table Name"::Contact);
      RlshpMgtCommentLine.SETRANGE("No.",Contact."No.");
      if RlshpMgtCommentLine.FINDSET then
        repeat
          if (CommentString <> '') or (RlshpMgtCommentLine.Comment = '') then
            CommentString += CrLf;
          CommentString += RlshpMgtCommentLine.Comment;
        until RlshpMgtCommentLine.NEXT = 0;
      exit(CommentString);
    END;

    [External]
    PROCEDURE SetContactComments@95(Contact@1000 : Record Contact;PersonalNotes@1001 : Text);
    VAR
      RlshpMgtCommentLine@1002 : Record "Rlshp. Mgt. Comment Line";
    BEGIN
      RlshpMgtCommentLine.SETRANGE("Table Name",RlshpMgtCommentLine."Table Name"::Contact);
      RlshpMgtCommentLine.SETRANGE("No.",Contact."No.");
      RlshpMgtCommentLine.DELETEALL;
      if PersonalNotes <> '' then begin
        RlshpMgtCommentLine."Table Name" := RlshpMgtCommentLine."Table Name"::Contact;
        RlshpMgtCommentLine."No." := Contact."No.";
        RlshpMgtCommentLine.Date := TODAY;
        InsertNextContactCommentLine(RlshpMgtCommentLine,PersonalNotes);
      end;
    END;

    LOCAL PROCEDURE InsertNextContactCommentLine@94(VAR RlshpMgtCommentLine@1000 : Record "Rlshp. Mgt. Comment Line";RemainingPersonalNotes@1001 : Text);
    VAR
      CrLf@1002 : Text[2];
      CrLfPos@1003 : Integer;
    BEGIN
      CrLf[1] := 13;
      CrLf[2] := 10;
      CrLfPos := STRPOS(RemainingPersonalNotes,CrLf);

      if (CrLfPos <> 0) and (CrLfPos <= MAXSTRLEN(RlshpMgtCommentLine.Comment) + 1) then begin
        RlshpMgtCommentLine.Comment := COPYSTR(RemainingPersonalNotes,1,CrLfPos - 1);
        RemainingPersonalNotes := COPYSTR(RemainingPersonalNotes,CrLfPos + 2);
      end else begin
        RlshpMgtCommentLine.Comment := COPYSTR(RemainingPersonalNotes,1,MAXSTRLEN(RlshpMgtCommentLine.Comment));
        RemainingPersonalNotes := COPYSTR(RemainingPersonalNotes,MAXSTRLEN(RlshpMgtCommentLine.Comment) + 1);
      end;

      RlshpMgtCommentLine."Line No." += 10000;
      RlshpMgtCommentLine.INSERT;
      RlshpMgtCommentLine.Date := 0D;
      if RemainingPersonalNotes <> '' then
        InsertNextContactCommentLine(RlshpMgtCommentLine,RemainingPersonalNotes);
    END;

    [External]
    PROCEDURE InitializeCollection@4(JSONString@1000 : Text);
    BEGIN
      JSONManagement.InitializeCollection(JSONString);
    END;

    [External]
    PROCEDURE InitializeObject@2(JSONString@1000 : Text);
    BEGIN
      JSONManagement.InitializeObject(JSONString);
    END;

    [External]
    PROCEDURE IsBlankOrEmptyJsonObject@37(JSONString@1000 : Text) : Boolean;
    VAR
      JSONManagement2@1002 : Codeunit "JSON Management";
      EmptyJsonObjectString@1001 : Text;
    BEGIN
      JSONManagement2.InitializeEmptyObject;
      EmptyJsonObjectString := JSONManagement2.WriteObjectToString;
      exit((JSONString = '') or (JSONString = EmptyJsonObjectString));
    END;

    [External]
    PROCEDURE WriteCollectionToString@44() : Text;
    BEGIN
      exit(JSONManagement.WriteCollectionToString);
    END;

    [External]
    PROCEDURE WriteObjectToString@51() : Text;
    BEGIN
      exit(JSONManagement.WriteObjectToString);
    END;

    BEGIN
    END.
  }
}

