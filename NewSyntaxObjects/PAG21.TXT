OBJECT Page 21 Customer Card
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Customer Card;
    SourceTable=Customer;
    PageType=Card;
    RefreshOnActivate=true;
    PromotedActionCategoriesML=ENU=New,Process,Report,New Document,Approve,Request Approval,Prices and Discounts,Navigate,Customer;
    OnInit=VAR
             ApplicationAreaSetup@1000 : Record "Application Area Setup";
           BEGIN
             FoundationOnly := ApplicationAreaSetup.IsFoundationEnabled;

             SetCustomerNoVisibilityOnFactBoxes;

             ContactEditable := true;

             OpenApprovalEntriesExistCurrUser := true;

             CaptionTxt := CurrPage.CAPTION;
             SetCaption(CaptionTxt);
             CurrPage.CAPTION(CaptionTxt);
           END;

    OnOpenPage=VAR
                 OfficeManagement@1002 : Codeunit "Office Management";
               BEGIN
                 ActivateFields;

                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;

                 SetNoFieldVisible;
                 IsOfficeAddin := OfficeManagement.IsAvailable;

                 if FoundationOnly then
                   CurrPage.PriceAndLineDisc.PAGE.InitPage(false);

                 ShowCharts := "No." <> '';
                 if ShowCharts then begin
                   CurrPage.AgedAccReceivableChart.PAGE.SetPerCustomer;
                   CurrPage.AgedAccReceivableChart2.PAGE.SetPerCustomer;
                 end;
                 SETFILTER("Date Filter",CustomerMgt.GetCurrentYearFilter);
               END;

    OnAfterGetRecord=VAR
                       AgedAccReceivable@1000 : Codeunit "Aged Acc. Receivable";
                     BEGIN
                       ActivateFields;
                       StyleTxt := SetStyle;
                       BlockedCustomer := (Blocked = Blocked::All);
                       BalanceExhausted := 10000 <= CalcCreditLimitLCYExpendedPct;
                       DaysPastDueDate := AgedAccReceivable.InvoicePaymentDaysAverage("No.");
                       AttentionToPaidDay := DaysPastDueDate > 0;
                     END;

    OnNewRecord=VAR
                  DocumentNoVisibility@1004 : Codeunit DocumentNoVisibility;
                BEGIN
                  if GUIALLOWED then
                    if "No." = '' then
                      if DocumentNoVisibility.CustomerNoSeriesIsDefault then
                        NewMode := true;
                END;

    OnAfterGetCurrRecord=VAR
                           CRMCouplingManagement@1001 : Codeunit "CRM Coupling Management";
                           WorkflowManagement@1000 : Codeunit "Workflow Management";
                           WorkflowEventHandling@1003 : Codeunit "Workflow Event Handling";
                           WorkflowWebhookManagement@1002 : Codeunit "Workflow Webhook Management";
                         BEGIN
                           CreateCustomerFromTemplate;
                           ActivateFields;
                           StyleTxt := SetStyle;
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);
                           if CRMIntegrationEnabled then begin
                             CRMIsCoupledToRecord := CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID);
                             if "No." <> xRec."No." then
                               CRMIntegrationManagement.SendResultNotification(Rec);
                           end;
                           OpenApprovalEntriesExistCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
                           OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);

                           if FoundationOnly then
                             GetSalesPricesAndSalesLineDisc;

                           DynamicEditable := CurrPage.EDITABLE;

                           CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);

                           EventFilter := WorkflowEventHandling.RunWorkflowOnSendCustomerForApprovalCode + '|' +
                             WorkflowEventHandling.RunWorkflowOnCustomerChangedCode;

                           EnabledApprovalWorkflowsExist := WorkflowManagement.EnabledWorkflowExist(DATABASE::Customer,EventFilter);

                           WorkflowWebhookManagement.GetCanRequestAndCanCancel(RECORDID,CanRequestApprovalForFlow,CanCancelApprovalForFlow);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      Name=ActionContainer1900000003;
                      ActionContainerType=RelatedInformation }
      { 74      ;1   ;ActionGroup;
                      Name=&Customer;
                      CaptionML=ENU=&Customer;
                      Image=Customer }
      { 84      ;2   ;Action    ;
                      Name=Dimensions;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=ENU=Dimensions;
                      ToolTipML=ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                      ApplicationArea=#Suite;
                      RunObject=Page "Default Dimensions";
                      RunPageLink="Table ID"=CONST(18),
                                  "No."=FIELD("No.");
                      Image=Dimensions }
      { 99      ;2   ;Action    ;
                      Name=Bank Accounts;
                      CaptionML=ENU=Bank Accounts;
                      ToolTipML=ENU=View or set up the customer's bank accounts. You can set up any number of bank accounts for each customer.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Customer Bank Account List";
                      RunPageLink="Customer No."=FIELD("No.");
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=BankAccount;
                      PromotedCategory=Category9;
                      PromotedOnly=true }
      { 19      ;2   ;Action    ;
                      Name=Direct Debit Mandates;
                      CaptionML=ENU=Direct Debit Mandates;
                      ToolTipML=ENU=View the direct-debit mandates that reflect agreements with customers to collect invoice payments from their bank account.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "SEPA Direct Debit Mandates";
                      RunPageLink="Customer No."=FIELD("No.");
                      Promoted=true;
                      Image=MakeAgreement;
                      PromotedCategory=Category9;
                      PromotedOnly=true }
      { 81      ;2   ;Action    ;
                      Name=ShipToAddresses;
                      CaptionML=ENU=Ship-&to Addresses;
                      ToolTipML=ENU=View or edit alternate shipping addresses where the customer wants items delivered if different from the regular address.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Ship-to Address List";
                      RunPageLink="Customer No."=FIELD("No.");
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=ShipAddress;
                      PromotedCategory=Category9;
                      PromotedOnly=true }
      { 14      ;2   ;Action    ;
                      Name=Contact;
                      AccessByPermission=TableData Contact=R;
                      CaptionML=ENU=C&ontact;
                      ToolTipML=ENU=View or edit detailed information about the contact person at the customer.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=ContactPerson;
                      PromotedCategory=Category9;
                      PromotedOnly=true;
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 94      ;2   ;Action    ;
                      Name=Cross Re&ferences;
                      CaptionML=ENU=Cross Re&ferences;
                      ToolTipML=ENU=Set up the customer's own identification of items that you sell to the customer. Cross-references to the customer's item number means that the item number is automatically shown on sales documents instead of the number that you use.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Cross References";
                      RunPageView=SORTING("Cross-Reference Type","Cross-Reference Type No.");
                      RunPageLink="Cross-Reference Type"=CONST(Customer),
                                  "Cross-Reference Type No."=FIELD("No.");
                      Image=Change }
      { 78      ;2   ;Action    ;
                      Name=Co&mments;
                      CaptionML=ENU=Co&mments;
                      ToolTipML=ENU=View or add comments for the record.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Comment Sheet";
                      RunPageLink="Table Name"=CONST(Customer),
                                  "No."=FIELD("No.");
                      Image=ViewComments }
      { 59      ;2   ;Action    ;
                      Name=ApprovalEntries;
                      AccessByPermission=TableData "Approval Entry"=R;
                      CaptionML=ENU=Approvals;
                      ToolTipML=ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                      ApplicationArea=#Suite;
                      Promoted=true;
                      Image=Approvals;
                      PromotedCategory=Category6;
                      PromotedOnly=true;
                      OnAction=BEGIN
                                 ApprovalsMgmt.OpenApprovalEntriesPage(RECORDID);
                               END;
                                }
      { 243     ;2   ;Action    ;
                      Name=CustomerReportSelections;
                      CaptionML=ENU=Document Layouts;
                      ToolTipML=ENU=Set up a layout for different types of documents such as invoices, quotes, and credit memos.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Quote;
                      OnAction=VAR
                                 CustomReportSelection@1000 : Record "Custom Report Selection";
                               BEGIN
                                 CustomReportSelection.SETRANGE("Source Type",DATABASE::Customer);
                                 CustomReportSelection.SETRANGE("Source No.","No.");
                                 PAGE.RUNMODAL(PAGE::"Customer Report Selections",CustomReportSelection);
                               END;
                                }
      { 31      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=ENU=Dynamics 365 for Sales;
                      Visible=CRMIntegrationEnabled }
      { 33      ;2   ;Action    ;
                      Name=CRMGotoAccount;
                      CaptionML=ENU=Account;
                      ToolTipML=ENU=Open the coupled Dynamics 365 for Sales account.;
                      ApplicationArea=#Suite;
                      Visible=CRMIntegrationEnabled;
                      Image=CoupledCustomer;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit "CRM Integration Management";
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 53      ;2   ;Action    ;
                      Name=CRMSynchronizeNow;
                      AccessByPermission=TableData "CRM Integration Record"=IM;
                      CaptionML=ENU=Synchronize;
                      ToolTipML=ENU=Send or get updated data to or from Dynamics 365 for Sales.;
                      ApplicationArea=#Suite;
                      Promoted=true;
                      Visible=CRMIntegrationEnabled;
                      Image=Refresh;
                      PromotedCategory=Category9;
                      OnAction=VAR
                                 CRMIntegrationManagement@1001 : Codeunit "CRM Integration Management";
                               BEGIN
                                 CRMIntegrationManagement.UpdateOneNow(RECORDID);
                               END;
                                }
      { 43      ;2   ;Action    ;
                      Name=UpdateStatisticsInCRM;
                      CaptionML=ENU=Update Account Statistics;
                      ToolTipML=ENU=Send customer statistics data to Dynamics 365 for Sales to update the Account Statistics FactBox.;
                      ApplicationArea=#Suite;
                      Visible=CRMIntegrationEnabled;
                      Enabled=CRMIsCoupledToRecord;
                      Image=UpdateXML;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit "CRM Integration Management";
                               BEGIN
                                 CRMIntegrationManagement.CreateOrUpdateCRMAccountStatistics(Rec);
                               END;
                                }
      { 51      ;2   ;ActionGroup;
                      Name=Coupling;
                      CaptionML=[@@@=Coupling is a noun;
                                 ENU=Coupling];
                      ToolTipML=ENU=Create, change, or delete a coupling between the Microsoft Dynamics NAV record and a Dynamics 365 for Sales record.;
                      Image=LinkAccount }
      { 47      ;3   ;Action    ;
                      Name=ManageCRMCoupling;
                      AccessByPermission=TableData "CRM Integration Record"=IM;
                      CaptionML=ENU=Set Up Coupling;
                      ToolTipML=ENU=Create or modify the coupling to a Dynamics 365 for Sales account.;
                      ApplicationArea=#Suite;
                      Promoted=true;
                      Visible=CRMIntegrationEnabled;
                      Image=LinkAccount;
                      PromotedCategory=Category9;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit "CRM Integration Management";
                               BEGIN
                                 CRMIntegrationManagement.DefineCoupling(RECORDID);
                               END;
                                }
      { 49      ;3   ;Action    ;
                      Name=DeleteCRMCoupling;
                      AccessByPermission=TableData "CRM Integration Record"=IM;
                      CaptionML=ENU=Delete Coupling;
                      ToolTipML=ENU=Delete the coupling to a Dynamics 365 for Sales account.;
                      ApplicationArea=#Suite;
                      Visible=CRMIntegrationEnabled;
                      Enabled=CRMIsCoupledToRecord;
                      Image=UnLinkAccount;
                      OnAction=VAR
                                 CRMCouplingManagement@1000 : Codeunit "CRM Coupling Management";
                               BEGIN
                                 CRMCouplingManagement.RemoveCoupling(RECORDID);
                               END;
                                }
      { 150     ;2   ;Action    ;
                      Name=ShowLog;
                      CaptionML=ENU=Synchronization Log;
                      ToolTipML=ENU=View integration synchronization jobs for the customer table.;
                      ApplicationArea=#Suite;
                      Visible=CRMIntegrationEnabled;
                      Image=Log;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit "CRM Integration Management";
                               BEGIN
                                 CRMIntegrationManagement.ShowLog(RECORDID);
                               END;
                                }
      { 5       ;1   ;ActionGroup;
                      Name=History;
                      CaptionML=ENU=History;
                      Image=History }
      { 80      ;2   ;Action    ;
                      Name=Ledger E&ntries;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=Ledger E&ntries;
                      ToolTipML=ENU=View the history of transactions that have been posted for the selected record.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Customer Ledger Entries";
                      RunPageView=SORTING("Customer No.")
                                  ORDER(Descending);
                      RunPageLink="Customer No."=FIELD("No.");
                      Promoted=false;
                      Image=CustomerLedger;
                      PromotedCategory=Process }
      { 76      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=ENU=Statistics;
                      ToolTipML=ENU=View statistical information, such as the value of posted entries, for the record.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Customer Statistics";
                      RunPageLink="No."=FIELD("No."),
                                  "Date Filter"=FIELD("Date Filter"),
                                  "Global Dimension 1 Filter"=FIELD("Global Dimension 1 Filter"),
                                  "Global Dimension 2 Filter"=FIELD("Global Dimension 2 Filter");
                      Image=Statistics;
                      PromotedCategory=Process }
      { 79      ;2   ;Action    ;
                      Name=S&ales;
                      CaptionML=ENU=S&ales;
                      ToolTipML=ENU=View a summary of customer ledger entries. You select the time interval in the View by field. The Period column on the left contains a series of dates that are determined by the time interval you have selected.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Customer Sales";
                      RunPageLink="No."=FIELD("No."),
                                  "Global Dimension 1 Filter"=FIELD("Global Dimension 1 Filter"),
                                  "Global Dimension 2 Filter"=FIELD("Global Dimension 2 Filter");
                      Image=Sales }
      { 77      ;2   ;Action    ;
                      Name=Entry Statistics;
                      CaptionML=ENU=Entry Statistics;
                      ToolTipML=ENU=View entry statistics for the record.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Customer Entry Statistics";
                      RunPageLink="No."=FIELD("No."),
                                  "Date Filter"=FIELD("Date Filter"),
                                  "Global Dimension 1 Filter"=FIELD("Global Dimension 1 Filter"),
                                  "Global Dimension 2 Filter"=FIELD("Global Dimension 2 Filter");
                      Image=EntryStatistics }
      { 112     ;2   ;Action    ;
                      Name=Statistics by C&urrencies;
                      CaptionML=ENU=Statistics by C&urrencies;
                      ToolTipML=ENU=View statistics for customers that use multiple currencies.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Cust. Stats. by Curr. Lines";
                      RunPageLink="Customer Filter"=FIELD("No."),
                                  "Global Dimension 1 Filter"=FIELD("Global Dimension 1 Filter"),
                                  "Global Dimension 2 Filter"=FIELD("Global Dimension 2 Filter"),
                                  "Date Filter"=FIELD("Date Filter");
                      Image=Currencies }
      { 6500    ;2   ;Action    ;
                      Name=Item &Tracking Entries;
                      CaptionML=ENU=Item &Tracking Entries;
                      ToolTipML=ENU=View serial or lot numbers that are assigned to items.;
                      ApplicationArea=#ItemTracking;
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingDocMgt@1000 : Codeunit "Item Tracking Doc. Management";
                               BEGIN
                                 ItemTrackingDocMgt.ShowItemTrackingForMasterData(1,"No.",'','','','','');
                               END;
                                }
      { 140     ;2   ;Separator ;
                      Name=Separator140 }
      { 130     ;1   ;ActionGroup;
                      Name=Prices and Discounts;
                      CaptionML=ENU=Prices and Discounts }
      { 83      ;2   ;Action    ;
                      Name=Invoice &Discounts;
                      CaptionML=ENU=Invoice &Discounts;
                      ToolTipML=ENU=Set up different discounts that are applied to invoices for the customer. An invoice discount is automatically granted to the customer when the total on a sales invoice exceeds a certain amount.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Cust. Invoice Discounts";
                      RunPageLink=Code=FIELD("Invoice Disc. Code");
                      Image=CalculateInvoiceDiscount;
                      PromotedCategory=Category7 }
      { 113     ;2   ;Action    ;
                      Name=Prices;
                      CaptionML=ENU=Prices;
                      ToolTipML=ENU=View or set up different prices for items that you sell to the customer. An item price is automatically granted on invoice lines when the specified criteria are met, such as customer, quantity, or ending date.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Sales Prices";
                      RunPageView=SORTING("Sales Type","Sales Code");
                      RunPageLink="Sales Type"=CONST(Customer),
                                  "Sales Code"=FIELD("No.");
                      Image=Price }
      { 136     ;2   ;Action    ;
                      Name=Line Discounts;
                      CaptionML=ENU=Line Discounts;
                      ToolTipML=ENU=View or set up different discounts for items that you sell to the customer. An item discount is automatically granted on invoice lines when the specified criteria are met, such as customer, quantity, or ending date.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Sales Line Discounts";
                      RunPageView=SORTING("Sales Type","Sales Code");
                      RunPageLink="Sales Type"=CONST(Customer),
                                  "Sales Code"=FIELD("No.");
                      Image=LineDiscount }
      { 82      ;1   ;ActionGroup;
                      Name=ActionGroup82;
                      CaptionML=ENU=S&ales;
                      Image=Sales }
      { 162     ;2   ;Action    ;
                      Name=Prepa&yment Percentages;
                      CaptionML=ENU=Prepa&yment Percentages;
                      ToolTipML=ENU="View or edit the percentages of the price that can be paid as a prepayment. ";
                      ApplicationArea=#Prepayments;
                      RunObject=Page "Sales Prepayment Percentages";
                      RunPageView=SORTING("Sales Type","Sales Code");
                      RunPageLink="Sales Type"=CONST(Customer),
                                  "Sales Code"=FIELD("No.");
                      Image=PrepaymentPercentages }
      { 118     ;2   ;Action    ;
                      Name=Recurring Sales Lines;
                      Ellipsis=true;
                      CaptionML=ENU=Recurring Sales Lines;
                      ToolTipML=ENU=Set up recurring sales lines for the customer, such as a monthly replenishment order, that can quickly be inserted on a sales document for the customer.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Standard Customer Sales Codes";
                      RunPageLink="Customer No."=FIELD("No.");
                      PromotedIsBig=true;
                      Image=CustomerCode;
                      PromotedCategory=Category5 }
      { 7       ;1   ;ActionGroup;
                      Name=Documents;
                      CaptionML=ENU=Documents;
                      Image=Documents }
      { 85      ;2   ;Action    ;
                      Name=Quotes;
                      CaptionML=ENU=Quotes;
                      ToolTipML=ENU=View a list of ongoing sales quotes for the customer.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Sales Quotes";
                      RunPageView=SORTING("Document Type","Sell-to Customer No.");
                      RunPageLink="Sell-to Customer No."=FIELD("No.");
                      Image=Quote }
      { 157     ;2   ;Action    ;
                      Name=Invoices;
                      CaptionML=ENU=Invoices;
                      ToolTipML=ENU=View a list of ongoing sales invoices for the customer.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Sales Invoice List";
                      RunPageView=SORTING("Document Type","Sell-to Customer No.");
                      RunPageLink="Sell-to Customer No."=FIELD("No.");
                      Image=Invoice }
      { 86      ;2   ;Action    ;
                      Name=Orders;
                      CaptionML=ENU=Orders;
                      ToolTipML=ENU=View a list of ongoing sales orders for the customer.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Sales Order List";
                      RunPageView=SORTING("Document Type","Sell-to Customer No.");
                      RunPageLink="Sell-to Customer No."=FIELD("No.");
                      Image=Document }
      { 121     ;2   ;Action    ;
                      Name=Return Orders;
                      CaptionML=ENU=Return Orders;
                      ToolTipML=ENU=Open the list of ongoing return orders.;
                      ApplicationArea=#SalesReturnOrder;
                      RunObject=Page "Sales Return Order List";
                      RunPageView=SORTING("Document Type","Sell-to Customer No.");
                      RunPageLink="Sell-to Customer No."=FIELD("No.");
                      Image=ReturnOrder }
      { 151     ;2   ;ActionGroup;
                      Name=Issued Documents;
                      CaptionML=ENU=Issued Documents;
                      Image=Documents }
      { 152     ;3   ;Action    ;
                      Name=Issued &Reminders;
                      CaptionML=ENU=Issued &Reminders;
                      ToolTipML=ENU=View the reminders that you have sent to the customer.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Issued Reminder List";
                      RunPageView=SORTING("Customer No.","Posting Date");
                      RunPageLink="Customer No."=FIELD("No.");
                      Image=OrderReminder }
      { 153     ;3   ;Action    ;
                      Name=Issued &Finance Charge Memos;
                      CaptionML=ENU=Issued &Finance Charge Memos;
                      ToolTipML=ENU=View the finance charge memos that you have sent to the customer.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Issued Fin. Charge Memo List";
                      RunPageView=SORTING("Customer No.","Posting Date");
                      RunPageLink="Customer No."=FIELD("No.");
                      Image=FinChargeMemo }
      { 114     ;2   ;Action    ;
                      Name=Blanket Orders;
                      CaptionML=ENU=Blanket Orders;
                      ToolTipML=ENU=Open the list of ongoing blanket orders.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Blanket Sales Orders";
                      RunPageView=SORTING("Document Type","Sell-to Customer No.");
                      RunPageLink="Sell-to Customer No."=FIELD("No.");
                      Image=BlanketOrder }
      { 147     ;2   ;Action    ;
                      Name=&Jobs;
                      CaptionML=ENU=&Jobs;
                      ToolTipML=ENU=Open the list of ongoing jobs.;
                      ApplicationArea=#Jobs;
                      RunObject=Page "Job List";
                      RunPageView=SORTING("Bill-to Customer No.");
                      RunPageLink="Bill-to Customer No."=FIELD("No.");
                      Image=Job }
      { 13      ;1   ;ActionGroup;
                      Name=Service;
                      CaptionML=ENU=Service;
                      Image=ServiceItem }
      { 128     ;2   ;Action    ;
                      Name=Service Orders;
                      CaptionML=ENU=Service Orders;
                      ToolTipML=ENU=Open the list of ongoing service orders.;
                      ApplicationArea=#Service;
                      RunObject=Page "Service Orders";
                      RunPageView=SORTING("Document Type","Customer No.");
                      RunPageLink="Customer No."=FIELD("No.");
                      Image=Document }
      { 126     ;2   ;Action    ;
                      Name=Ser&vice Contracts;
                      CaptionML=ENU=Ser&vice Contracts;
                      ToolTipML=ENU=Open the list of ongoing service contracts.;
                      ApplicationArea=#Service;
                      RunObject=Page "Customer Service Contracts";
                      RunPageView=SORTING("Customer No.","Ship-to Code");
                      RunPageLink="Customer No."=FIELD("No.");
                      Image=ServiceAgreement }
      { 127     ;2   ;Action    ;
                      Name=Service &Items;
                      CaptionML=ENU=Service &Items;
                      ToolTipML=ENU=View or edit the service items that are registered for the customer.;
                      ApplicationArea=#Service;
                      RunObject=Page "Service Items";
                      RunPageView=SORTING("Customer No.","Ship-to Code","Item No.","Serial No.");
                      RunPageLink="Customer No."=FIELD("No.");
                      Image=ServiceItem }
      { 9       ;    ;ActionContainer;
                      Name=ActionContainer9;
                      ActionContainerType=NewDocumentItems }
      { 1902575205;1 ;Action    ;
                      Name=NewBlanketSalesOrder;
                      AccessByPermission=TableData "Sales Header"=RIM;
                      CaptionML=ENU=Blanket Sales Order;
                      ToolTipML=ENU=Create a blanket sales order for the customer.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Blanket Sales Order";
                      RunPageLink="Sell-to Customer No."=FIELD("No.");
                      Promoted=false;
                      Image=BlanketOrder;
                      PromotedCategory=Category4;
                      RunPageMode=Create }
      { 1900246505;1 ;Action    ;
                      Name=NewSalesQuote;
                      AccessByPermission=TableData "Sales Header"=RIM;
                      CaptionML=ENU=Sales Quote;
                      ToolTipML=ENU=Offer items or services to a customer.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Sales Quote";
                      RunPageLink="Sell-to Customer No."=FIELD("No.");
                      Promoted=true;
                      Image=NewSalesQuote;
                      PromotedCategory=Category4;
                      PromotedOnly=true;
                      RunPageMode=Create }
      { 1906384905;1 ;Action    ;
                      Name=NewSalesInvoice;
                      AccessByPermission=TableData "Sales Header"=RIM;
                      CaptionML=ENU=Sales Invoice;
                      ToolTipML=ENU=Create a sales invoice for the customer.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Sales Invoice";
                      RunPageLink="Sell-to Customer No."=FIELD("No.");
                      Promoted=true;
                      Image=NewSalesInvoice;
                      PromotedCategory=Category4;
                      PromotedOnly=true;
                      RunPageMode=Create }
      { 1904747105;1 ;Action    ;
                      Name=NewSalesOrder;
                      AccessByPermission=TableData "Sales Header"=RIM;
                      CaptionML=ENU=Sales Order;
                      ToolTipML=ENU=Create a sales order for the customer.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Sales Order";
                      RunPageLink="Sell-to Customer No."=FIELD("No.");
                      Promoted=true;
                      Image=Document;
                      PromotedCategory=Category4;
                      PromotedOnly=true;
                      RunPageMode=Create }
      { 1902583505;1 ;Action    ;
                      Name=NewSalesCreditMemo;
                      AccessByPermission=TableData "Sales Header"=RIM;
                      CaptionML=ENU=Sales Credit Memo;
                      ToolTipML=ENU=Create a new sales credit memo to revert a posted sales invoice.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Sales Credit Memo";
                      RunPageLink="Sell-to Customer No."=FIELD("No.");
                      Promoted=true;
                      Image=CreditMemo;
                      PromotedCategory=Category4;
                      PromotedOnly=true;
                      RunPageMode=Create }
      { 1905163705;1 ;Action    ;
                      Name=NewSalesReturnOrder;
                      AccessByPermission=TableData "Sales Header"=RIM;
                      CaptionML=ENU=Sales Return Order;
                      ToolTipML=ENU=Create a new sales return order for items or services.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Sales Return Order";
                      RunPageLink="Sell-to Customer No."=FIELD("No.");
                      Promoted=false;
                      Image=ReturnOrder;
                      PromotedCategory=Category4;
                      RunPageMode=Create }
      { 1905185205;1 ;Action    ;
                      Name=NewServiceQuote;
                      AccessByPermission=TableData "Service Header"=RIM;
                      CaptionML=ENU=Service Quote;
                      ToolTipML=ENU=Create a new service quote for the customer.;
                      ApplicationArea=#Service;
                      RunObject=Page "Service Quote";
                      RunPageLink="Customer No."=FIELD("No.");
                      Promoted=false;
                      Image=Quote;
                      PromotedCategory=Category4;
                      RunPageMode=Create }
      { 1902079405;1 ;Action    ;
                      Name=NewServiceInvoice;
                      AccessByPermission=TableData "Service Header"=RIM;
                      CaptionML=ENU=Service Invoice;
                      ToolTipML=ENU=Create a new service invoice for the customer.;
                      ApplicationArea=#Service;
                      RunObject=Page "Service Invoice";
                      RunPageLink="Customer No."=FIELD("No.");
                      Promoted=false;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      RunPageMode=Create }
      { 1907102005;1 ;Action    ;
                      Name=NewServiceOrder;
                      AccessByPermission=TableData "Service Header"=RIM;
                      CaptionML=ENU=Service Order;
                      ToolTipML=ENU=Create a new service order for the customer.;
                      ApplicationArea=#Service;
                      RunObject=Page "Service Order";
                      RunPageLink="Customer No."=FIELD("No.");
                      Promoted=false;
                      Image=Document;
                      PromotedCategory=Category4;
                      RunPageMode=Create }
      { 1901662105;1 ;Action    ;
                      Name=NewServiceCreditMemo;
                      AccessByPermission=TableData "Service Header"=RIM;
                      CaptionML=ENU=Service Credit Memo;
                      ToolTipML=ENU=Create a new service credit memo for the customer.;
                      ApplicationArea=#Service;
                      RunObject=Page "Service Credit Memo";
                      RunPageLink="Customer No."=FIELD("No.");
                      Promoted=false;
                      Image=CreditMemo;
                      PromotedCategory=Category4;
                      RunPageMode=Create }
      { 1903839805;1 ;Action    ;
                      Name=NewReminder;
                      AccessByPermission=TableData "Reminder Header"=RIM;
                      CaptionML=ENU=Reminder;
                      ToolTipML=ENU=Create a new reminder for the customer.;
                      ApplicationArea=#Advanced;
                      RunObject=Page Reminder;
                      RunPageLink="Customer No."=FIELD("No.");
                      Promoted=true;
                      Image=Reminder;
                      PromotedCategory=Category4;
                      RunPageMode=Create }
      { 1901102005;1 ;Action    ;
                      Name=NewFinanceChargeMemo;
                      AccessByPermission=TableData "Finance Charge Memo Header"=RIM;
                      CaptionML=ENU=Finance Charge Memo;
                      ToolTipML=ENU=Create a new finance charge memo.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Finance Charge Memo";
                      RunPageLink="Customer No."=FIELD("No.");
                      Promoted=false;
                      Image=FinChargeMemo;
                      PromotedCategory=Category4;
                      RunPageMode=Create }
      { 1900000004;0 ;ActionContainer;
                      Name=ActionContainer1900000004;
                      ActionContainerType=ActionItems }
      { 57      ;1   ;ActionGroup;
                      Name=Approval;
                      CaptionML=ENU=Approval;
                      Visible=OpenApprovalEntriesExistCurrUser }
      { 56      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=ENU=Approve;
                      ToolTipML=ENU=Approve the requested changes.;
                      ApplicationArea=#All;
                      Promoted=true;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      PromotedIsBig=true;
                      Image=Approve;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit "Approvals Mgmt.";
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 390     ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=ENU=Reject;
                      ToolTipML=ENU=Reject the approval request.;
                      ApplicationArea=#All;
                      Promoted=true;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      PromotedIsBig=true;
                      Image=Reject;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit "Approvals Mgmt.";
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 41      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=ENU=Delegate;
                      ToolTipML=ENU=Delegate the approval to a substitute approver.;
                      ApplicationArea=#All;
                      Promoted=true;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit "Approvals Mgmt.";
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 148     ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=ENU=Comments;
                      ToolTipML=ENU=View or add comments for the record.;
                      ApplicationArea=#All;
                      Promoted=true;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit "Approvals Mgmt.";
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 45      ;1   ;ActionGroup;
                      Name=Request Approval;
                      CaptionML=ENU=Request Approval;
                      Image=SendApprovalRequest }
      { 55      ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=ENU=Send A&pproval Request;
                      ToolTipML=ENU=Request approval to change the record.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Enabled=(NOT OpenApprovalEntriesExist) AND EnabledApprovalWorkflowsExist AND CanRequestApprovalForFlow;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category6;
                      PromotedOnly=true;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit "Approvals Mgmt.";
                               BEGIN
                                 if ApprovalsMgmt.CheckCustomerApprovalsWorkflowEnabled(Rec) then
                                   ApprovalsMgmt.OnSendCustomerForApproval(Rec);
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=ENU=Cancel Approval Re&quest;
                      ToolTipML=ENU=Cancel the approval request.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Enabled=CanCancelApprovalForRecord OR CanCancelApprovalForFlow;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category6;
                      PromotedOnly=true;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit "Approvals Mgmt.";
                                 WorkflowWebhookManagement@1000 : Codeunit "Workflow Webhook Management";
                               BEGIN
                                 ApprovalsMgmt.OnCancelCustomerApprovalRequest(Rec);
                                 WorkflowWebhookManagement.FindAndCancel(RECORDID);
                               END;
                                }
      { 161     ;2   ;ActionGroup;
                      Name=Flow;
                      CaptionML=ENU=Flow }
      { 168     ;3   ;Action    ;
                      Name=CreateFlow;
                      CaptionML=ENU=Create a Flow;
                      ToolTipML=ENU=Create a new Flow from a list of relevant Flow templates.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Image=Flow;
                      PromotedCategory=Category6;
                      PromotedOnly=true;
                      OnAction=VAR
                                 FlowServiceManagement@1001 : Codeunit "Flow Service Management";
                                 FlowTemplateSelector@1000 : Page "Flow Template Selector";
                               BEGIN
                                 // Opens page 6400 where the user can use filtered templates to create new flows.
                                 FlowTemplateSelector.SetSearchText(FlowServiceManagement.GetCustomerTemplateFilter);
                                 FlowTemplateSelector.RUN;
                               END;
                                }
      { 166     ;3   ;Action    ;
                      Name=SeeFlows;
                      CaptionML=ENU=See my Flows;
                      ToolTipML=ENU=View and configure Flows that you created.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Flow Selector";
                      Promoted=true;
                      Image=Flow;
                      PromotedCategory=Category6;
                      PromotedOnly=true }
      { 142     ;1   ;ActionGroup;
                      Name=Workflow;
                      CaptionML=ENU=Workflow }
      { 17      ;2   ;Action    ;
                      Name=CreateApprovalWorkflow;
                      CaptionML=ENU=Create Approval Workflow;
                      ToolTipML=ENU=Set up an approval workflow for creating or changing customers, by going through a few pages that will guide you.;
                      ApplicationArea=#Advanced;
                      Enabled=NOT EnabledApprovalWorkflowsExist;
                      Image=CreateWorkflow;
                      OnAction=BEGIN
                                 PAGE.RUNMODAL(PAGE::"Cust. Approval WF Setup Wizard");
                               END;
                                }
      { 138     ;2   ;Action    ;
                      Name=ManageApprovalWorkflows;
                      CaptionML=ENU=Manage Approval Workflows;
                      ToolTipML=ENU=View or edit existing approval workflows for creating or changing customers.;
                      ApplicationArea=#Advanced;
                      Enabled=EnabledApprovalWorkflowsExist;
                      Image=WorkflowSetup;
                      OnAction=VAR
                                 WorkflowManagement@1000 : Codeunit "Workflow Management";
                               BEGIN
                                 WorkflowManagement.NavigateToWorkflows(DATABASE::Customer,EventFilter);
                               END;
                                }
      { 163     ;1   ;ActionGroup;
                      Name=F&unctions;
                      CaptionML=ENU=F&unctions;
                      Image=Action }
      { 139     ;2   ;Action    ;
                      Name=Templates;
                      CaptionML=ENU=Templates;
                      ToolTipML=ENU=View or edit customer templates.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Config Templates";
                      RunPageLink="Table ID"=CONST(18);
                      PromotedIsBig=true;
                      Image=Template }
      { 167     ;2   ;Action    ;
                      Name=ApplyTemplate;
                      Ellipsis=true;
                      CaptionML=ENU=Apply Template;
                      ToolTipML=ENU=Apply a template to update the entity with your standard settings for a certain type of entity.;
                      ApplicationArea=#Basic,#Suite;
                      Image=ApplyTemplate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 MiniCustomerTemplate@1002 : Record "Mini Customer Template";
                               BEGIN
                                 MiniCustomerTemplate.UpdateCustomerFromTemplate(Rec);
                               END;
                                }
      { 132     ;2   ;Action    ;
                      Name=SaveAsTemplate;
                      Ellipsis=true;
                      CaptionML=ENU=Save as Template;
                      ToolTipML=ENU=Save the customer card as a template that can be reused to create new customer cards. Customer templates contain preset information to help you fill fields on customer cards.;
                      ApplicationArea=#Basic,#Suite;
                      PromotedIsBig=true;
                      Image=Save;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TempMiniCustomerTemplate@1000 : TEMPORARY Record "Mini Customer Template";
                               BEGIN
                                 TempMiniCustomerTemplate.SaveAsTemplate(Rec);
                               END;
                                }
      { 1900839804;1 ;Action    ;
                      Name=Post Cash Receipts;
                      Ellipsis=true;
                      CaptionML=ENU=Post Cash Receipts;
                      ToolTipML=ENU=Create a cash receipt journal line for the customer, for example, to post a payment receipt.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Cash Receipt Journal";
                      Image=CashReceiptJournal;
                      PromotedCategory=Process }
      { 1905171704;1 ;Action    ;
                      Name=Sales Journal;
                      CaptionML=ENU=Sales Journal;
                      ToolTipML=ENU=Post any sales transaction for the customer.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Sales Journal";
                      Image=Journals;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      Name=ActionContainer1900000006;
                      ActionContainerType=Reports }
      { 1906813206;1 ;Action    ;
                      Name=Report Customer Detailed Aging;
                      CaptionML=ENU=Customer Detailed Aging;
                      ToolTipML=ENU=View a detailed list of each customer's total payments due, divided into three time periods. The report can be used to decide when to issue reminders, to evaluate a customer's creditworthiness, or to prepare liquidity analyses.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=false;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 RunReport(REPORT::"Customer Detailed Aging","No.");
                               END;
                                }
      { 1907586706;1 ;Action    ;
                      Name=Report Customer - Labels;
                      CaptionML=ENU=Customer - Labels;
                      ToolTipML=ENU=View mailing labels with the customers' names and addresses.;
                      ApplicationArea=#Advanced;
                      Promoted=false;
                      Image=Report;
                      PromotedCategory=Category9;
                      OnAction=BEGIN
                                 RunReport(REPORT::"Customer - Labels","No.");
                               END;
                                }
      { 1902299006;1 ;Action    ;
                      Name=Report Customer - Balance to Date;
                      CaptionML=ENU=Customer - Balance to Date;
                      ToolTipML=ENU=View a list with customers' payment history up until a certain date. You can use the report to extract your total sales income at the close of an accounting period or fiscal year.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Report;
                      PromotedCategory=Category9;
                      OnAction=BEGIN
                                 RunReport(REPORT::"Customer - Balance to Date","No.");
                               END;
                                }
      { 133     ;1   ;Action    ;
                      Name=Report Statement;
                      CaptionML=ENU=Statement;
                      ToolTipML=ENU=View a list of a customer's transactions for a selected period, for example, to send to the customer at the close of an accounting period. You can choose to have all overdue balances displayed regardless of the period specified, or you can choose to include an aging band.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Codeunit "Customer Layout - Statement";
                      Image=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;;Container;
                Name=Container1900000001;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Name=General;
                CaptionML=ENU=General }

    { 2   ;2   ;Field     ;
                Name=No.;
                ToolTipML=ENU=Specifies the number of the customer. The field is either filled automatically from a defined number series, or you enter the number manually because you have enabled manual number entry in the number-series setup.;
                ApplicationArea=#All;
                SourceExpr="No.";
                Importance=Additional;
                Visible=NoFieldVisible;
                OnAssistEdit=BEGIN
                               if AssistEdit(xRec) then
                                 CurrPage.UPDATE;
                             END;

                ImplicitType=Code20 }

    { 4   ;2   ;Field     ;
                Name=Name;
                ToolTipML=ENU=Specifies the customer's name. This name will appear on all sales documents for the customer. You can enter a maximum of 50 characters, both numbers and letters.;
                ApplicationArea=#All;
                SourceExpr=Name;
                Importance=Promoted;
                ImplicitType=Text50;
                ShowMandatory=TRUE }

    { 18  ;2   ;Field     ;
                Name=Search Name;
                ToolTipML=ENU=Specifies an alternate name that you can use to search for a customer.;
                ApplicationArea=#Advanced;
                SourceExpr="Search Name";
                Importance=Additional;
                Visible=FALSE;
                ImplicitType=Code50 }

    { 154 ;2   ;Field     ;
                Name=IC Partner Code;
                ToolTipML=ENU=Specifies the customer's intercompany partner code.;
                ApplicationArea=#Intercompany;
                SourceExpr="IC Partner Code";
                Importance=Additional;
                ImplicitType=Code20 }

    { 20  ;2   ;Field     ;
                Name=Balance (LCY);
                ToolTipML=ENU=Specifies the payment amount that the customer owes for completed sales. This value is also known as the customer's balance.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Balance (LCY)";
                OnDrillDown=BEGIN
                              OpenCustomerLedgerEntries(false);
                            END;

                ImplicitType=Decimal }

    { 144 ;2   ;Field     ;
                Name=Balance Due (LCY);
                ToolTipML=ENU=Specifies payments from the customer that are overdue per today's date.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Balance Due (LCY)";
                OnDrillDown=BEGIN
                              OpenCustomerLedgerEntries(true);
                            END;

                ImplicitType=Decimal }

    { 22  ;2   ;Field     ;
                Name=Credit Limit (LCY);
                ToolTipML=ENU=Specifies the maximum amount you allow the customer to exceed the payment balance before warnings are issued.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Credit Limit (LCY)";
                StyleExpr=StyleTxt;
                OnValidate=BEGIN
                             StyleTxt := SetStyle;
                           END;

                ImplicitType=Decimal }

    { 26  ;2   ;Field     ;
                Name=Blocked;
                ToolTipML=ENU=Specifies which transactions with the customer that cannot be blocked, for example, because the customer is insolvent.;
                ApplicationArea=#Advanced;
                SourceExpr=Blocked;
                ImplicitType=Option }

    { 24  ;2   ;Field     ;
                Name=Salesperson Code;
                ToolTipML=ENU=Specifies a code for the salesperson who normally handles this customer's account.;
                ApplicationArea=#Suite;
                SourceExpr="Salesperson Code";
                Importance=Additional;
                ImplicitType=Code20 }

    { 64  ;2   ;Field     ;
                Name=Responsibility Center;
                ToolTipML=ENU=Specifies the code for the responsibility center that will administer this customer by default.;
                ApplicationArea=#Advanced;
                SourceExpr="Responsibility Center";
                Importance=Additional;
                ImplicitType=Code10 }

    { 93  ;2   ;Field     ;
                Name=Service Zone Code;
                ToolTipML=ENU=Specifies the code for the service zone that is assigned to the customer.;
                ApplicationArea=#Service;
                SourceExpr="Service Zone Code";
                Importance=Additional;
                ImplicitType=Code10 }

    { 137 ;2   ;Field     ;
                Name=BlockedCustomer;
                CaptionML=ENU=Blocked;
                ToolTipML=ENU=Specifies if transactions with the customer are blocked, for example, because the customer is insolvent.;
                OptionCaptionML=ENU=" ,,,All";
                ApplicationArea=#All;
                SourceExpr=BlockedCustomer;
                Visible=FoundationOnly;
                Enabled=DynamicEditable;
                OnValidate=BEGIN
                             if BlockedCustomer then
                               Blocked := Blocked::All
                             else
                               Blocked := Blocked::" ";
                           END;

                ImplicitType=Boolean }

    { 23  ;2   ;Field     ;
                Name=Document Sending Profile;
                ToolTipML=ENU=Specifies the preferred method of sending documents to this customer, so that you do not have to select a sending option every time that you post and send a document to the customer. Sales documents to this customer will be sent using the specified sending profile and will override the default document sending profile.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Sending Profile";
                Importance=Additional;
                ImplicitType=Code20 }

    { 73  ;2   ;Field     ;
                Name=TotalSales2;
                CaptionML=ENU=Total Sales;
                ToolTipML=ENU=Specifies your total sales turnover with the customer in the current fiscal year. It is calculated from amounts excluding VAT on all completed and open invoices and credit memos.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GetTotalSales;
                Style=Strong;
                StyleExpr=TRUE }

    { 72  ;2   ;Field     ;
                Name=Costs (LCY);
                CaptionML=ENU=Costs (LCY);
                ToolTipML=ENU=Specifies how much cost you have incurred from the customer in the current fiscal year.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=CustSalesLCY - CustProfit - AdjmtCostLCY;
                AutoFormatType=1 }

    { 71  ;2   ;Field     ;
                Name=AdjCustProfit;
                CaptionML=ENU=Profit (LCY);
                ToolTipML=ENU=Specifies how much profit you have made from the customer in the current fiscal year.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=AdjCustProfit;
                AutoFormatType=1;
                Importance=Additional;
                Editable=False;
                ImplicitType=Decimal }

    { 69  ;2   ;Field     ;
                Name=AdjProfitPct;
                CaptionML=ENU=Profit %;
                ToolTipML=ENU=Specifies how much profit you have made from the customer in the current fiscal year, expressed as a percentage of the customer's total sales.;
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=1:1;
                SourceExpr=AdjProfitPct;
                Importance=Additional;
                Editable=False;
                ImplicitType=Decimal }

    { 28  ;2   ;Field     ;
                Name=Last Date Modified;
                ToolTipML=ENU=Specifies when the customer card was last modified.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Last Date Modified";
                Importance=Additional;
                ImplicitType=Date }

    { 1902768601;1;Group  ;
                Name=Address & Contact;
                CaptionML=ENU=Address & Contact;
                GroupType=Group }

    { 63  ;2   ;Group     ;
                Name=AddressDetails;
                CaptionML=ENU=Address;
                GroupType=Group }

    { 6   ;3   ;Field     ;
                Name=Address;
                ToolTipML=ENU=Specifies the customer's address. This address will appear on all sales documents for the customer.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Address;
                ImplicitType=Text50 }

    { 8   ;3   ;Field     ;
                Name=Address 2;
                ToolTipML=ENU=Specifies additional address information.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Address 2";
                ImplicitType=Text50 }

    { 90  ;3   ;Field     ;
                Name=Post Code;
                ToolTipML=ENU=Specifies the postal code.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Post Code";
                Importance=Promoted;
                ImplicitType=Code20 }

    { 10  ;3   ;Field     ;
                Name=City;
                ToolTipML=ENU=Specifies the customer's city.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=City;
                ImplicitType=Text30 }

    { 91  ;3   ;Field     ;
                Name=Country/Region Code;
                ToolTipML=ENU=Specifies the country/region of the address.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Country/Region Code";
                ImplicitType=Code10 }

    { 125 ;3   ;Field     ;
                Name=ShowMap;
                ToolTipML=ENU=Specifies the customer's address on your preferred map website.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ShowMapLbl;
                Editable=FALSE;
                Style=StrongAccent;
                StyleExpr=TRUE;
                OnDrillDown=BEGIN
                              CurrPage.UPDATE(true);
                              DisplayMap;
                            END;

                ImplicitType=TextConst;
                ShowCaption=false }

    { 65  ;2   ;Group     ;
                Name=ContactDetails;
                CaptionML=ENU=Contact;
                GroupType=Group }

    { 122 ;3   ;Field     ;
                Name=Primary Contact No.;
                CaptionML=ENU=Primary Contact Code;
                ToolTipML=ENU=Specifies the primary contact number for the customer.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Primary Contact No.";
                ImplicitType=Code20 }

    { 16  ;3   ;Field     ;
                Name=ContactName;
                CaptionML=ENU=Contact Name;
                ToolTipML=ENU=Specifies the name of the person you regularly contact when you do business with this customer.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Contact;
                Importance=Promoted;
                Editable=ContactEditable;
                OnValidate=BEGIN
                             ContactOnAfterValidate;
                           END;

                ImplicitType=Text50 }

    { 12  ;3   ;Field     ;
                Name=Phone No.;
                ToolTipML=ENU=Specifies the customer's telephone number.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Phone No.";
                ImplicitType=Text30 }

    { 107 ;3   ;Field     ;
                Name=E-Mail;
                ExtendedDatatype=E-Mail;
                ToolTipML=ENU=Specifies the customer's email address.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="E-Mail";
                Importance=Promoted;
                ImplicitType=Text80 }

    { 104 ;3   ;Field     ;
                Name=Fax No.;
                ToolTipML=ENU=Specifies the customer's fax number.;
                ApplicationArea=#Advanced;
                SourceExpr="Fax No.";
                Importance=Additional;
                ImplicitType=Text30 }

    { 109 ;3   ;Field     ;
                Name=Home Page;
                ToolTipML=ENU=Specifies the customer's home page address.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Home Page";
                ImplicitType=Text80 }

    { 66  ;3   ;Field     ;
                Name=Language Code;
                ToolTipML=ENU=Specifies the language to be used on printouts for this customer.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Language Code";
                Importance=Additional;
                ImplicitType=Code10 }

    { 1905885101;1;Group  ;
                Name=Invoicing;
                CaptionML=ENU=Invoicing }

    { 34  ;2   ;Field     ;
                Name=Bill-to Customer No.;
                CaptionML=ENU=Bill-to Customer;
                ToolTipML=ENU=Specifies a different customer who will be invoiced for products that you sell to the customer in the Name field on the customer card.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Customer No.";
                Importance=Additional;
                ImplicitType=Code20 }

    { 29  ;2   ;Field     ;
                Name=VAT Registration No.;
                ToolTipML=ENU=Specifies the customer's VAT registration number for customers in EU countries/regions.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Registration No.";
                OnDrillDown=VAR
                              VATRegistrationLogMgt@1000 : Codeunit "VAT Registration Log Mgt.";
                            BEGIN
                              VATRegistrationLogMgt.AssistEditCustomerVATReg(Rec);
                            END;

                ImplicitType=Text20 }

    { 61  ;2   ;Field     ;
                Name=GLN;
                ToolTipML=ENU=Specifies the customer in connection with electronic document sending.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GLN;
                Importance=Additional;
                ImplicitType=Code13 }

    { 156 ;2   ;Field     ;
                Name=Copy Sell-to Addr. to Qte From;
                ToolTipML=ENU=Specifies which customer address is inserted on sales quotes that you create for the customer.;
                ApplicationArea=#Advanced;
                SourceExpr="Copy Sell-to Addr. to Qte From";
                ImplicitType=Option }

    { 36  ;2   ;Field     ;
                Name=Invoice Copies;
                ToolTipML=ENU=Specifies how many copies of an invoice for the customer will be printed at a time.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Invoice Copies";
                Importance=Additional;
                ImplicitType=Integer }

    { 170 ;2   ;Group     ;
                Name=PostingDetails;
                CaptionML=ENU=Posting Details;
                GroupType=Group }

    { 70  ;3   ;Field     ;
                Name=Gen. Bus. Posting Group;
                ToolTipML=ENU=Specifies the customer's trade type to link transactions made for this customer with the appropriate general ledger account according to the general posting setup.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Gen. Bus. Posting Group";
                Importance=Promoted;
                ImplicitType=Code20;
                ShowMandatory=TRUE }

    { 58  ;3   ;Field     ;
                Name=VAT Bus. Posting Group;
                ToolTipML=ENU=Specifies the customer's VAT specification to link transactions made for this customer to.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Bus. Posting Group";
                Importance=Additional;
                ImplicitType=Code20 }

    { 38  ;3   ;Field     ;
                Name=Customer Posting Group;
                ToolTipML=ENU=Specifies the customer's market type to link business transactions to.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Customer Posting Group";
                Importance=Promoted;
                ImplicitType=Code20;
                ShowMandatory=TRUE }

    { 68  ;2   ;Group     ;
                Name=PricesandDiscounts;
                CaptionML=ENU=Prices and Discounts;
                GroupType=Group }

    { 67  ;3   ;Field     ;
                Name=Currency Code;
                ToolTipML=ENU=Specifies the default currency for the customer.;
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Additional;
                ImplicitType=Code10 }

    { 40  ;3   ;Field     ;
                Name=Customer Price Group;
                ToolTipML=ENU=Specifies the customer price group code, which you can use to set up special sales prices in the Sales Prices window.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Customer Price Group";
                Importance=Promoted;
                ImplicitType=Code10 }

    { 44  ;3   ;Field     ;
                Name=Customer Disc. Group;
                ToolTipML=ENU=Specifies the customer discount group code, which you can use as a criterion to set up special discounts in the Sales Line Discounts window.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Customer Disc. Group";
                Importance=Promoted;
                ImplicitType=Code20 }

    { 46  ;3   ;Field     ;
                Name=Allow Line Disc.;
                ToolTipML=ENU=Specifies if a sales line discount is calculated when a special sales price is offered according to setup in the Sales Prices window.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Allow Line Disc.";
                Importance=Additional;
                ImplicitType=Boolean }

    { 42  ;3   ;Field     ;
                Name=Invoice Disc. Code;
                ToolTipML=ENU=Specifies a code for the invoice discount terms that you have defined for the customer.;
                ApplicationArea=#Basic,#Suite;
                NotBlank=true;
                SourceExpr="Invoice Disc. Code";
                Importance=Additional;
                ImplicitType=Code20 }

    { 129 ;3   ;Field     ;
                Name=Prices Including VAT;
                ToolTipML=ENU=Specifies if the Unit Price and Line Amount fields on document lines should be shown with or without VAT.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Prices Including VAT";
                Importance=Additional;
                ImplicitType=Boolean }

    { 1901677601;1;Group  ;
                Name=Payments;
                CaptionML=ENU=Payments }

    { 160 ;2   ;Field     ;
                Name=Prepayment %;
                ToolTipML=ENU=Specifies a prepayment percentage that applies to all orders for this customer, regardless of the items or services on the order lines.;
                ApplicationArea=#Prepayments;
                SourceExpr="Prepayment %";
                Importance=Additional;
                ImplicitType=Decimal }

    { 48  ;2   ;Field     ;
                Name=Application Method;
                ToolTipML=ENU=Specifies how to apply payments to entries for this customer.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Application Method";
                Importance=Additional;
                ImplicitType=Option }

    { 21  ;2   ;Field     ;
                Name=Partner Type;
                ToolTipML=ENU=Specifies for direct debit collections if the customer that the payment is collected from is a person or a company.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Partner Type";
                Importance=Additional;
                ImplicitType=Option }

    { 50  ;2   ;Field     ;
                Name=Payment Terms Code;
                ToolTipML=ENU=Specifies a code that indicates the payment terms that you require of the customer.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Promoted;
                ImplicitType=Code10;
                ShowMandatory=TRUE }

    { 11  ;2   ;Field     ;
                Name=Payment Method Code;
                ToolTipML=ENU=Specifies how the customer usually submits payment, such as bank transfer or check.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code";
                Importance=Additional;
                ImplicitType=Code10 }

    { 15  ;2   ;Field     ;
                Name=Reminder Terms Code;
                ToolTipML=ENU=Specifies how reminders about late payments are handled for this customer.;
                ApplicationArea=#Advanced;
                SourceExpr="Reminder Terms Code";
                Importance=Additional;
                ImplicitType=Code10 }

    { 52  ;2   ;Field     ;
                Name=Fin. Charge Terms Code;
                ToolTipML=ENU=Specifies finance charges are calculated for the customer.;
                ApplicationArea=#Advanced;
                SourceExpr="Fin. Charge Terms Code";
                Importance=Additional;
                ImplicitType=Code10 }

    { 3   ;2   ;Field     ;
                Name=Cash Flow Payment Terms Code;
                ToolTipML=ENU=Specifies a payment term that will be used to calculate cash flow for the customer.;
                ApplicationArea=#Advanced;
                SourceExpr="Cash Flow Payment Terms Code";
                Importance=Additional;
                ImplicitType=Code10 }

    { 54  ;2   ;Field     ;
                Name=Print Statements;
                ToolTipML=ENU=Specifies whether to include this customer when you print the Statement report.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Print Statements";
                Importance=Additional;
                ImplicitType=Boolean }

    { 60  ;2   ;Field     ;
                Name=Last Statement No.;
                ToolTipML=ENU=Specifies the number of the last statement that was printed for this customer.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Last Statement No.";
                Importance=Additional;
                ImplicitType=Integer }

    { 143 ;2   ;Field     ;
                Name=Block Payment Tolerance;
                ToolTipML=ENU=Specifies that the customer is not allowed a payment tolerance.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Block Payment Tolerance";
                Importance=Additional;
                ImplicitType=Boolean }

    { 25  ;2   ;Field     ;
                Name=Preferred Bank Account Code;
                ToolTipML=ENU=Specifies the customer's bank account that will be used by default when you process refunds to the customer and direct debit collections.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Preferred Bank Account Code";
                Importance=Additional;
                ImplicitType=Code10 }

    { 1906801201;1;Group  ;
                Name=Shipping;
                CaptionML=ENU=Shipping }

    { 95  ;2   ;Field     ;
                Name=Location Code;
                ToolTipML=ENU=Specifies from which location sales to this customer will be processed by default.;
                ApplicationArea=#Location;
                SourceExpr="Location Code";
                Importance=Promoted;
                ImplicitType=Code10 }

    { 32  ;2   ;Field     ;
                Name=Combine Shipments;
                ToolTipML=ENU=Specifies if several orders delivered to the customer can appear on the same sales invoice.;
                ApplicationArea=#Advanced;
                SourceExpr="Combine Shipments";
                ImplicitType=Boolean }

    { 158 ;2   ;Field     ;
                Name=Reserve;
                ToolTipML=ENU=Specifies whether items will never, automatically (Always), or optionally be reserved for this customer.;
                ApplicationArea=#Advanced;
                SourceExpr=Reserve;
                ImplicitType=Option }

    { 123 ;2   ;Field     ;
                Name=Shipping Advice;
                ToolTipML=ENU=Specifies if the customer accepts partial shipment of orders.;
                ApplicationArea=#Advanced;
                SourceExpr="Shipping Advice";
                Importance=Promoted;
                ImplicitType=Option }

    { 145 ;2   ;Group     ;
                Name=Shipment Method;
                CaptionML=ENU=Shipment Method;
                GroupType=Group }

    { 30  ;3   ;Field     ;
                Name=Shipment Method Code;
                CaptionML=ENU=Code;
                ToolTipML=ENU=Specifies which shipment method to use when you ship items to the customer.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Method Code";
                Importance=Promoted;
                ImplicitType=Code10 }

    { 101 ;3   ;Field     ;
                Name=Shipping Agent Code;
                CaptionML=ENU=Agent;
                ToolTipML=ENU=Specifies which shipping company is used when you ship items to the customer.;
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Code";
                Importance=Additional;
                ImplicitType=Code10 }

    { 131 ;3   ;Field     ;
                Name=Shipping Agent Service Code;
                CaptionML=ENU=Agent Service;
                ToolTipML=ENU=Specifies the code for the shipping agent service to use for this customer.;
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Service Code";
                Importance=Additional;
                ImplicitType=Code10 }

    { 119 ;2   ;Field     ;
                Name=Shipping Time;
                ToolTipML=ENU=Specifies how long it takes from when the items are shipped from the warehouse to when they are delivered.;
                ApplicationArea=#Suite;
                SourceExpr="Shipping Time";
                Importance=Additional;
                ImplicitType=DateFormula }

    { 141 ;2   ;Field     ;
                Name=Base Calendar Code;
                DrillDown=false;
                ToolTipML=ENU=Specifies a customizable calendar for shipment planning that holds the customer's working days and holidays.;
                ApplicationArea=#Advanced;
                SourceExpr="Base Calendar Code";
                ImplicitType=Code10 }

    { 146 ;2   ;Field     ;
                Name=Customized Calendar;
                CaptionML=ENU=Customized Calendar;
                ToolTipML=ENU=Specifies that you have set up a customized version of a base calendar.;
                ApplicationArea=#Advanced;
                SourceExpr=CalendarMgmt.CustomizedCalendarExistText(CustomizedCalendar."Source Type"::Customer,"No.",'',"Base Calendar Code");
                Editable=FALSE;
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              TESTFIELD("Base Calendar Code");
                              CalendarMgmt.ShowCustomizedCalendar(CustomizedCalEntry."Source Type"::Customer,"No.",'',"Base Calendar Code");
                            END;
                             }

    { 124 ;1   ;Group     ;
                Name=Statistics;
                CaptionML=ENU=Statistics;
                Visible=FoundationOnly;
                Editable=false;
                GroupType=Group }

    { 120 ;2   ;Group     ;
                Name=Balance;
                CaptionML=ENU=Balance;
                GroupType=Group }

    { 117 ;3   ;Field     ;
                Name=Balance (LCY)2;
                CaptionML=ENU=Money Owed - Current;
                ToolTipML=ENU=Specifies the payment amount that the customer owes for completed sales. This value is also known as the customer's balance.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Balance (LCY)";
                OnDrillDown=BEGIN
                              OpenCustomerLedgerEntries(false);
                            END;

                ImplicitType=Decimal }

    { 116 ;3   ;Field     ;
                Name=Money Owed - Expected;
                CaptionML=ENU=Money Owed - Expected;
                ToolTipML=ENU=Specifies the payment amount that the customer will owe when ongoing sales invoices and credit memos are completed.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GetMoneyOwedExpected;
                Importance=Additional;
                OnDrillDown=BEGIN
                              CustomerMgt.DrillDownMoneyOwedExpected("No.");
                            END;
                             }

    { 115 ;3   ;Field     ;
                Name=TotalMoneyOwed;
                CaptionML=ENU=Money Owed - Total;
                ToolTipML=ENU=Specifies the payment amount that the customer owes for completed sales plus sales that are still ongoing. The value is the sum of the values in the Money Owed - Current and Money Owed - Expected fields.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Balance (LCY)" + GetMoneyOwedExpected;
                Style=Strong;
                StyleExpr=TRUE }

    { 111 ;3   ;Field     ;
                Name=CreditLimit;
                CaptionML=ENU=Credit Limit;
                ToolTipML=ENU=Specifies the maximum amount you allow the customer to exceed the payment balance before warnings are issued.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Credit Limit (LCY)";
                ImplicitType=Decimal }

    { 110 ;3   ;Field     ;
                Name=Usage Of Credit Limit;
                ExtendedDatatype=Ratio;
                CaptionML=ENU=Usage Of Credit Limit;
                ToolTipML=ENU=Specifies how much of the customer's payment balance consists of credit.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=CalcCreditLimitLCYExpendedPct;
                Style=Attention;
                StyleExpr=BalanceExhausted;
                ImplicitType=Decimal }

    { 108 ;2   ;Group     ;
                Name=Group108;
                CaptionML=ENU=Payments;
                GroupType=Group }

    { 106 ;3   ;Field     ;
                Name=Balance Due;
                ToolTipML=ENU=Specifies the sum of outstanding payments from the customer.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=CalcOverdueBalance;
                CaptionClass=FORMAT(STRSUBSTNO(OverduePaymentsMsg,FORMAT(WORKDATE)));
                OnDrillDown=VAR
                              DtldCustLedgEntry@1000 : Record "Detailed Cust. Ledg. Entry";
                              CustLedgEntry@1001 : Record "Cust. Ledger Entry";
                            BEGIN
                              DtldCustLedgEntry.SETFILTER("Customer No.","No.");
                              COPYFILTER("Global Dimension 1 Filter",DtldCustLedgEntry."Initial Entry Global Dim. 1");
                              COPYFILTER("Global Dimension 2 Filter",DtldCustLedgEntry."Initial Entry Global Dim. 2");
                              COPYFILTER("Currency Filter",DtldCustLedgEntry."Currency Code");
                              CustLedgEntry.DrillDownOnOverdueEntries(DtldCustLedgEntry);
                            END;

                ImplicitType=Decimal }

    { 105 ;3   ;Field     ;
                Name=Payments (LCY);
                CaptionML=ENU=Payments This Year;
                ToolTipML=ENU=Specifies the sum of payments received from the customer in the current fiscal year.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payments (LCY)";
                ImplicitType=Decimal }

    { 103 ;3   ;Field     ;
                Name=Average Collection Period (Days);
                CaptionML=ENU=Average Collection Period (Days);
                ToolTipML=ENU=Specifies how long the customer typically takes to pay invoices in the current fiscal year.;
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:1;
                SourceExpr=CustomerMgt.AvgDaysToPay("No.");
                Importance=Additional }

    { 102 ;3   ;Field     ;
                Name=DaysPaidPastDueDate;
                CaptionML=ENU=Average Late Payments (Days);
                ToolTipML=ENU=Specifies the average number of days the customer is late with payments.;
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:1;
                SourceExpr=DaysPastDueDate;
                Importance=Additional;
                Style=Attention;
                StyleExpr=AttentionToPaidDay;
                ImplicitType=Decimal }

    { 100 ;2   ;Group     ;
                Name=Sales This Year;
                CaptionML=ENU=Sales This Year;
                GroupType=Group }

    { 98  ;3   ;Field     ;
                Name=GetAmountOnPostedInvoices;
                ToolTipML=ENU=Specifies your sales to the customer in the current fiscal year based on posted sales invoices. The figure in parenthesis Specifies the number of posted sales invoices.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GetAmountOnPostedInvoices;
                CaptionClass=STRSUBSTNO(PostedInvoicesMsg,FORMAT(NoPostedInvoices));
                OnDrillDown=BEGIN
                              CustomerMgt.DrillDownOnPostedInvoices("No.")
                            END;
                             }

    { 97  ;3   ;Field     ;
                Name=GetAmountOnCrMemo;
                ToolTipML=ENU=Specifies your expected refunds to the customer in the current fiscal year based on posted sales credit memos. The figure in parenthesis shows the number of posted sales credit memos.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GetAmountOnCrMemo;
                CaptionClass=STRSUBSTNO(CreditMemosMsg,FORMAT(NoPostedCrMemos));
                OnDrillDown=BEGIN
                              CustomerMgt.DrillDownOnPostedCrMemo("No.")
                            END;
                             }

    { 96  ;3   ;Field     ;
                Name=GetAmountOnOutstandingInvoices;
                ToolTipML=ENU=Specifies your expected sales to the customer in the current fiscal year based on ongoing sales invoices. The figure in parenthesis shows the number of ongoing sales invoices.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GetAmountOnOutstandingInvoices;
                CaptionClass=STRSUBSTNO(OutstandingInvoicesMsg,FORMAT(NoOutstandingInvoices));
                OnDrillDown=BEGIN
                              CustomerMgt.DrillDownOnUnpostedInvoices("No.")
                            END;
                             }

    { 92  ;3   ;Field     ;
                Name=GetAmountOnOutstandingCrMemos;
                ToolTipML=ENU=Specifies your refunds to the customer in the current fiscal year based on ongoing sales credit memos. The figure in parenthesis shows the number of ongoing sales credit memos.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GetAmountOnOutstandingCrMemos;
                CaptionClass=STRSUBSTNO(OutstandingCrMemosMsg,FORMAT(NoOutstandingCrMemos));
                OnDrillDown=BEGIN
                              CustomerMgt.DrillDownOnUnpostedCrMemos("No.")
                            END;
                             }

    { 89  ;3   ;Field     ;
                Name=Totals;
                CaptionML=ENU=Total Sales;
                ToolTipML=ENU=Specifies your total sales turnover with the customer in the current fiscal year. It is calculated from amounts excluding VAT on all completed and open invoices and credit memos.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Totals;
                Style=Strong;
                StyleExpr=TRUE;
                ImplicitType=Decimal }

    { 88  ;3   ;Field     ;
                Name=CustInvDiscAmountLCY;
                CaptionML=ENU=Invoice Discounts;
                ToolTipML=ENU=Specifies the total of all invoice discounts that you have granted to the customer in the current fiscal year.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=CustInvDiscAmountLCY;
                ImplicitType=Decimal }

    { 87  ;2   ;Part      ;
                Name=AgedAccReceivableChart;
                ApplicationArea=#Advanced;
                SubPageLink="No."=FIELD("No.");
                PagePartID="Aged Acc. Receivable Chart";
                Visible=ShowCharts;
                PartType=Page }

    { 75  ;1   ;Part      ;
                Name=PriceAndLineDisc;
                CaptionML=ENU=Special Prices & Discounts;
                ApplicationArea=#All;
                PagePartID="Sales Price and Line Discounts";
                Visible=FoundationOnly;
                PartType=Page }

    { 1900000007;0;Container;
                Name=Container1900000007;
                ContainerType=FactBoxArea }

    { 149 ;1   ;Part      ;
                Name=Part149;
                ApplicationArea=#Basic,#Suite;
                SubPageLink="No."=FIELD("No.");
                PagePartID="Customer Picture";
                Visible=NOT IsOfficeAddin;
                PartType=Page }

    { 135 ;1   ;Part      ;
                Name=Details;
                CaptionML=ENU=Details;
                ApplicationArea=#All;
                SubPageLink="No."=FIELD("No.");
                PagePartID="Office Customer Details";
                Visible=IsOfficeAddin;
                PartType=Page }

    { 134 ;1   ;Part      ;
                Name=AgedAccReceivableChart2;
                ApplicationArea=#All;
                SubPageLink="No."=FIELD("No.");
                PagePartID="Aged Acc. Receivable Chart";
                Visible=IsOfficeAddin;
                PartType=Page }

    { 39  ;1   ;Part      ;
                Name=Part39;
                ApplicationArea=#All;
                SubPageLink="No."=FIELD("No.");
                PagePartID="CRM Statistics FactBox";
                Visible=CRMIsCoupledToRecord;
                PartType=Page }

    { 35  ;1   ;Part      ;
                Name=Part35;
                ApplicationArea=#All;
                SubPageLink="Source Type"=CONST(Customer),
                            "Source No."=FIELD("No.");
                PagePartID="Social Listening FactBox";
                Visible=SocialListeningVisible;
                PartType=Page }

    { 27  ;1   ;Part      ;
                Name=Part27;
                ApplicationArea=#All;
                SubPageLink="Source Type"=CONST(Customer),
                            "Source No."=FIELD("No.");
                PagePartID="Social Listening Setup FactBox";
                Visible=SocialListeningSetupVisible;
                PartType=Page;
                UpdatePropagation=Both }

    { 1903720907;1;Part   ;
                Name=SalesHistSelltoFactBox;
                ApplicationArea=#Basic,#Suite;
                SubPageLink="No."=FIELD("No."),
                            "Currency Filter"=FIELD("Currency Filter"),
                            "Date Filter"=FIELD("Date Filter"),
                            "Global Dimension 1 Filter"=FIELD("Global Dimension 1 Filter"),
                            "Global Dimension 2 Filter"=FIELD("Global Dimension 2 Filter");
                PagePartID="Sales Hist. Sell-to FactBox";
                PartType=Page }

    { 1907234507;1;Part   ;
                Name=SalesHistBilltoFactBox;
                ApplicationArea=#All;
                SubPageLink="No."=FIELD("No."),
                            "Currency Filter"=FIELD("Currency Filter"),
                            "Date Filter"=FIELD("Date Filter"),
                            "Global Dimension 1 Filter"=FIELD("Global Dimension 1 Filter"),
                            "Global Dimension 2 Filter"=FIELD("Global Dimension 2 Filter");
                PagePartID="Sales Hist. Bill-to FactBox";
                Visible=FALSE;
                PartType=Page }

    { 1902018507;1;Part   ;
                Name=CustomerStatisticsFactBox;
                ApplicationArea=#Advanced;
                SubPageLink="No."=FIELD("No."),
                            "Currency Filter"=FIELD("Currency Filter"),
                            "Date Filter"=FIELD("Date Filter"),
                            "Global Dimension 1 Filter"=FIELD("Global Dimension 1 Filter"),
                            "Global Dimension 2 Filter"=FIELD("Global Dimension 2 Filter");
                PagePartID="Customer Statistics FactBox";
                PartType=Page }

    { 1905532107;1;Part   ;
                Name=Part1905532107;
                ApplicationArea=#Advanced;
                SubPageLink="Table ID"=CONST(18),
                            "No."=FIELD("No.");
                PagePartID="Dimensions FactBox";
                PartType=Page }

    { 1907829707;1;Part   ;
                Name=Part1907829707;
                ApplicationArea=#Advanced;
                SubPageLink="No."=FIELD("No."),
                            "Currency Filter"=FIELD("Currency Filter"),
                            "Date Filter"=FIELD("Date Filter"),
                            "Global Dimension 1 Filter"=FIELD("Global Dimension 1 Filter"),
                            "Global Dimension 2 Filter"=FIELD("Global Dimension 2 Filter");
                PagePartID="Service Hist. Sell-to FactBox";
                Visible=FALSE;
                PartType=Page }

    { 1902613707;1;Part   ;
                Name=Part1902613707;
                ApplicationArea=#Advanced;
                SubPageLink="No."=FIELD("No."),
                            "Currency Filter"=FIELD("Currency Filter"),
                            "Date Filter"=FIELD("Date Filter"),
                            "Global Dimension 1 Filter"=FIELD("Global Dimension 1 Filter"),
                            "Global Dimension 2 Filter"=FIELD("Global Dimension 2 Filter");
                PagePartID="Service Hist. Bill-to FactBox";
                Visible=FALSE;
                PartType=Page }

    { 62  ;1   ;Part      ;
                Name=WorkflowStatus;
                ApplicationArea=#Suite;
                PagePartID="Workflow Status FactBox";
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=false }

    { 1900383207;1;Part   ;
                Name=Part1900383207;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Name=Part1905767507;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      CustomizedCalEntry@1001 : Record "Customized Calendar Entry";
      CustomizedCalendar@1005 : Record "Customized Calendar Change";
      CalendarMgmt@1002 : Codeunit "Calendar Management";
      ApprovalsMgmt@1009 : Codeunit "Approvals Mgmt.";
      CRMIntegrationManagement@1045 : Codeunit "CRM Integration Management";
      CustomerMgt@1024 : Codeunit "Customer Mgt.";
      StyleTxt@1004 : Text;
      BlockedCustomer@1062 : Boolean;
      ContactEditable@19051436 : Boolean INDATASET;
      SocialListeningSetupVisible@1000 : Boolean INDATASET;
      SocialListeningVisible@1003 : Boolean INDATASET;
      ShowCharts@1040 : Boolean INDATASET;
      CRMIntegrationEnabled@1007 : Boolean;
      CRMIsCoupledToRecord@1006 : Boolean;
      OpenApprovalEntriesExistCurrUser@1008 : Boolean;
      OpenApprovalEntriesExist@1010 : Boolean;
      ShowWorkflowStatus@1011 : Boolean;
      NoFieldVisible@1014 : Boolean;
      BalanceExhausted@1032 : Boolean;
      AttentionToPaidDay@1035 : Boolean;
      DynamicEditable@1063 : Boolean;
      IsOfficeAddin@1065 : Boolean;
      NoPostedInvoices@1015 : Integer;
      NoPostedCrMemos@1018 : Integer;
      NoOutstandingInvoices@1017 : Integer;
      NoOutstandingCrMemos@1016 : Integer;
      Totals@1019 : Decimal;
      AmountOnPostedInvoices@1023 : Decimal;
      AmountOnPostedCrMemos@1022 : Decimal;
      AmountOnOutstandingInvoices@1021 : Decimal;
      AmountOnOutstandingCrMemos@1020 : Decimal;
      AdjmtCostLCY@1028 : Decimal;
      AdjCustProfit@1027 : Decimal;
      CustProfit@1026 : Decimal;
      AdjProfitPct@1025 : Decimal;
      CustInvDiscAmountLCY@1029 : Decimal;
      CustPaymentsLCY@1030 : Decimal;
      CustSalesLCY@1031 : Decimal;
      OverduePaymentsMsg@1033 : TextConst '@@@=Overdue Payments as of 27-02-2012;ENU=Overdue Payments as of %1';
      DaysPastDueDate@1034 : Decimal;
      PostedInvoicesMsg@1036 : TextConst '@@@=Invoices (5);ENU=Posted Invoices (%1)';
      CreditMemosMsg@1037 : TextConst '@@@=Credit Memos (3);ENU=Posted Credit Memos (%1)';
      OutstandingInvoicesMsg@1039 : TextConst '@@@=Ongoing Invoices (4);ENU=Ongoing Invoices (%1)';
      OutstandingCrMemosMsg@1038 : TextConst '@@@=Ongoing Credit Memos (4);ENU=Ongoing Credit Memos (%1)';
      ShowMapLbl@1066 : TextConst 'ENU=Show on Map';
      FoundationOnly@1012 : Boolean;
      CanCancelApprovalForRecord@1013 : Boolean;
      EnabledApprovalWorkflowsExist@1041 : Boolean;
      NewMode@1044 : Boolean;
      EventFilter@1042 : Text;
      CaptionTxt@1043 : Text;
      CanRequestApprovalForFlow@1046 : Boolean;
      CanCancelApprovalForFlow@1047 : Boolean;

    LOCAL PROCEDURE GetTotalSales@6() : Decimal;
    BEGIN
      NoPostedInvoices := 0;
      NoPostedCrMemos := 0;
      NoOutstandingInvoices := 0;
      NoOutstandingCrMemos := 0;
      Totals := 0;

      AmountOnPostedInvoices := CustomerMgt.CalcAmountsOnPostedInvoices("No.",NoPostedInvoices);
      AmountOnPostedCrMemos := CustomerMgt.CalcAmountsOnPostedCrMemos("No.",NoPostedCrMemos);

      AmountOnOutstandingInvoices := CustomerMgt.CalculateAmountsOnUnpostedInvoices("No.",NoOutstandingInvoices);
      AmountOnOutstandingCrMemos := CustomerMgt.CalculateAmountsOnUnpostedCrMemos("No.",NoOutstandingCrMemos);

      Totals := AmountOnPostedInvoices + AmountOnPostedCrMemos + AmountOnOutstandingInvoices + AmountOnOutstandingCrMemos;

      CustomerMgt.CalculateStatistic(
        Rec,
        AdjmtCostLCY,AdjCustProfit,AdjProfitPct,
        CustInvDiscAmountLCY,CustPaymentsLCY,CustSalesLCY,
        CustProfit);
      exit(Totals)
    END;

    LOCAL PROCEDURE GetAmountOnPostedInvoices@5() : Decimal;
    BEGIN
      exit(AmountOnPostedInvoices)
    END;

    LOCAL PROCEDURE GetAmountOnCrMemo@8() : Decimal;
    BEGIN
      exit(AmountOnPostedCrMemos)
    END;

    LOCAL PROCEDURE GetAmountOnOutstandingInvoices@9() : Decimal;
    BEGIN
      exit(AmountOnOutstandingInvoices)
    END;

    LOCAL PROCEDURE GetAmountOnOutstandingCrMemos@10() : Decimal;
    BEGIN
      exit(AmountOnOutstandingCrMemos)
    END;

    LOCAL PROCEDURE GetMoneyOwedExpected@11() : Decimal;
    BEGIN
      exit(CustomerMgt.CalculateAmountsWithVATOnUnpostedDocuments("No."))
    END;

    LOCAL PROCEDURE GetSalesPricesAndSalesLineDisc@24();
    BEGIN
      if "No." <> CurrPage.PriceAndLineDisc.PAGE.GetLoadedCustNo then begin
        CurrPage.PriceAndLineDisc.PAGE.LoadCustomer(Rec);
        CurrPage.PriceAndLineDisc.PAGE.UPDATE(false);
      end;
    END;

    LOCAL PROCEDURE ActivateFields@3();
    BEGIN
      SetSocialListeningFactboxVisibility;
      ContactEditable := "Primary Contact No." = '';
    END;

    LOCAL PROCEDURE ContactOnAfterValidate@19013243();
    BEGIN
      ActivateFields;
    END;

    LOCAL PROCEDURE SetSocialListeningFactboxVisibility@1();
    VAR
      SocialListeningMgt@1000 : Codeunit "Social Listening Management";
    BEGIN
      SocialListeningMgt.GetCustFactboxVisibility(Rec,SocialListeningSetupVisible,SocialListeningVisible);
    END;

    LOCAL PROCEDURE SetNoFieldVisible@13();
    VAR
      DocumentNoVisibility@1000 : Codeunit DocumentNoVisibility;
    BEGIN
      NoFieldVisible := DocumentNoVisibility.CustomerNoIsVisible;
    END;

    LOCAL PROCEDURE SetCustomerNoVisibilityOnFactBoxes@12();
    BEGIN
      CurrPage.SalesHistSelltoFactBox.PAGE.SetCustomerNoVisibility(false);
      CurrPage.SalesHistBilltoFactBox.PAGE.SetCustomerNoVisibility(false);
      CurrPage.CustomerStatisticsFactBox.PAGE.SetCustomerNoVisibility(false);
    END;

    [External]
    PROCEDURE RunReport@2(ReportNumber@1000 : Integer;CustomerNumber@1002 : Code[20]);
    VAR
      Customer@1001 : Record Customer;
    BEGIN
      Customer.SETRANGE("No.",CustomerNumber);
      REPORT.RUNMODAL(ReportNumber,true,true,Customer);
    END;

    LOCAL PROCEDURE CreateCustomerFromTemplate@27();
    VAR
      MiniCustomerTemplate@1001 : Record "Mini Customer Template";
      Customer@1000 : Record Customer;
      VATRegNoSrvConfig@1003 : Record "VAT Reg. No. Srv Config";
      EUVATRegistrationNoCheck@1002 : Page "EU VAT Registration No Check";
      CustomerRecRef@1004 : RecordRef;
    BEGIN
      OnBeforeCreateCustomerFromTemplate(NewMode);

      if NewMode then begin
        if MiniCustomerTemplate.NewCustomerFromTemplate(Customer) then begin
          if VATRegNoSrvConfig.VATRegNoSrvIsEnabled then
            if Customer."Validate EU Vat Reg. No." then begin
              EUVATRegistrationNoCheck.SetRecordRef(Customer);
              COMMIT;
              EUVATRegistrationNoCheck.RUNMODAL;
              EUVATRegistrationNoCheck.GetRecordRef(CustomerRecRef);
              CustomerRecRef.SETTABLE(Customer);
            end;

          COPY(Customer);
          CurrPage.UPDATE;
        end;
        NewMode := false;
      end;
    END;

    [Integration]
    PROCEDURE SetCaption@17(VAR InText@1000 : Text);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnBeforeCreateCustomerFromTemplate@4(VAR NewMode@1000 : Boolean);
    BEGIN
    END;

    BEGIN
    END.
  }
}

