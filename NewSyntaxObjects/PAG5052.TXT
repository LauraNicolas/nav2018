OBJECT Page 5052 Contact List
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    Editable=false;
    CaptionML=ENU=Contact List;
    SourceTable=Contact;
    SourceTableView=SORTING("Company Name","Company No.",Type,Name);
    DataCaptionFields="Company No.";
    PageType=List;
    CardPageID="Contact Card";
    OnInit=BEGIN
             ActionVisible := CURRENTCLIENTTYPE = CLIENTTYPE::Windows;
           END;

    OnOpenPage=VAR
                 CRMIntegrationManagement@1000 : Codeunit "CRM Integration Management";
               BEGIN
                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;
               END;

    OnAfterGetRecord=VAR
                       CRMCouplingManagement@1001 : Codeunit "CRM Coupling Management";
                     BEGIN
                       EnableFields;
                       StyleIsStrong := Type = Type::Company;

                       if CRMIntegrationEnabled then
                         CRMIsCoupledToRecord := CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID);
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      Name=ActionContainer1900000003;
                      ActionContainerType=RelatedInformation }
      { 29      ;1   ;ActionGroup;
                      Name=C&ontact;
                      CaptionML=ENU=C&ontact;
                      Image=ContactPerson }
      { 34      ;2   ;ActionGroup;
                      Name=Comp&any;
                      CaptionML=ENU=Comp&any;
                      Enabled=CompanyGroupEnabled;
                      Image=Company }
      { 35      ;3   ;Action    ;
                      Name=Business Relations;
                      CaptionML=ENU=Business Relations;
                      ToolTipML=ENU=View or edit the contact's business relations, such as customers, vendors, banks, lawyers, consultants, competitors, and so on.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page "Contact Business Relations";
                      RunPageLink="Contact No."=FIELD("Company No.");
                      Image=BusinessRelation }
      { 36      ;3   ;Action    ;
                      Name=Industry Groups;
                      CaptionML=ENU=Industry Groups;
                      ToolTipML=ENU=View or edit the industry groups, such as Retail or Automobile, that the contact belongs to.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page "Contact Industry Groups";
                      RunPageLink="Contact No."=FIELD("Company No.");
                      Image=IndustryGroups }
      { 37      ;3   ;Action    ;
                      Name=Web Sources;
                      CaptionML=ENU=Web Sources;
                      ToolTipML=ENU=View a list of the web sites with information about the contacts.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page "Contact Web Sources";
                      RunPageLink="Contact No."=FIELD("Company No.");
                      Image=Web }
      { 38      ;2   ;ActionGroup;
                      Name=P&erson;
                      CaptionML=ENU=P&erson;
                      Enabled=PersonGroupEnabled;
                      Image=User }
      { 39      ;3   ;Action    ;
                      Name=Job Responsibilities;
                      CaptionML=ENU=Job Responsibilities;
                      ToolTipML=ENU=View or edit the contact's job responsibilities.;
                      ApplicationArea=#RelationshipMgmt;
                      Image=Job;
                      OnAction=VAR
                                 ContJobResp@1001 : Record "Contact Job Responsibility";
                               BEGIN
                                 TESTFIELD(Type,Type::Person);
                                 ContJobResp.SETRANGE("Contact No.","No.");
                                 PAGE.RUNMODAL(PAGE::"Contact Job Responsibilities",ContJobResp);
                               END;
                                }
      { 41      ;2   ;Action    ;
                      Name=Pro&files;
                      CaptionML=ENU=Pro&files;
                      ToolTipML=ENU=Open the Profile Questionnaires window.;
                      ApplicationArea=#RelationshipMgmt;
                      Image=Answers;
                      OnAction=VAR
                                 ProfileManagement@1001 : Codeunit ProfileManagement;
                               BEGIN
                                 ProfileManagement.ShowContactQuestionnaireCard(Rec,'',0);
                               END;
                                }
      { 43      ;2   ;Action    ;
                      Name=&Picture;
                      CaptionML=ENU=&Picture;
                      ToolTipML=ENU=View or add a picture of the contact person or, for example, the company's logo.;
                      ApplicationArea=#Suite,#RelationshipMgmt;
                      RunObject=Page "Contact Picture";
                      RunPageLink="No."=FIELD("No.");
                      Visible=ActionVisible;
                      Image=Picture }
      { 44      ;2   ;Action    ;
                      Name=Co&mments;
                      CaptionML=ENU=Co&mments;
                      ToolTipML=ENU=View or add comments for the record.;
                      ApplicationArea=#Advanced;
                      RunObject=Page "Rlshp. Mgt. Comment Sheet";
                      RunPageLink="Table Name"=CONST(Contact),
                                  "No."=FIELD("No."),
                                  "Sub No."=CONST(0);
                      Image=ViewComments }
      { 45      ;2   ;ActionGroup;
                      Name=Alternati&ve Address;
                      CaptionML=ENU=Alternati&ve Address;
                      Image=Addresses }
      { 46      ;3   ;Action    ;
                      Name=Card;
                      CaptionML=ENU=Card;
                      ToolTipML=ENU=View or change detailed information about the contact.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Contact Alt. Address List";
                      RunPageLink="Contact No."=FIELD("No.");
                      Image=EditLines }
      { 47      ;3   ;Action    ;
                      Name=Date Ranges;
                      CaptionML=ENU=Date Ranges;
                      ToolTipML=ENU=Specify date ranges that apply to the contact's alternate address.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Contact Alt. Addr. Date Ranges";
                      RunPageLink="Contact No."=FIELD("No.");
                      Image=DateRange }
      { 25      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=ENU=Dynamics 365 for Sales;
                      Visible=CRMIntegrationEnabled }
      { 23      ;2   ;Action    ;
                      Name=CRMGotoContact;
                      CaptionML=ENU=Contact;
                      ToolTipML=ENU=Open the coupled Dynamics 365 for Sales contact.;
                      ApplicationArea=#Suite;
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=CoupledContactPerson;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit "CRM Integration Management";
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 27      ;2   ;Action    ;
                      Name=CRMSynchronizeNow;
                      AccessByPermission=TableData "CRM Integration Record"=IM;
                      CaptionML=ENU=Synchronize;
                      ToolTipML=ENU=Send or get updated data to or from Dynamics 365 for Sales.;
                      ApplicationArea=#Suite;
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=Refresh;
                      OnAction=VAR
                                 Contact@1000 : Record Contact;
                                 CRMIntegrationManagement@1001 : Codeunit "CRM Integration Management";
                                 ContactRecordRef@1002 : RecordRef;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Contact);
                                 Contact.NEXT;

                                 if Contact.COUNT = 1 then
                                   CRMIntegrationManagement.UpdateOneNow(Contact.RECORDID)
                                 else begin
                                   ContactRecordRef.GETTABLE(Contact);
                                   CRMIntegrationManagement.UpdateMultipleNow(ContactRecordRef);
                                 end
                               END;
                                }
      { 26      ;2   ;ActionGroup;
                      Name=Coupling;
                      CaptionML=[@@@=Coupling is a noun;
                                 ENU=Coupling];
                      ToolTipML=ENU=Create, change, or delete a coupling between the Microsoft Dynamics NAV record and a Dynamics 365 for Sales record.;
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=LinkAccount }
      { 21      ;3   ;Action    ;
                      Name=ManageCRMCoupling;
                      AccessByPermission=TableData "CRM Integration Record"=IM;
                      CaptionML=ENU=Set Up Coupling;
                      ToolTipML=ENU=Create or modify the coupling to a Dynamics 365 for Sales contact.;
                      ApplicationArea=#Suite;
                      Image=LinkAccount;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit "CRM Integration Management";
                               BEGIN
                                 CRMIntegrationManagement.DefineCoupling(RECORDID);
                               END;
                                }
      { 19      ;3   ;Action    ;
                      Name=DeleteCRMCoupling;
                      AccessByPermission=TableData "CRM Integration Record"=IM;
                      CaptionML=ENU=Delete Coupling;
                      ToolTipML=ENU=Delete the coupling to a Dynamics 365 for Sales contact.;
                      ApplicationArea=#Suite;
                      Enabled=CRMIsCoupledToRecord;
                      Image=UnLinkAccount;
                      OnAction=VAR
                                 CRMCouplingManagement@1000 : Codeunit "CRM Coupling Management";
                               BEGIN
                                 CRMCouplingManagement.RemoveCoupling(RECORDID);
                               END;
                                }
      { 17      ;2   ;ActionGroup;
                      Name=Create;
                      CaptionML=ENU=Create;
                      Image=NewCustomer }
      { 15      ;3   ;Action    ;
                      Name=CreateInCRM;
                      CaptionML=ENU=Create Contact in Dynamics 365 for Sales;
                      ToolTipML=ENU=Create a contact in Dynamics 365 for Sales that is linked to a contact in your company.;
                      ApplicationArea=#Suite;
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=NewCustomer;
                      OnAction=VAR
                                 Contact@1001 : Record Contact;
                                 CRMIntegrationManagement@1000 : Codeunit "CRM Integration Management";
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Contact);
                                 CRMIntegrationManagement.CreateNewRecordsInCRM(Contact);
                               END;
                                }
      { 13      ;3   ;Action    ;
                      Name=CreateFromCRM;
                      CaptionML=ENU=Create Contact in Dynamics NAV;
                      ToolTipML=ENU=Create a contact here in your company that is linked to the Dynamics 365 for Sales contact.;
                      ApplicationArea=#Suite;
                      Image=NewCustomer;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit "CRM Integration Management";
                               BEGIN
                                 CRMIntegrationManagement.CreateNewContactFromCRM;
                               END;
                                }
      { 52      ;2   ;Action    ;
                      Name=ShowLog;
                      CaptionML=ENU=Synchronization Log;
                      ToolTipML=ENU=View integration synchronization jobs for the contact table.;
                      ApplicationArea=#Suite;
                      Image=Log;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit "CRM Integration Management";
                               BEGIN
                                 CRMIntegrationManagement.ShowLog(RECORDID);
                               END;
                                }
      { 5       ;1   ;ActionGroup;
                      Name=Related Information;
                      CaptionML=ENU=Related Information;
                      Image=Users }
      { 33      ;2   ;Action    ;
                      Name=Relate&d Contacts;
                      CaptionML=ENU=Relate&d Contacts;
                      ToolTipML=ENU=View a list of all contacts.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Contact List";
                      RunPageLink="Company No."=FIELD("Company No.");
                      Image=Users }
      { 55      ;2   ;Action    ;
                      Name=Segmen&ts;
                      CaptionML=ENU=Segmen&ts;
                      ToolTipML=ENU=View the segments that are related to the contact.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page "Contact Segment List";
                      RunPageView=SORTING("Contact No.","Segment No.");
                      RunPageLink="Contact Company No."=FIELD("Company No."),
                                  "Contact No."=FILTER(<>''),
                                  "Contact No."=FIELD(FILTER("Lookup Contact No."));
                      Image=Segment }
      { 40      ;2   ;Action    ;
                      Name=Mailing &Groups;
                      CaptionML=ENU=Mailing &Groups;
                      ToolTipML=ENU=View or edit the mailing groups that the contact is assigned to, for example, for sending price lists or Christmas cards.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page "Contact Mailing Groups";
                      RunPageLink="Contact No."=FIELD("No.");
                      Image=DistributionGroup }
      { 53      ;2   ;Action    ;
                      Name=C&ustomer/Vendor/Bank Acc.;
                      CaptionML=ENU=C&ustomer/Vendor/Bank Acc.;
                      ToolTipML=ENU=View the related customer, vendor, or bank account that is associated with the current record.;
                      ApplicationArea=#Basic,#Suite;
                      Image=ContactReference;
                      OnAction=BEGIN
                                 ShowCustVendBank;
                               END;
                                }
      { 7       ;1   ;ActionGroup;
                      Name=Tasks;
                      CaptionML=ENU=Tasks;
                      Image=Task }
      { 50      ;2   ;Action    ;
                      Name=T&asks;
                      CaptionML=ENU=T&asks;
                      ToolTipML=ENU=View all marketing tasks that involve the contact person.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page "Task List";
                      RunPageView=SORTING("Contact Company No.","Contact No.");
                      RunPageLink="Contact Company No."=FIELD("Company No."),
                                  "Contact No."=FIELD(FILTER("Lookup Contact No.")),
                                  "System To-do Type"=FILTER("Contact Attendee");
                      Image=TaskList }
      { 3       ;2   ;Action    ;
                      Name=Open Oppo&rtunities;
                      CaptionML=ENU=Open Oppo&rtunities;
                      ToolTipML=ENU=View the open sales opportunities that are handled by salespeople for the contact. Opportunities must involve a contact and can be linked to campaigns.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page "Opportunity List";
                      RunPageView=SORTING("Contact Company No.","Contact No.");
                      RunPageLink="Contact Company No."=FIELD("Company No."),
                                  "Contact No."=FILTER(<>''),
                                  "Contact No."=FIELD(FILTER("Lookup Contact No.")),
                                  Status=FILTER("Not Started"|"In Progress");
                      Promoted=true;
                      Image=OpportunityList;
                      PromotedCategory=Process;
                      Scope=Repeater }
      { 76      ;2   ;Action    ;
                      Name=Postponed &Interactions;
                      CaptionML=ENU=Postponed &Interactions;
                      ToolTipML=ENU=View postponed interactions for the contact.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page "Postponed Interactions";
                      RunPageView=SORTING("Contact Company No.","Contact No.");
                      RunPageLink="Contact Company No."=FIELD("Company No."),
                                  "Contact No."=FILTER(<>''),
                                  "Contact No."=FIELD(FILTER("Lookup Contact No."));
                      Image=PostponedInteractions }
      { 9       ;1   ;ActionGroup;
                      Name=Documents;
                      CaptionML=ENU=Documents;
                      Image=Documents }
      { 68      ;2   ;Action    ;
                      Name=ShowSalesQuotes;
                      CaptionML=ENU=Sales &Quotes;
                      ToolTipML=ENU=View sales quotes that exist for the contact.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page "Sales Quotes";
                      RunPageView=SORTING("Document Type","Sell-to Contact No.");
                      RunPageLink="Sell-to Contact No."=FIELD("No.");
                      Image=Quote }
      { 11      ;1   ;ActionGroup;
                      Name=History;
                      CaptionML=ENU=History;
                      Image=History }
      { 67      ;2   ;Action    ;
                      Name=Closed Oppo&rtunities;
                      CaptionML=ENU=Closed Oppo&rtunities;
                      ToolTipML=ENU=View the closed sales opportunities that are handled by salespeople for the contact. Opportunities must involve a contact and can be linked to campaigns.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page "Opportunity List";
                      RunPageView=SORTING("Contact Company No.","Contact No.");
                      RunPageLink="Contact Company No."=FIELD("Company No."),
                                  "Contact No."=FILTER(<>''),
                                  "Contact No."=FIELD(FILTER("Lookup Contact No.")),
                                  Status=FILTER(Won|Lost);
                      Image=OpportunityList }
      { 49      ;2   ;Action    ;
                      Name=Interaction Log E&ntries;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=Interaction Log E&ntries;
                      ToolTipML=ENU=View a list of the interactions that you have logged, for example, when you create an interaction, print a cover sheet, a sales order, and so on.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page "Interaction Log Entries";
                      RunPageView=SORTING("Contact Company No.","Contact No.");
                      RunPageLink="Contact Company No."=FIELD("Company No."),
                                  "Contact No."=FILTER(<>''),
                                  "Contact No."=FIELD(FILTER("Lookup Contact No."));
                      Image=InteractionLog }
      { 42      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=ENU=Statistics;
                      ToolTipML=ENU=View statistical information, such as the value of posted entries, for the record.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page "Contact Statistics";
                      RunPageLink="No."=FIELD("No.");
                      Promoted=true;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      Name=ActionContainer1900000004;
                      ActionContainerType=ActionItems }
      { 30      ;1   ;ActionGroup;
                      Name=F&unctions;
                      CaptionML=ENU=F&unctions;
                      Image=Action }
      { 54      ;2   ;Action    ;
                      Name=MakePhoneCall;
                      CaptionML=ENU=Make &Phone Call;
                      ToolTipML=ENU=Call the selected contact.;
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=true;
                      Image=Calls;
                      PromotedCategory=Process;
                      Scope=Repeater;
                      OnAction=VAR
                                 TAPIManagement@1001 : Codeunit TAPIManagement;
                               BEGIN
                                 TAPIManagement.DialContCustVendBank(DATABASE::Contact,"No.",GetDefaultPhoneNo,'');
                               END;
                                }
      { 56      ;2   ;Action    ;
                      Name=Launch &Web Source;
                      CaptionML=ENU=Launch &Web Source;
                      ToolTipML=ENU=Search for information about the contact online.;
                      ApplicationArea=#RelationshipMgmt;
                      Visible=ActionVisible;
                      Image=LaunchWeb;
                      OnAction=VAR
                                 ContactWebSource@1001 : Record "Contact Web Source";
                               BEGIN
                                 ContactWebSource.SETRANGE("Contact No.","Company No.");
                                 if PAGE.RUNMODAL(PAGE::"Web Source Launch",ContactWebSource) = ACTION::LookupOK then
                                   ContactWebSource.Launch;
                               END;
                                }
      { 58      ;2   ;ActionGroup;
                      Name=Create as;
                      CaptionML=ENU=Create as;
                      Visible=ActionVisible;
                      Image=CustomerContact }
      { 59      ;3   ;Action    ;
                      Name=Customer;
                      CaptionML=ENU=Customer;
                      ToolTipML=ENU=Create the contact as a customer.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Customer;
                      OnAction=BEGIN
                                 CreateCustomer(ChooseCustomerTemplate);
                               END;
                                }
      { 60      ;3   ;Action    ;
                      Name=Vendor;
                      CaptionML=ENU=Vendor;
                      ToolTipML=ENU=Create the contact as a vendor.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Vendor;
                      OnAction=BEGIN
                                 CreateVendor;
                               END;
                                }
      { 61      ;3   ;Action    ;
                      Name=Bank;
                      AccessByPermission=TableData "Bank Account"=R;
                      CaptionML=ENU=Bank;
                      ToolTipML=ENU=Create the contact as a bank.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Bank;
                      OnAction=BEGIN
                                 CreateBankAccount;
                               END;
                                }
      { 62      ;2   ;ActionGroup;
                      Name=Link with existing;
                      CaptionML=ENU=Link with existing;
                      Image=Links }
      { 63      ;3   ;Action    ;
                      Name=Action63;
                      CaptionML=ENU=Customer;
                      ToolTipML=ENU=Link the contact to an existing customer.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Customer;
                      OnAction=BEGIN
                                 CreateCustomerLink;
                               END;
                                }
      { 64      ;3   ;Action    ;
                      Name=Action64;
                      CaptionML=ENU=Vendor;
                      ToolTipML=ENU=Link the contact to an existing vendor.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Vendor;
                      OnAction=BEGIN
                                 CreateVendorLink;
                               END;
                                }
      { 65      ;3   ;Action    ;
                      Name=Action65;
                      AccessByPermission=TableData "Bank Account"=R;
                      CaptionML=ENU=Bank;
                      ToolTipML=ENU=Link the contact to an existing bank.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Bank;
                      OnAction=BEGIN
                                 CreateBankAccountLink;
                               END;
                                }
      { 31      ;1   ;Action    ;
                      Name=Create &Interaction;
                      AccessByPermission=TableData Attachment=R;
                      CaptionML=ENU=Create &Interaction;
                      ToolTipML=ENU=Create an interaction with a specified contact.;
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=true;
                      Image=CreateInteraction;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInteraction;
                               END;
                                }
      { 51      ;1   ;Action    ;
                      Name=Create Opportunity;
                      CaptionML=ENU=Create Opportunity;
                      ToolTipML=ENU=Register a sales opportunity for the contact.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page "Opportunity Card";
                      RunPageLink="Contact No."=FIELD("No."),
                                  "Contact Company No."=FIELD("Company No.");
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=NewOpportunity;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 28      ;1   ;Action    ;
                      Name=SyncWithExchange;
                      CaptionML=ENU=Sync with Office 365;
                      ToolTipML=ENU=Synchronize with Office 365 based on last sync date and last modified date. All changes in Office 365 since the last sync date will be synchronized back.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Refresh;
                      OnAction=BEGIN
                                 SyncExchangeContacts(false);
                               END;
                                }
      { 32      ;1   ;Action    ;
                      Name=FullSyncWithExchange;
                      CaptionML=ENU=Full Sync with Office 365;
                      ToolTipML=ENU=Synchronize, but ignore the last synchronized and last modified dates. All changes will be pushed to Office 365 and take all contacts from your Exchange folder and sync back.;
                      ApplicationArea=#Basic,#Suite;
                      Image=RefreshLines;
                      OnAction=BEGIN
                                 SyncExchangeContacts(true);
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      Name=ActionContainer1900000005;
                      ActionContainerType=NewDocumentItems }
      { 1900900305;1 ;Action    ;
                      Name=NewSalesQuote;
                      CaptionML=ENU=New Sales Quote;
                      ToolTipML=ENU=Offer items or services to a customer.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      Image=NewSalesQuote;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CreateSalesQuoteFromContact;
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      Name=ActionContainer1900000006;
                      ActionContainerType=Reports }
      { 1904205506;1 ;Action    ;
                      Name=Contact Labels;
                      CaptionML=ENU=Contact Labels;
                      ToolTipML=ENU=View mailing labels with names and addresses of your contacts. For example, you can use the report to review contact information before you send sales and marketing campaign letters.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Report "Contact - Labels";
                      Image=Report }
      { 1905922906;1 ;Action    ;
                      Name=Questionnaire Handout;
                      CaptionML=ENU=Questionnaire Handout;
                      ToolTipML=ENU=View your profile questionnaire for the contact. You can print this report to have a printed copy of the questions that are within the profile questionnaire.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Report "Questionnaire - Handouts";
                      Image=Report }
      { 1900800206;1 ;Action    ;
                      Name=Sales Cycle Analysis;
                      CaptionML=ENU=Sales Cycle Analysis;
                      ToolTipML=ENU=View information about your sales cycles. The report includes details about the sales cycle, such as the number of opportunities currently at that stage, the estimated and calculated current values of opportunities created using the sales cycle, and so on.;
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Report "Sales Cycle - Analysis";
                      Image=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                Name=Container1900000001;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Name=Group1;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                Name=No.;
                ToolTipML=ENU=Specifies the contact number.;
                ApplicationArea=#All;
                SourceExpr="No.";
                Style=Strong;
                StyleExpr=StyleIsStrong;
                ImplicitType=Code20 }

    { 4   ;2   ;Field     ;
                Name=Name;
                ToolTipML=ENU=Specifies the name of the contact. If the contact is a person, you can click the field to see the Name Details window.;
                ApplicationArea=#All;
                SourceExpr=Name;
                Style=Strong;
                StyleExpr=StyleIsStrong;
                ImplicitType=Text50 }

    { 66  ;2   ;Field     ;
                Name=Company Name;
                ToolTipML=ENU=Specifies the name of the company. If the contact is a person, Specifies the name of the company for which this contact works. This field is not editable.;
                ApplicationArea=#All;
                SourceExpr="Company Name";
                Visible=FALSE;
                ImplicitType=Text50 }

    { 6   ;2   ;Field     ;
                Name=Post Code;
                ToolTipML=ENU=Specifies the post code for the contact.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Post Code";
                Visible=FALSE;
                ImplicitType=Code20 }

    { 8   ;2   ;Field     ;
                Name=Country/Region Code;
                ToolTipML=ENU=Specifies the country/region code for the contact.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Country/Region Code";
                Visible=FALSE;
                ImplicitType=Code10 }

    { 10  ;2   ;Field     ;
                Name=Phone No.;
                ToolTipML=ENU=Specifies the contact's phone number.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Phone No.";
                ImplicitType=Text30 }

    { 24  ;2   ;Field     ;
                Name=Mobile Phone No.;
                ToolTipML=ENU=Specifies the contact's mobile telephone number.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Mobile Phone No.";
                Visible=FALSE;
                ImplicitType=Text30 }

    { 48  ;2   ;Field     ;
                Name=E-Mail;
                ExtendedDatatype=E-Mail;
                ToolTipML=ENU=Specifies the contact's email.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="E-Mail";
                ImplicitType=Text80 }

    { 12  ;2   ;Field     ;
                Name=Fax No.;
                ToolTipML=ENU=Specifies the contact's fax number.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Fax No.";
                Visible=FALSE;
                ImplicitType=Text30 }

    { 14  ;2   ;Field     ;
                Name=Salesperson Code;
                ToolTipML=ENU=Specifies the code of the salesperson who normally handles this contact.;
                ApplicationArea=#Suite;
                SourceExpr="Salesperson Code";
                ImplicitType=Code20 }

    { 16  ;2   ;Field     ;
                Name=Territory Code;
                ToolTipML=ENU=Specifies the territory code for the contact.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Territory Code";
                ImplicitType=Code10 }

    { 18  ;2   ;Field     ;
                Name=Currency Code;
                ToolTipML=ENU=Specifies the currency code for the contact.;
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Visible=FALSE;
                ImplicitType=Code10 }

    { 20  ;2   ;Field     ;
                Name=Language Code;
                ToolTipML=ENU=Specifies the language code for the contact.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Language Code";
                Visible=FALSE;
                ImplicitType=Code10 }

    { 22  ;2   ;Field     ;
                Name=Search Name;
                ToolTipML=ENU=Specifies the search name of the contact. You can use this field to search for a contact when you cannot remember the contact number.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Search Name";
                Visible=FALSE;
                ImplicitType=Code50 }

    { 1900000007;0;Container;
                Name=Container1900000007;
                ContainerType=FactBoxArea }

    { 128 ;1   ;Part      ;
                Name=Part128;
                ApplicationArea=#RelationshipMgmt;
                SubPageLink="No."=FIELD("No."),
                            "Date Filter"=FIELD("Date Filter");
                PagePartID="Contact Statistics FactBox";
                PartType=Page }

    { 1900383207;1;Part   ;
                Name=Part1900383207;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Name=Part1905767507;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      StyleIsStrong@1001 : Boolean INDATASET;
      CompanyGroupEnabled@1004 : Boolean;
      PersonGroupEnabled@1003 : Boolean;
      CRMIntegrationEnabled@1006 : Boolean;
      CRMIsCoupledToRecord@1005 : Boolean;
      ActionVisible@1007 : Boolean;

    LOCAL PROCEDURE EnableFields@1();
    BEGIN
      CompanyGroupEnabled := Type = Type::Company;
      PersonGroupEnabled := Type = Type::Person;
    END;

    [Internal]
    PROCEDURE SyncExchangeContacts@2(FullSync@1001 : Boolean);
    VAR
      ExchangeSync@1002 : Record "Exchange Sync";
      O365SyncManagement@1000 : Codeunit "O365 Sync. Management";
      ExchangeContactSync@1003 : Codeunit "Exchange Contact Sync.";
    BEGIN
      if O365SyncManagement.IsO365Setup(true) then
        if ExchangeSync.GET(USERID) then begin
          ExchangeContactSync.GetRequestParameters(ExchangeSync);
          O365SyncManagement.SyncExchangeContacts(ExchangeSync,FullSync);
        end;
    END;

    BEGIN
    END.
  }
}

