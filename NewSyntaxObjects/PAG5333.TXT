OBJECT Page 5333 CRM Skipped Records
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    Editable=false;
    CaptionML=ENU=CRM Skipped Records;
    SourceTable="CRM Integration Record";
    SourceTableView=SORTING(Skipped,"Table ID")
                    WHERE(Skipped=CONST(true));
    PageType=List;
    PromotedActionCategoriesML=ENU=New,Process,Report,Synchronization;
    ActionList=ACTIONS
    {
      { 4       ;    ;ActionContainer;
                      Name=ActionContainer4;
                      ActionContainerType=ActionItems }
      { 6       ;1   ;Action    ;
                      Name=Restore;
                      AccessByPermission=TableData "CRM Integration Record"=IM;
                      CaptionML=ENU=Restore;
                      ToolTipML=ENU=Restore selected records for further Dynamics 365 for Sales synchronization.;
                      ApplicationArea=#Suite;
                      Promoted=true;
                      Image=Restore;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 CRMIntegrationManagement@1001 : Codeunit "CRM Integration Management";
                               BEGIN
                                 CRMIntegrationManagement.UpdateSkippedNow(Rec);
                               END;
                                }
      { 5       ;1   ;Action    ;
                      Name=ShowLog;
                      CaptionML=ENU=Synchronization Log;
                      ToolTipML=ENU=View integration synchronization jobs for the skipped record.;
                      ApplicationArea=#Suite;
                      Promoted=true;
                      Image=Log;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 IntegrationRecord@1001 : Record "Integration Record";
                                 CRMIntegrationManagement@1000 : Codeunit "CRM Integration Management";
                               BEGIN
                                 IntegrationRecord.FindByIntegrationId("Integration ID");
                                 CRMIntegrationManagement.ShowLog(IntegrationRecord."Record ID");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                Name=Container1;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                Name=TableName;
                CaptionML=ENU=Table Name;
                ToolTipML=ENU=Specifies the name of the table where a record failed to synchronize.;
                ApplicationArea=#Suite;
                SourceExpr=GetTableCaption }

    { 8   ;2   ;Field     ;
                Name=Description;
                CaptionML=ENU=Description;
                ToolTipML=ENU=Specifies the primary key of the record that failed to synchronize.;
                ApplicationArea=#Suite;
                SourceExpr=GetRecDescription;
                ImplicitType=Text }

    { 7   ;2   ;Field     ;
                Name=LatestError;
                CaptionML=ENU=Error;
                ToolTipML=ENU=Specifies the synchronization error message.;
                ApplicationArea=#Suite;
                SourceExpr=GetLatestError;
                ImplicitType=Text }

  }
  CODE
  {

    LOCAL PROCEDURE GetTableCaption@3() : Text;
    VAR
      AllObjWithCaption@1000 : Record AllObjWithCaption;
    BEGIN
      if "Table ID" = 0 then
        exit('');
      if AllObjWithCaption.GET(AllObjWithCaption."Object Type"::Table,"Table ID") then
        exit(AllObjWithCaption."Object Caption");
    END;

    BEGIN
    END.
  }
}

