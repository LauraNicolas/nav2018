OBJECT Codeunit 6110 GL Acc. Data Migration Facade
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    TableNo="Data Migration Parameters";
    OnRun=BEGIN
            FINDSET;
            repeat
              OnMigrateGlAccount("Staging Table RecId To Process");
              GLAccountIsSet := false;
            until NEXT = 0;
          END;

  }
  CODE
  {
    VAR
      GlobalGLAccount@1001 : Record "G/L Account";
      GLAccountIsSet@1000 : Boolean;
      InternalGLAccountNotSetErr@1002 : TextConst 'ENU=Internal G/L Account is not set. Create it first.';

    [Integration(TRUE)]
    LOCAL PROCEDURE OnMigrateGlAccount@1(RecordIdToMigrate@1000 : RecordID);
    BEGIN
    END;

    [External]
    PROCEDURE SetGlobalGLAccount@40(GLAccountNo@1000 : Code[20]) : Boolean;
    BEGIN
      GLAccountIsSet := GlobalGLAccount.GET(GLAccountNo);
      exit(GLAccountIsSet);
    END;

    [External]
    PROCEDURE ModifyGLAccount@2(RunTrigger@1000 : Boolean);
    BEGIN
      if not GLAccountIsSet then
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.MODIFY(RunTrigger);
    END;

    [External]
    PROCEDURE CreateGLAccountIfNeeded@13(AccountNoToSet@1000 : Code[20];AccountNameToSet@1003 : Text[50];AccountTypeToSet@1002 : 'Posting,Heading,Total,"Begin-Total","End-Total"') : Boolean;
    VAR
      GLAccount@1001 : Record "G/L Account";
    BEGIN
      if GLAccount.GET(AccountNoToSet) then begin
        GlobalGLAccount := GLAccount;
        GLAccountIsSet := true;
        exit;
      end;

      GLAccount.INIT;

      GLAccount.VALIDATE("No.",AccountNoToSet);
      GLAccount.VALIDATE(Name,AccountNameToSet);
      GLAccount.VALIDATE("Account Type",AccountTypeToSet);

      GLAccount.INSERT(true);

      GlobalGLAccount := GLAccount;
      GLAccountIsSet := true;
      exit(true);
    END;

    [External]
    PROCEDURE SetIncomeBalanceType@16(IncomeBalanceTypeToSet@1000 : '"Income Statement","Balance Sheet"');
    BEGIN
      if not GLAccountIsSet then
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE("Income/Balance",IncomeBalanceTypeToSet);
    END;

    [External]
    PROCEDURE SetTotaling@18(TotalingToSet@1000 : Text[250]);
    BEGIN
      if not GLAccountIsSet then
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE(Totaling,TotalingToSet);
    END;

    [External]
    PROCEDURE SetDebitCreditType@19(DebitCreditTypeToSet@1000 : 'Both,Debit,Credit');
    BEGIN
      if not GLAccountIsSet then
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE("Debit/Credit",DebitCreditTypeToSet);
    END;

    [External]
    PROCEDURE SetExchangeRateAdjustmentType@22(ExchangeRateAdjustmentTypeToSet@1000 : '"No Adjustment","Adjust Amount","Adjust Additional-Currency Amount"');
    BEGIN
      if not GLAccountIsSet then
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE("Exchange Rate Adjustment",ExchangeRateAdjustmentTypeToSet);
    END;

    [External]
    PROCEDURE SetDirectPosting@25(DirectPostingToSet@1000 : Boolean);
    BEGIN
      if not GLAccountIsSet then
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE("Direct Posting",DirectPostingToSet);
    END;

    [External]
    PROCEDURE SetBlocked@26(BlockedToSet@1000 : Boolean);
    BEGIN
      if not GLAccountIsSet then
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE(Blocked,BlockedToSet);
    END;

    [External]
    PROCEDURE SetLastModifiedDateTime@27(LastModifiedDateTimeToSet@1000 : DateTime);
    BEGIN
      if not GLAccountIsSet then
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE("Last Modified Date Time",LastModifiedDateTimeToSet);
    END;

    [External]
    PROCEDURE SetLastDateModified@28(LastDateModifiedToSet@1000 : Date);
    BEGIN
      if not GLAccountIsSet then
        ERROR(InternalGLAccountNotSetErr);

      GlobalGLAccount.VALIDATE("Last Date Modified",LastDateModifiedToSet);
    END;

    BEGIN
    END.
  }
}

