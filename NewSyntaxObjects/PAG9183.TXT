OBJECT Page 9183 Generic Chart Setup
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Generic Chart Setup;
    SourceTable=Chart;
    PageType=Card;
    OnAfterGetRecord=BEGIN
                       SetFieldValues;
                       EnableControls;
                     END;

    ActionList=ACTIONS
    {
      { 17      ;    ;ActionContainer;
                      Name=ActionContainer17;
                      ActionContainerType=ActionItems }
      { 38      ;1   ;Action    ;
                      Name=Import Chart;
                      Ellipsis=true;
                      CaptionML=ENU=Import Chart;
                      ToolTipML=ENU=Import a generic chart in XML format.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ImportChartDefinition;
                               END;
                                }
      { 37      ;1   ;Action    ;
                      Name=E&xport Chart;
                      Ellipsis=true;
                      CaptionML=ENU=E&xport Chart;
                      ToolTipML=ENU=Export a generic chart in XML format. You can rename the file, modify the chart definition using an XML editor, and then import the new chart into another client.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ExportChartDefinition;
                               END;
                                }
      { 41      ;1   ;Action    ;
                      Name=Copy Chart;
                      Ellipsis=true;
                      CaptionML=ENU=Copy Chart;
                      ToolTipML=ENU=Copy an existing chart to create a new generic chart.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CopyGenericChart@1034 : Page "Copy Generic Chart";
                               BEGIN
                                 CopyGenericChart.SetSourceChart(Rec);
                                 CopyGenericChart.RUNMODAL;
                               END;
                                }
      { 14      ;    ;ActionContainer;
                      Name=Action;
                      CaptionML=ENU=Actions;
                      ActionContainerType=RelatedInformation }
      { 15      ;1   ;Action    ;
                      Name=Filters;
                      CaptionML=ENU=Filters;
                      ToolTipML=ENU=Filter on the generic charts.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=true;
                      PromotedIsBig=true;
                      Image=EditFilter;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowChartFiltersPage;
                                 CurrPage.UPDATE;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                Name=Container1;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=General;
                CaptionML=ENU=General;
                GroupType=Group }

    { 3   ;2   ;Field     ;
                Name=ID;
                ToolTipML=ENU=Specifies the unique ID of the chart.;
                ApplicationArea=#Basic,#Suite;
                NotBlank=true;
                SourceExpr=ID;
                ImplicitType=Code20 }

    { 4   ;2   ;Field     ;
                Name=Name;
                ToolTipML=ENU=Specifies the name of the chart.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Name;
                ImplicitType=Text30 }

    { 7   ;2   ;Field     ;
                Name=ChartExists;
                CaptionML=ENU=Chart Exists;
                ToolTipML=ENU="Specifies that one or more charts have been created from the generic chart. ";
                ApplicationArea=#Advanced;
                SourceExpr=BLOB.HASVALUE;
                Visible=FALSE }

    { 8   ;1   ;Group     ;
                Name=Data Source;
                CaptionML=ENU=Data Source;
                GroupType=Group }

    { 11  ;2   ;Field     ;
                Name=Source Type;
                CaptionML=ENU=Source Type;
                ToolTipML=ENU=Specifies the source type for the chart.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempGenericChartSetup."Source Type";
                OnValidate=VAR
                             CalledFrom@1001 : '"Source Type","Source ID"';
                           BEGIN
                             ResetFields(CalledFrom::"Source Type");
                             UpdateChartDefinition;
                             StoreTempXRecValues
                           END;

                OnLookup=VAR
                           CalledFrom@1002 : '"Source Type","Source ID"';
                         BEGIN
                           ResetFields(CalledFrom::"Source Type");
                           UpdateChartDefinition;
                           StoreTempXRecValues
                         END;
                          }

    { 9   ;2   ;Field     ;
                Name=Source ID;
                CaptionML=ENU=Source ID;
                ToolTipML=ENU=Specifies the source ID for the chart.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempGenericChartSetup."Source ID";
                OnValidate=VAR
                             GenericChartMgt@1000 : Codeunit "Generic Chart Mgt";
                             CalledFrom@1002 : '"Source Type","Source ID"';
                           BEGIN
                             ResetFields(CalledFrom::"Source ID");
                             GenericChartMgt.ValidateObjectID(
                               TempGenericChartSetup."Source Type",TempGenericChartSetup."Source ID",TempGenericChartSetup."Object Name");
                             UpdateChartDefinition;
                             StoreTempXRecValues
                           END;

                OnLookup=VAR
                           GenericChartMgt@1000 : Codeunit "Generic Chart Mgt";
                           CalledFrom@1003 : '"Source Type","Source ID"';
                         BEGIN
                           GenericChartMgt.CheckSourceTypeID(TempGenericChartSetup,false);
                           GenericChartMgt.LookUpObjectId(
                             TempGenericChartSetup."Source Type",TempGenericChartSetup."Source ID",TempGenericChartSetup."Object Name");
                           ResetFields(CalledFrom::"Source ID");
                           GenericChartMgt.ValidateObjectID(
                             TempGenericChartSetup."Source Type",TempGenericChartSetup."Source ID",TempGenericChartSetup."Object Name");
                           UpdateChartDefinition;
                           StoreTempXRecValues
                         END;
                          }

    { 10  ;2   ;Field     ;
                Name=Source Name;
                CaptionML=ENU=Source Name;
                ToolTipML=ENU=Specifies the source name for the chart.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempGenericChartSetup."Object Name";
                Editable=FALSE;
                OnValidate=BEGIN
                             UpdateChartDefinition;
                           END;
                            }

    { 43  ;2   ;Field     ;
                Name=Filters;
                CaptionML=ENU=Filters;
                ToolTipML=ENU=Specifies the field filters which delimit the field values that the chart is based on.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempGenericChartSetup."Filter Text";
                Editable=FALSE;
                OnAssistEdit=BEGIN
                               ShowChartFiltersPage;
                               CurrPage.UPDATE;
                             END;
                              }

    { 18  ;1   ;Group     ;
                Name=Measures (Y-Axis);
                CaptionML=ENU=Measures (Y-Axis);
                GroupType=Group;
                Layout=Rows }

    { 25  ;2   ;Group     ;
                Name=Group25;
                GroupType=GridLayout;
                Layout=Rows }

    { 19  ;3   ;Group     ;
                Name=Required Measure;
                CaptionML=ENU=Required Measure;
                GroupType=Group }

    { 20  ;4   ;Field     ;
                Name=RequiredMeasureColumn;
                CaptionML=ENU=Data Column;
                ToolTipML=ENU=Specifies the field or query column that the y-axis is based on. The list of values that appears when you choose Data Column field is filtered by the ID of the data source that you select on the Data Source FastTab.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=DataColumn[1];
                Enabled=DataColumn1Enabled;
                Editable=DataColumn1Enabled;
                RowSpan=1;
                ColumnSpan=1;
                OnValidate=BEGIN
                             ValidateDataColumn(1);
                           END;

                OnLookup=BEGIN
                           GenericChartMgt.RetrieveFieldColumn(TempGenericChartSetup,DummyInt,DataColumn[1],DummyCaption,2,false);
                           ValidateDataColumn(1);
                         END;
                          }

    { 21  ;4   ;Field     ;
                Name=RequiredMeasureAggregation;
                CaptionML=ENU=Aggregation;
                ToolTipML=ENU=Specifies how data on the y-axis is aggregated, such as by the sum or by the maximum values.;
                OptionCaptionML=ENU=None,Count,Sum,Min,Max,Avg;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Aggregation[1];
                RowSpan=1;
                ColumnSpan=1;
                OnValidate=BEGIN
                             CheckAggregation(1);
                             UpdateChartDefinition;
                           END;
                            }

    { 22  ;4   ;Field     ;
                Name=RequiredMeasureType;
                CaptionML=ENU=Graph Type;
                ToolTipML=ENU=Specifies how data is shown graphically in the chart, such as column, line, or pie.;
                OptionCaptionML=ENU=Column,Point,Line,ColumnStacked,ColumnStacked100,Area,AreaStacked,AreaStacked100,StepLine,Pie,Doughnut,Range,Radar,Funnel;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ChartType;
                OnValidate=BEGIN
                             UpdateChartDefinition;
                             EnableControls;
                           END;

                ImplicitType=Option }

    { 54  ;4   ;Field     ;
                Name=RequiredMeasureCaption;
                CaptionML=ENU=Data Point Label;
                ToolTipML=ENU=Specifies the text that describes the selected y-axis value in a tooltip when you hover over a data point. The data point label is shown in front of the data value.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MeasureCaption[1];
                Enabled=DataColumn1Enabled;
                Editable=DataColumn1Enabled;
                RowSpan=1;
                ColumnSpan=1;
                OnValidate=BEGIN
                             TempGenericChartCaptionsBuf.SetCaption(GenericChartMgt.RequiredMeasureCode,GenericChartMgt.GetUserLanguage,MeasureCaption[1]);
                             UpdateChartDefinition;
                           END;

                OnAssistEdit=BEGIN
                               MeasureCaption[1] := GenericChartMgt.TextMLAssistEdit(TempGenericChartCaptionsBuf,GenericChartMgt.RequiredMeasureCode);
                               UpdateChartDefinition;
                             END;
                              }

    { 23  ;3   ;Group     ;
                Name=Optional Measure 1;
                CaptionML=ENU=Optional Measure;
                GroupType=Group }

    { 24  ;4   ;Field     ;
                Name=OptionalMeasureColumn1;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=DataColumn[2];
                Enabled=OptionalMeasuresEnabled AND DataColumn2Enabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             ValidateDataColumn(2);
                           END;

                OnLookup=BEGIN
                           GenericChartMgt.RetrieveFieldColumn(TempGenericChartSetup,DummyInt,DataColumn[2],DummyCaption,2,false);
                           ValidateDataColumn(2);
                         END;

                ShowCaption=false }

    { 26  ;4   ;Field     ;
                Name=OptionalMeasureAggregation1;
                OptionCaptionML=ENU=None,Count,Sum,Min,Max,Avg;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Aggregation[2];
                Enabled=OptionalMeasuresEnabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             CheckAggregation(2);
                             UpdateChartDefinition;
                           END;

                ShowCaption=false }

    { 27  ;4   ;Field     ;
                Name=OptionalMeasureType1;
                OptionCaptionML=ENU=Column,Point,Line,ColumnStacked,ColumnStacked100,Area,AreaStacked,AreaStacked100,StepLine,,,Range;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ChartTypeReduced[2];
                Enabled=OptionalMeasuresEnabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             UpdateChartDefinition;
                             EnableControls;
                           END;

                ShowCaption=false }

    { 55  ;4   ;Field     ;
                Name=OptionalMeasureCaption1;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MeasureCaption[2];
                Enabled=OptionalMeasuresEnabled AND DataColumn2Enabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             TempGenericChartCaptionsBuf.SetCaption(GenericChartMgt.OptionalMeasure1Code,GenericChartMgt.GetUserLanguage,MeasureCaption[2]);
                             UpdateChartDefinition;
                           END;

                OnAssistEdit=BEGIN
                               MeasureCaption[2] := GenericChartMgt.TextMLAssistEdit(TempGenericChartCaptionsBuf,GenericChartMgt.OptionalMeasure1Code);
                               UpdateChartDefinition;
                             END;

                ShowCaption=false }

    { 28  ;3   ;Group     ;
                Name=Optional Measure 2;
                CaptionML=ENU=Optional Measure;
                GroupType=Group }

    { 29  ;4   ;Field     ;
                Name=OptionalMeasureColumn2;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=DataColumn[3];
                Enabled=OptionalMeasuresEnabled AND DataColumn3Enabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             ValidateDataColumn(3);
                           END;

                OnLookup=BEGIN
                           GenericChartMgt.RetrieveFieldColumn(TempGenericChartSetup,DummyInt,DataColumn[3],DummyCaption,2,false);
                           ValidateDataColumn(3);
                         END;

                ShowCaption=false }

    { 30  ;4   ;Field     ;
                Name=OptionalMeasureAggregation2;
                OptionCaptionML=ENU=None,Count,Sum,Min,Max,Avg;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Aggregation[3];
                Enabled=OptionalMeasuresEnabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             CheckAggregation(3);
                             UpdateChartDefinition;
                           END;

                ShowCaption=false }

    { 31  ;4   ;Field     ;
                Name=OptionalMeasureType2;
                OptionCaptionML=ENU=Column,Point,Line,ColumnStacked,ColumnStacked100,Area,AreaStacked,AreaStacked100,StepLine,,,Range;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ChartTypeReduced[3];
                Enabled=OptionalMeasuresEnabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             UpdateChartDefinition;
                             EnableControls;
                           END;

                ShowCaption=false }

    { 56  ;4   ;Field     ;
                Name=OptionalMeasureCaption2;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MeasureCaption[3];
                Enabled=OptionalMeasuresEnabled AND DataColumn3Enabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             TempGenericChartCaptionsBuf.SetCaption(GenericChartMgt.OptionalMeasure2Code,GenericChartMgt.GetUserLanguage,MeasureCaption[3]);
                             UpdateChartDefinition;
                           END;

                OnAssistEdit=BEGIN
                               MeasureCaption[3] := GenericChartMgt.TextMLAssistEdit(TempGenericChartCaptionsBuf,GenericChartMgt.OptionalMeasure2Code);
                               UpdateChartDefinition;
                             END;

                ShowCaption=false }

    { 32  ;3   ;Group     ;
                Name=Optional Measure 3;
                CaptionML=ENU=Optional Measure;
                GroupType=Group }

    { 33  ;4   ;Field     ;
                Name=OptionalMeasureColumn3;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=DataColumn[4];
                Enabled=OptionalMeasuresEnabled AND DataColumn4Enabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             ValidateDataColumn(4);
                           END;

                OnLookup=BEGIN
                           GenericChartMgt.RetrieveFieldColumn(TempGenericChartSetup,DummyInt,DataColumn[4],DummyCaption,2,false);
                           ValidateDataColumn(4);
                         END;

                ShowCaption=false }

    { 34  ;4   ;Field     ;
                Name=OptionalMeasureAggregation3;
                OptionCaptionML=ENU=None,Count,Sum,Min,Max,Avg;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Aggregation[4];
                Enabled=OptionalMeasuresEnabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             CheckAggregation(4);
                             UpdateChartDefinition;
                           END;

                ShowCaption=false }

    { 35  ;4   ;Field     ;
                Name=OptionalMeasureType3;
                OptionCaptionML=ENU=Column,Point,Line,ColumnStacked,ColumnStacked100,Area,AreaStacked,AreaStacked100,StepLine,,,Range;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ChartTypeReduced[4];
                Enabled=OptionalMeasuresEnabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             UpdateChartDefinition;
                             EnableControls;
                           END;

                ShowCaption=false }

    { 57  ;4   ;Field     ;
                Name=OptionalMeasureCaption3;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MeasureCaption[4];
                Enabled=OptionalMeasuresEnabled AND DataColumn4Enabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             TempGenericChartCaptionsBuf.SetCaption(GenericChartMgt.OptionalMeasure3Code,GenericChartMgt.GetUserLanguage,MeasureCaption[4]);
                             UpdateChartDefinition;
                           END;

                OnAssistEdit=BEGIN
                               MeasureCaption[4] := GenericChartMgt.TextMLAssistEdit(TempGenericChartCaptionsBuf,GenericChartMgt.OptionalMeasure3Code);
                               UpdateChartDefinition;
                             END;

                ShowCaption=false }

    { 47  ;3   ;Group     ;
                Name=Optional Measure 4;
                CaptionML=ENU=Optional Measure;
                GroupType=Group }

    { 46  ;4   ;Field     ;
                Name=OptionalMeasureColumn4;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=DataColumn[5];
                Enabled=OptionalMeasuresEnabled AND DataColumn5Enabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             ValidateDataColumn(5);
                           END;

                OnLookup=BEGIN
                           GenericChartMgt.RetrieveFieldColumn(TempGenericChartSetup,DummyInt,DataColumn[5],DummyCaption,2,false);
                           ValidateDataColumn(5);
                         END;

                ShowCaption=false }

    { 45  ;4   ;Field     ;
                Name=OptionalMeasureAggregation4;
                OptionCaptionML=ENU=None,Count,Sum,Min,Max,Avg;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Aggregation[5];
                Enabled=OptionalMeasuresEnabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             CheckAggregation(5);
                             UpdateChartDefinition;
                           END;

                ShowCaption=false }

    { 40  ;4   ;Field     ;
                Name=OptionalMeasureType4;
                OptionCaptionML=ENU=Column,Point,Line,ColumnStacked,ColumnStacked100,Area,AreaStacked,AreaStacked100,StepLine,,,Range;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ChartTypeReduced[5];
                Enabled=OptionalMeasuresEnabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             UpdateChartDefinition;
                             EnableControls;
                           END;

                ShowCaption=false }

    { 58  ;4   ;Field     ;
                Name=OptionalMeasureCaption4;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MeasureCaption[5];
                Enabled=OptionalMeasuresEnabled AND DataColumn5Enabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             TempGenericChartCaptionsBuf.SetCaption(GenericChartMgt.OptionalMeasure4Code,GenericChartMgt.GetUserLanguage,MeasureCaption[5]);
                             UpdateChartDefinition;
                           END;

                OnAssistEdit=BEGIN
                               MeasureCaption[5] := GenericChartMgt.TextMLAssistEdit(TempGenericChartCaptionsBuf,GenericChartMgt.OptionalMeasure4Code);
                               UpdateChartDefinition;
                             END;

                ShowCaption=false }

    { 51  ;3   ;Group     ;
                Name=Optional Measure 5;
                CaptionML=ENU=Optional Measure;
                GroupType=Group }

    { 50  ;4   ;Field     ;
                Name=OptionalMeasureColumn5;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=DataColumn[6];
                Enabled=OptionalMeasuresEnabled AND DataColumn6Enabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             ValidateDataColumn(6);
                           END;

                OnLookup=BEGIN
                           GenericChartMgt.RetrieveFieldColumn(TempGenericChartSetup,DummyInt,DataColumn[6],DummyCaption,2,false);
                           ValidateDataColumn(6);
                         END;

                ShowCaption=false }

    { 49  ;4   ;Field     ;
                Name=OptionalMeasureAggregation5;
                OptionCaptionML=ENU=None,Count,Sum,Min,Max,Avg;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Aggregation[6];
                Enabled=OptionalMeasuresEnabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             CheckAggregation(6);
                             UpdateChartDefinition;
                           END;

                ShowCaption=false }

    { 48  ;4   ;Field     ;
                Name=OptionalMeasureType5;
                OptionCaptionML=ENU=Column,Point,Line,ColumnStacked,ColumnStacked100,Area,AreaStacked,AreaStacked100,StepLine,,,Range;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ChartTypeReduced[6];
                Enabled=OptionalMeasuresEnabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             UpdateChartDefinition;
                             EnableControls;
                           END;

                ShowCaption=false }

    { 59  ;4   ;Field     ;
                Name=OptionalMeasureCaption5;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MeasureCaption[6];
                Enabled=OptionalMeasuresEnabled AND DataColumn6Enabled;
                Editable=OptionalMeasuresEnabled;
                OnValidate=BEGIN
                             TempGenericChartCaptionsBuf.SetCaption(GenericChartMgt.OptionalMeasure5Code,GenericChartMgt.GetUserLanguage,MeasureCaption[6]);
                             UpdateChartDefinition;
                           END;

                OnAssistEdit=BEGIN
                               MeasureCaption[6] := GenericChartMgt.TextMLAssistEdit(TempGenericChartCaptionsBuf,GenericChartMgt.OptionalMeasure5Code);
                               UpdateChartDefinition;
                             END;

                ShowCaption=false }

    { 53  ;2   ;Field     ;
                Name=Y-Axis Title;
                CaptionML=ENU=Y-Axis Title;
                ToolTipML=ENU=Specifies the text that is shown next to the y-axis on the generic chart. To specify y-axis titles in different languages, choose the AssistEdit button to open the Generic Chart Text Editor window.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempGenericChartSetup."Y-Axis Title";
                OnValidate=BEGIN
                             TempGenericChartCaptionsBuf.SetCaption(GenericChartMgt.YAxisTitleCode,GenericChartMgt.GetUserLanguage,
                               TempGenericChartSetup."Y-Axis Title");
                             UpdateChartDefinition;
                           END;

                OnAssistEdit=BEGIN
                               TempGenericChartSetup."Y-Axis Title" :=
                                 GenericChartMgt.TextMLAssistEdit(TempGenericChartCaptionsBuf,GenericChartMgt.YAxisTitleCode);
                               UpdateChartDefinition;
                             END;
                              }

    { 52  ;2   ;Field     ;
                Name=Show Y-Axis Title;
                CaptionML=ENU=Show Y-Axis Title;
                ToolTipML=ENU=Specifies if the value in the Y-Axis Title field is shown on the generic chart.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempGenericChartSetup."Y-Axis Show Title";
                OnValidate=VAR
                             GenericChartMgt@1001 : Codeunit "Generic Chart Mgt";
                           BEGIN
                             GenericChartMgt.CheckSourceTypeID(TempGenericChartSetup,true);
                             UpdateChartDefinition;
                           END;
                            }

    { 12  ;1   ;Group     ;
                Name=Dimensions;
                CaptionML=ENU=Dimensions (X- and Z-Axes);
                GroupType=Group }

    { 5   ;2   ;Field     ;
                Name=X-Axis Field;
                CaptionML=ENU=X-Axis Field;
                ToolTipML=ENU=Specifies the field in the source object that is shown on the x-axis of the generic chart. The text is shown as a tooltip when you hover over the data element on the chart.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempGenericChartSetup."X-Axis Field Name";
                OnValidate=BEGIN
                             ValidateDimension(1);
                           END;

                OnLookup=VAR
                           GenericChartMgt@1000 : Codeunit "Generic Chart Mgt";
                         BEGIN
                           with TempGenericChartSetup do
                             GenericChartMgt.RetrieveFieldColumn(TempGenericChartSetup,"X-Axis Field ID","X-Axis Field Name","X-Axis Title",0,false);
                           TempGenericChartCaptionsBuf.SetCaption(GenericChartMgt.XAxisTitleCode,GenericChartMgt.GetUserLanguage,
                             TempGenericChartSetup."X-Axis Title");
                           ValidateDimension(1);
                         END;
                          }

    { 61  ;2   ;Field     ;
                Name=X-Axis Title;
                CaptionML=ENU=X-Axis Title;
                ToolTipML=ENU=Specifies the text that describes the data that is shown on the x-axis. The text is shown as a tooltip when you hover over the data element on the chart. To specify x-axis titles in different languages, choose the AssistEdit button to open the Generic Chart Text Editor window.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempGenericChartSetup."X-Axis Title";
                OnValidate=BEGIN
                             TempGenericChartCaptionsBuf.SetCaption(GenericChartMgt.XAxisTitleCode,GenericChartMgt.GetUserLanguage,
                               TempGenericChartSetup."X-Axis Title");
                             UpdateChartDefinition;
                           END;

                OnAssistEdit=BEGIN
                               TempGenericChartSetup."X-Axis Title" :=
                                 GenericChartMgt.TextMLAssistEdit(TempGenericChartCaptionsBuf,GenericChartMgt.XAxisTitleCode);
                               UpdateChartDefinition;
                             END;
                              }

    { 42  ;2   ;Field     ;
                Name=Show X-Axis Title;
                CaptionML=ENU=Show X-Axis Title;
                ToolTipML=ENU=Specifies if the value in the X-Axis Title field is shown on the generic chart.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempGenericChartSetup."X-Axis Show Title";
                OnValidate=VAR
                             GenericChartMgt@1001 : Codeunit "Generic Chart Mgt";
                           BEGIN
                             GenericChartMgt.CheckSourceTypeID(TempGenericChartSetup,true);
                             UpdateChartDefinition;
                           END;
                            }

    { 39  ;2   ;Field     ;
                Name=Data Point X Label;
                CaptionML=ENU=Data Point X Label;
                ToolTipML=ENU=Specifies the text describes the selected x-axis value in a tooltip when you hover over a data point. The data point label is shown in front of the data value.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempGenericChartSetup."X-Axis Field Caption";
                OnValidate=BEGIN
                             TempGenericChartCaptionsBuf.SetCaption(GenericChartMgt.XAxisCaptionCode,GenericChartMgt.GetUserLanguage,
                               TempGenericChartSetup."X-Axis Field Caption");
                             UpdateChartDefinition;
                           END;

                OnAssistEdit=BEGIN
                               TempGenericChartSetup."X-Axis Field Caption" :=
                                 GenericChartMgt.TextMLAssistEdit(TempGenericChartCaptionsBuf,GenericChartMgt.XAxisCaptionCode);
                               UpdateChartDefinition;
                             END;
                              }

    { 13  ;2   ;Field     ;
                Name=Z-Axis Field;
                CaptionML=ENU=Z-Axis Field;
                ToolTipML=ENU=Specifies the field in the source object that is shown on the z-axis of the generic chart.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempGenericChartSetup."Z-Axis Field Name";
                Enabled=ZAxisEnabled;
                Editable=ZAxisEnabled;
                OnValidate=BEGIN
                             ValidateDimension(2);
                           END;

                OnLookup=VAR
                           GenericChartMgt@1000 : Codeunit "Generic Chart Mgt";
                         BEGIN
                           with TempGenericChartSetup do
                             GenericChartMgt.RetrieveFieldColumn(TempGenericChartSetup,"Z-Axis Field ID","Z-Axis Field Name","Z-Axis Title",0,false);
                           ValidateDimension(2);
                         END;
                          }

    { 60  ;2   ;Field     ;
                Name=Data Point Z Label;
                CaptionML=ENU=Data Point Z Label;
                ToolTipML=ENU=Specifies the text that describes the z-axis value in a tooltip when you hover over a data point. The data point label is shown in front of the data value.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=TempGenericChartSetup."Z-Axis Field Caption";
                OnValidate=BEGIN
                             TempGenericChartCaptionsBuf.SetCaption(GenericChartMgt.ZAxisCaptionCode,GenericChartMgt.GetUserLanguage,
                               TempGenericChartSetup."Z-Axis Field Caption");
                             UpdateChartDefinition;
                           END;

                OnAssistEdit=BEGIN
                               TempGenericChartSetup."Z-Axis Field Caption" :=
                                 GenericChartMgt.TextMLAssistEdit(TempGenericChartCaptionsBuf,GenericChartMgt.ZAxisCaptionCode);
                               UpdateChartDefinition;
                             END;
                              }

    { 44  ;1   ;Group     ;
                Name=Chart Description;
                CaptionML=ENU=Chart Description;
                GroupType=Group }

    { 36  ;2   ;Field     ;
                Name=Description;
                CaptionML=ENU=Description;
                ToolTipML=ENU=Specifies a description of the generic chart.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ChartDescription;
                Editable=TitleEnabled;
                MultiLine=true;
                OnValidate=BEGIN
                             TempGenericChartMemoBuf.SetMemo(GenericChartMgt.DescriptionCode,GenericChartMgt.GetUserLanguage,ChartDescription);
                             UpdateChartDefinition;
                           END;

                OnAssistEdit=BEGIN
                               ChartDescription := GenericChartMgt.MemoMLAssistEdit(TempGenericChartMemoBuf,GenericChartMgt.DescriptionCode);
                               UpdateChartDefinition;
                             END;

                ImplicitType=Text }

    { 68  ;1   ;Part      ;
                Name=PreviewPart;
                CaptionML=ENU=Preview Part;
                ApplicationArea=#Basic,#Suite;
                PagePartID="Generic Chart Type Preview";
                PartType=Page }

  }
  CODE
  {
    VAR
      TempGenericChartSetup@1004 : TEMPORARY Record "Generic Chart Setup";
      TempGenericChartFilter@1020 : TEMPORARY Record "Generic Chart Filter";
      TempGenericChartYAxis@1001 : TEMPORARY Record "Generic Chart Y-Axis";
      TempGenericChartCaptionsBuf@1029 : TEMPORARY Record "Generic Chart Captions Buffer";
      TempGenericChartMemoBuf@1028 : TEMPORARY Record "Generic Chart Memo Buffer";
      GenericChartMgt@1016 : Codeunit "Generic Chart Mgt";
      DataColumn@1013 : ARRAY [6] OF Text[50];
      MeasureCaption@1025 : ARRAY [6] OF Text[250];
      Aggregation@1014 : ARRAY [6] OF 'None,Count,Sum,Min,Max,Avg';
      ChartType@1015 : 'Column,Point,Line,ColumnStacked,ColumnStacked100,Area,AreaStacked,AreaStacked100,StepLine,Pie,Doughnut,Range,Radar,Funnel';
      ChartTypeReduced@1003 : ARRAY [6] OF 'Column,Point,Line,ColumnStacked,ColumnStacked100,Area,AreaStacked,AreaStacked100,StepLine,,,Range';
      ChartDescription@1011 : Text;
      xRecSourceType@1009 : '" ",Table,Query';
      xRecSourceID@1010 : Integer;
      DummyInt@1017 : Integer;
      DummyCaption@1030 : Text[50];
      Text001@1000 : TextConst 'ENU=All fields will be reset. Are you sure that you want to change the %1?';
      OptionalMeasuresEnabled@1005 : Boolean INDATASET;
      Text002@1006 : TextConst 'ENU=Field %1 is already assigned to a measure or dimension. Select a different field.';
      Text003@1007 : TextConst '@@@=Do you want to replace the existing definition for Chart 36-06?;ENU=Do you want to replace the existing definition for %1 %2?';
      DataColumn1Enabled@1012 : Boolean INDATASET;
      DataColumn2Enabled@1022 : Boolean INDATASET;
      DataColumn3Enabled@1023 : Boolean INDATASET;
      DataColumn4Enabled@1024 : Boolean INDATASET;
      DataColumn5Enabled@1026 : Boolean INDATASET;
      DataColumn6Enabled@1027 : Boolean INDATASET;
      ZAxisEnabled@1008 : Boolean INDATASET;
      Text004@1018 : TextConst 'ENU=You can only specify one Measure with aggregation type Count.';
      Text005@1019 : TextConst 'ENU=If you select Aggregation Count, the Data Column will be cleared for this measure. Do you want to continue?';
      TitleEnabled@1002 : Boolean;

    LOCAL PROCEDURE SetFieldValues@6();
    BEGIN
      ClearAllVariables;
      GenericChartMgt.RetrieveXML(
        Rec,TempGenericChartSetup,TempGenericChartYAxis,TempGenericChartCaptionsBuf,TempGenericChartMemoBuf,TempGenericChartFilter);
      ChartDescription := TempGenericChartMemoBuf.GetMemo(GenericChartMgt.DescriptionCode,GenericChartMgt.GetUserLanguage);
      TempGenericChartSetup."Y-Axis Title" :=
        TempGenericChartCaptionsBuf.GetCaption(GenericChartMgt.YAxisTitleCode,GenericChartMgt.GetUserLanguage);
      TempGenericChartSetup."X-Axis Field Caption" :=
        TempGenericChartCaptionsBuf.GetCaption(GenericChartMgt.XAxisCaptionCode,GenericChartMgt.GetUserLanguage);
      TempGenericChartSetup."X-Axis Title" :=
        TempGenericChartCaptionsBuf.GetCaption(GenericChartMgt.XAxisTitleCode,GenericChartMgt.GetUserLanguage);
      TempGenericChartSetup."Z-Axis Field Caption" :=
        TempGenericChartCaptionsBuf.GetCaption(GenericChartMgt.ZAxisCaptionCode,GenericChartMgt.GetUserLanguage);
      TempGenericChartSetup.INSERT;
      StoreTempXRecValues;
      FillMatrixWhenOpenPage;
      UpdateTempGenericChartYAXis;
      RefreshPreview;
    END;

    LOCAL PROCEDURE ValidateDataColumn@13(Index@1000 : Integer);
    VAR
      FieldAlreadyExists@1002 : Boolean;
      i@1001 : Integer;
    BEGIN
      GenericChartMgt.CheckSourceTypeID(TempGenericChartSetup,true);
      for i := 1 to ARRAYLEN(DataColumn) do begin
        if (DataColumn[i] <> '') and (Index <> i) then
          FieldAlreadyExists := (DataColumn[Index] = DataColumn[i]) or FieldAlreadyExists;
      end;

      if FieldAlreadyExists then
        ERROR(Text002,DataColumn[Index]);

      GenericChartMgt.CheckDataTypeAggregationCompliance(TempGenericChartSetup,DataColumn[Index],Aggregation[Index]);
      GenericChartMgt.ValidateFieldColumn(TempGenericChartSetup,DummyInt,DataColumn[Index],DummyCaption,2,false,Aggregation[Index]);
      UpdateChartDefinition;
      EnableControls;
    END;

    LOCAL PROCEDURE ValidateDimension@14(Index@1000 : Integer);
    VAR
      DummyAggregation@1002 : 'None,Count,Sum,Min,Max,Avg';
    BEGIN
      GenericChartMgt.CheckSourceTypeID(TempGenericChartSetup,true);
      with TempGenericChartSetup do begin
        if ("X-Axis Field Name" <> '') and ("Z-Axis Field Name" <> '') and ("X-Axis Field Name" = "Z-Axis Field Name") then
          ERROR(Text002,DataColumn[Index]);
      end;
      with TempGenericChartSetup do
        case Index of
          1:
            GenericChartMgt.ValidateFieldColumn(
              TempGenericChartSetup,"X-Axis Field ID","X-Axis Field Name","X-Axis Title",0,false,DummyAggregation);
          2:
            GenericChartMgt.ValidateFieldColumn(
              TempGenericChartSetup,"Z-Axis Field ID","Z-Axis Field Name","Z-Axis Title",0,false,DummyAggregation);
        end;
      UpdateChartDefinition;
      EnableControls;
    END;

    LOCAL PROCEDURE UpdateTempGenericChartYAXis@2();
    VAR
      i@1000 : Integer;
      Count@1001 : Integer;
    BEGIN
      TempGenericChartYAxis.DELETEALL;

      if ChartCapableOfOptionalMeasures then
        Count := ARRAYLEN(DataColumn)
      else
        Count := 1;

      for i := 1 to Count do
        if AddYAxisMeasure(i) then begin
          CLEAR(TempGenericChartYAxis);
          TempGenericChartYAxis.ID := ID;
          TempGenericChartYAxis."Line No." := i * 10000;
          TempGenericChartYAxis."Y-Axis Measure Field Name" := DataColumn[i];
          GenericChartMgt.RetrieveFieldColumnIDFromName(
            TempGenericChartSetup."Source Type",TempGenericChartSetup."Source ID",TempGenericChartYAxis."Y-Axis Measure Field ID",
            DataColumn[i]);
          TempGenericChartYAxis."Y-Axis Measure Field Caption" := MeasureCaption[i];
          TempGenericChartYAxis.Aggregation := Aggregation[i];
          if i = 1 then
            TempGenericChartYAxis."Chart Type" := ChartType
          else
            TempGenericChartYAxis."Chart Type" := ChartTypeReduced[i];
          TempGenericChartYAxis.INSERT;
        end;
    END;

    LOCAL PROCEDURE FillMatrixWhenOpenPage@1();
    VAR
      i@1001 : Integer;
      CurrentCaptionCode@1002 : Code[10];
    BEGIN
      CLEAR(DataColumn);
      CLEAR(MeasureCaption);
      CLEAR(Aggregation);
      CLEAR(ChartType);

      i := 0;
      if TempGenericChartYAxis.FINDSET then begin
        CurrentCaptionCode := GenericChartMgt.RequiredMeasureCode;
        repeat
          i += 1;
          DataColumn[i] := TempGenericChartYAxis."Y-Axis Measure Field Name";
          MeasureCaption[i] := TempGenericChartCaptionsBuf.GetCaption(CurrentCaptionCode,GenericChartMgt.GetUserLanguage);
          Aggregation[i] := TempGenericChartYAxis.Aggregation;
          if i = 1 then
            ChartType := TempGenericChartYAxis."Chart Type"
          else
            ChartTypeReduced[i] := TempGenericChartYAxis."Chart Type";

          if CurrentCaptionCode = GenericChartMgt.RequiredMeasureCode then
            CurrentCaptionCode := GenericChartMgt.OptionalMeasure1Code
          else
            CurrentCaptionCode := INCSTR(CurrentCaptionCode)
        until TempGenericChartYAxis.NEXT = 0;
      end
    END;

    LOCAL PROCEDURE UpdateChartDefinition@5();
    BEGIN
      if ChartDefinitionCreationIsPossible then begin
        UpdateTempGenericChartYAXis;
        GenericChartMgt.SaveChanges(Rec,TempGenericChartSetup,TempGenericChartYAxis,TempGenericChartFilter,
          TempGenericChartCaptionsBuf,TempGenericChartMemoBuf);
      end;
      EnableControls;
      RefreshPreview;
    END;

    LOCAL PROCEDURE ChartDefinitionCreationIsPossible@4() : Boolean;
    BEGIN
      with TempGenericChartSetup do
        exit(("Source Type" <> "Source Type"::" ") and ("Source ID" <> 0));
    END;

    LOCAL PROCEDURE RefreshPreview@8();
    VAR
      chartBuilder@1000 : DotNet "'Microsoft.Dynamics.Nav.Client.BusinessChart.Model, Version=11.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.BusinessChart.BusinessChartBuilder";
    BEGIN
      if ChartDefinitionCreationIsPossible then begin
        chartBuilder := chartBuilder.Empty;
        GenericChartMgt.FillChartHelper(chartBuilder,TempGenericChartSetup,TempGenericChartYAxis,TempGenericChartFilter,
          TempGenericChartCaptionsBuf,TempGenericChartMemoBuf);

        CurrPage.PreviewPart.PAGE.SetChartDefinition(chartBuilder);
      end;
    END;

    LOCAL PROCEDURE ShowChartFiltersPage@11();
    VAR
      TempGenericChartFilter2@1001 : TEMPORARY Record "Generic Chart Filter";
      GenericChartFiltersPage@1000 : Page "Generic Chart Filters";
      FilterText@1002 : Text[250];
    BEGIN
      GenericChartMgt.CheckSourceTypeID(TempGenericChartSetup,true);
      GenericChartFiltersPage.SetTempGenericChart(TempGenericChartSetup);
      GenericChartFiltersPage.SetFilters(TempGenericChartFilter);
      GenericChartFiltersPage.SETTABLEVIEW(TempGenericChartFilter);
      COMMIT;
      GenericChartFiltersPage.RUNMODAL;
      TempGenericChartFilter.DELETEALL;
      CLEAR(FilterText);
      GenericChartFiltersPage.GetFilters(TempGenericChartFilter2);
      if TempGenericChartFilter2.FINDSET then
        repeat
          TempGenericChartFilter := TempGenericChartFilter2;
          TempGenericChartFilter.INSERT;
          if TempGenericChartFilter."Filter Value" <> '' then
            GenericChartMgt.BuildFilterText(FilterText,
              COPYSTR(
                TempGenericChartFilter."Filter Field Name" + ' : ' + TempGenericChartFilter."Filter Value",1,MAXSTRLEN(FilterText)));
        until TempGenericChartFilter2.NEXT = 0;
      GenericChartMgt.FinalizeFilterText(FilterText);
      TempGenericChartSetup."Filter Text" := FilterText;
      if TempGenericChartSetup.MODIFY then;
      UpdateChartDefinition;
    END;

    LOCAL PROCEDURE ResetFields@7(CalledFrom@1000 : '"Source Type","Source ID"');
    VAR
      ID@1001 : Code[20];
      SourceType@1002 : Option;
      SourceID@1003 : Integer;
    BEGIN
      ID := TempGenericChartSetup.ID;
      with TempGenericChartSetup do begin
        SourceType := "Source Type";
        SourceID := "Source ID";
        case CalledFrom of
          CalledFrom::"Source Type":
            begin
              if "Source Type" = xRecSourceType then
                exit;
              if xRecSourceType <> xRecSourceType::" " then
                if not CONFIRM(Text001,true,FIELDCAPTION("Source Type")) then
                  ERROR('');
            end;
          CalledFrom::"Source ID":
            begin
              if "Source ID" = xRecSourceID then
                exit;
              if xRecSourceID <> 0 then
                if not CONFIRM(Text001,true,FIELDCAPTION("Source ID")) then
                  ERROR('');
            end;
        end;
      end;
      ClearAllVariables;
      TempGenericChartSetup.ID := ID;
      with TempGenericChartSetup do begin
        "Source Type" := SourceType;
        if CalledFrom = CalledFrom::"Source ID" then
          "Source ID" := SourceID;
      end;
    END;

    LOCAL PROCEDURE ClearAllVariables@9();
    BEGIN
      TempGenericChartSetup.DELETEALL;
      TempGenericChartFilter.DELETEALL;
      TempGenericChartYAxis.DELETEALL;
      TempGenericChartCaptionsBuf.DELETEALL;
      TempGenericChartMemoBuf.DELETEALL;

      CLEAR(TempGenericChartFilter);
      CLEAR(TempGenericChartYAxis);
      CLEAR(TempGenericChartSetup);
      CLEAR(TempGenericChartCaptionsBuf);
      CLEAR(TempGenericChartMemoBuf);
      CLEAR(GenericChartMgt);
      CLEAR(DataColumn);
      CLEAR(MeasureCaption);
      CLEAR(Aggregation);
      CLEAR(ChartType);
      CLEAR(ChartTypeReduced);
      CLEAR(DummyInt);
      CLEAR(DummyCaption);
    END;

    LOCAL PROCEDURE ChartCapableOfOptionalMeasures@12() : Boolean;
    BEGIN
      exit(not (ChartType in [ChartType::Pie,ChartType::Doughnut,ChartType::Funnel,ChartType::Radar]));
    END;

    LOCAL PROCEDURE StoreTempXRecValues@15();
    BEGIN
      xRecSourceType := TempGenericChartSetup."Source Type";
      xRecSourceID := TempGenericChartSetup."Source ID";
    END;

    LOCAL PROCEDURE ImportChartDefinition@3();
    VAR
      TempBLOB@1000 : Record TempBlob;
      FileMgt@1001 : Codeunit "File Management";
    BEGIN
      if FileMgt.BLOBImport(TempBLOB,'*.xml') = '' then
        exit;

      if BLOB.HASVALUE then
        if not CONFIRM(Text003,false,TABLECAPTION,ID) then
          exit;

      BLOB := TempBLOB.Blob;
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE ExportChartDefinition@10();
    VAR
      TempBlob@1000 : Record TempBlob;
      FileMgt@1001 : Codeunit "File Management";
    BEGIN
      CALCFIELDS(BLOB);
      if BLOB.HASVALUE then begin
        TempBlob.Blob := BLOB;
        FileMgt.BLOBExport(TempBlob,'*.xml',true);
      end;
    END;

    LOCAL PROCEDURE EnableControls@17();
    BEGIN
      OptionalMeasuresEnabled := ChartCapableOfOptionalMeasures and (TempGenericChartSetup."Z-Axis Field Name" = '');
      ZAxisEnabled :=
        ChartCapableOfOptionalMeasures and
        (DataColumn[2] = '') and (DataColumn[3] = '') and (DataColumn[4] = '') and (DataColumn[5] = '') and (DataColumn[6] = '');
      TitleEnabled := ChartDefinitionCreationIsPossible;
      DataColumn1Enabled := Aggregation[1] <> Aggregation[1]::Count;
      DataColumn2Enabled := Aggregation[2] <> Aggregation[2]::Count;
      DataColumn3Enabled := Aggregation[3] <> Aggregation[3]::Count;
      DataColumn4Enabled := Aggregation[4] <> Aggregation[4]::Count;
      DataColumn5Enabled := Aggregation[5] <> Aggregation[5]::Count;
      DataColumn6Enabled := Aggregation[6] <> Aggregation[6]::Count;
    END;

    LOCAL PROCEDURE AddYAxisMeasure@19(index@1000 : Integer) : Boolean;
    BEGIN
      if Aggregation[index] = Aggregation[index]::Count then
        exit(true);
      exit(DataColumn[index] <> '');
    END;

    LOCAL PROCEDURE CheckAggregation@30(index@1000 : Integer);
    VAR
      FieldOfTypeCountAlreadyExists@1002 : Boolean;
      i@1001 : Integer;
      CountColumnName@1003 : Text[50];
      ReplaceDataColumn@1004 : Boolean;
    BEGIN
      for i := 1 to ARRAYLEN(Aggregation) do begin
        if (Aggregation[i] = Aggregation[i]::Count) and (index <> i) then
          FieldOfTypeCountAlreadyExists := (Aggregation[index] = Aggregation[i]) or FieldOfTypeCountAlreadyExists;
      end;

      if FieldOfTypeCountAlreadyExists then
        ERROR(Text004);

      GenericChartMgt.CheckDataTypeAggregationCompliance(TempGenericChartSetup,DataColumn[index],Aggregation[index]);
      if Aggregation[index] = Aggregation[index]::Count then begin
        CountColumnName := GenericChartMgt.GetQueryCountColumnName(TempGenericChartSetup);
        if DataColumn[index] <> CountColumnName then begin
          ReplaceDataColumn := true;
          if DataColumn[index] <> '' then
            ReplaceDataColumn := CONFIRM(Text005,false);
          if ReplaceDataColumn then
            DataColumn[index] := CountColumnName
          else
            ERROR('');
        end;
      end;
    END;

    BEGIN
    END.
  }
}

