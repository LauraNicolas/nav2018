OBJECT Codeunit 2112 O365 Sales Attachment Mgt
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [External]
    PROCEDURE GetNoOfAttachments@124(RecordVariant@1002 : Variant) : Integer;
    VAR
      IncomingDocumentAttachment@1000 : Record "Incoming Document Attachment";
      SalesHeader@1001 : Record "Sales Header";
      SalesInvoiceHeader@1003 : Record "Sales Invoice Header";
      RecordRef@1004 : RecordRef;
    BEGIN
      RecordRef.GETTABLE(RecordVariant);
      if RecordRef.NUMBER = DATABASE::"Sales Header" then begin
        SalesHeader := RecordVariant;
        if SalesHeader."Incoming Document Entry No." = 0 then
          exit(0);
        IncomingDocumentAttachment.SETRANGE("Incoming Document Entry No.",SalesHeader."Incoming Document Entry No.");
        exit(IncomingDocumentAttachment.COUNT);
      end;
      if RecordRef.NUMBER = DATABASE::"Sales Invoice Header" then begin
        SalesInvoiceHeader := RecordVariant;
        IncomingDocumentAttachment.SETRANGE("Document No.",SalesInvoiceHeader."No.");
        IncomingDocumentAttachment.SETRANGE("Posting Date",SalesInvoiceHeader."Posting Date");
        exit(IncomingDocumentAttachment.COUNT);
      end;
    END;

    [External]
    PROCEDURE EditAttachments@123(RecordVariant@1000 : Variant) NoOfAttachments : Integer;
    VAR
      IncomingDocument@1001 : Record "Incoming Document";
      SalesHeader@1003 : Record "Sales Header";
      RecordRef@1004 : RecordRef;
    BEGIN
      RecordRef.GETTABLE(RecordVariant);
      if not RecordRef.FIND then
        exit;
      RecordVariant := RecordRef;
      if RecordRef.NUMBER = DATABASE::"Sales Header" then begin
        SalesHeader := RecordVariant;
        if SalesHeader."Incoming Document Entry No." = 0 then begin
          SalesHeader."Incoming Document Entry No." := IncomingDocument.CreateIncomingDocument(SalesHeader."Sell-to Customer Name",'');
          SalesHeader.MODIFY;
          COMMIT;
          RecordVariant := SalesHeader;
        end;
        PAGE.RUN(PAGE::"O365 Sales Doc. Attachments",SalesHeader);
      end;
      if RecordRef.NUMBER = DATABASE::"Sales Invoice Header" then
        PAGE.RUN(PAGE::"O365 Posted Sales Inv. Att.",RecordVariant);
      NoOfAttachments := GetNoOfAttachments(RecordVariant);
    END;

    BEGIN
    END.
  }
}

