OBJECT Page 9223 Item Statistics Matrix
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    Editable=false;
    CaptionML=ENU=Item Statistics Matrix;
    LinksAllowed=false;
    SourceTable="Dimension Code Buffer";
    DataCaptionExpr=ItemName;
    PageType=List;
    OnInit=BEGIN
             Field32Visible := true;
             Field31Visible := true;
             Field30Visible := true;
             Field29Visible := true;
             Field28Visible := true;
             Field27Visible := true;
             Field26Visible := true;
             Field25Visible := true;
             Field24Visible := true;
             Field23Visible := true;
             Field22Visible := true;
             Field21Visible := true;
             Field20Visible := true;
             Field19Visible := true;
             Field18Visible := true;
             Field17Visible := true;
             Field16Visible := true;
             Field15Visible := true;
             Field14Visible := true;
             Field13Visible := true;
             Field12Visible := true;
             Field11Visible := true;
             Field10Visible := true;
             Field9Visible := true;
             Field8Visible := true;
             Field7Visible := true;
             Field6Visible := true;
             Field5Visible := true;
             Field4Visible := true;
             Field3Visible := true;
             Field2Visible := true;
             Field1Visible := true;
           END;

    OnOpenPage=BEGIN
                 Field1Visible := 1 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field2Visible := 2 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field3Visible := 3 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field4Visible := 4 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field5Visible := 5 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field6Visible := 6 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field7Visible := 7 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field8Visible := 8 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field9Visible := 9 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field10Visible := 10 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field11Visible := 11 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field12Visible := 12 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field13Visible := 13 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field14Visible := 14 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field15Visible := 15 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field16Visible := 16 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field17Visible := 17 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field18Visible := 18 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field19Visible := 19 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field20Visible := 20 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field21Visible := 21 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field22Visible := 22 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field23Visible := 23 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field24Visible := 24 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field25Visible := 25 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field26Visible := 26 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field27Visible := 27 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field28Visible := 28 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field29Visible := 29 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field30Visible := 30 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field31Visible := 31 <= MATRIX_CurrentNoOfMatrixColumn;
                 Field32Visible := 32 <= MATRIX_CurrentNoOfMatrixColumn;

                 with Item do begin
                   if "No." <> '' then
                     ItemFilter := "No.";
                   if GETFILTER("Date Filter") <> '' then
                     DateFilter := GETFILTER("Date Filter");
                   if GETFILTER("Variant Filter") <> '' then
                     VariantFilter := GETFILTER("Variant Filter");
                   if GETFILTER("Location Filter") <> '' then
                     LocationFilter := GETFILTER("Location Filter");
                 end;

                 if ColumnDimCode = '' then
                   ColumnDimCode := Text002;
                 ItemBuffer."Column Option" := DimCodeToOption(ColumnDimCode);
                 PeriodInitialized := DateFilter <> '';
                 FindPeriod('');
                 ItemName := STRSUBSTNO('%1  %2',Item."No.",Item.Description);
               END;

    OnFindRecord=BEGIN
                   with ItemBuffer do begin
                     if "Line Option" = "Line Option"::"Profit Calculation" then
                       IntegerLine.SETRANGE(Number,1,5)
                     else
                       if "Line Option" = "Line Option"::"Cost Specification" then
                         IntegerLine.SETRANGE(Number,1,9);
                     exit(FindRec("Line Option",Rec,Which));
                   end;
                 END;

    OnNextRecord=BEGIN
                   exit(NextRec(ItemBuffer."Line Option",Rec,Steps));
                 END;

    OnAfterGetRecord=VAR
                       MATRIX_Steps@1000 : Integer;
                     BEGIN
                       NameIndent := 0;
                       Amount := Calculate(false);
                       MATRIX_ColumnOrdinal := 0;
                       if MATRIX_OnFindRecord('=><') then begin
                         MATRIX_ColumnOrdinal := 1;
                         repeat
                           MATRIX_OnAfterGetRecord(MATRIX_ColumnOrdinal);
                           MATRIX_Steps := MATRIX_OnNextRecord(1);
                           MATRIX_ColumnOrdinal := MATRIX_ColumnOrdinal + MATRIX_Steps;
                         until (MATRIX_ColumnOrdinal - MATRIX_Steps = ARRAYLEN(MatrixRecords)) or (MATRIX_Steps = 0);
                         if MATRIX_ColumnOrdinal <> 1 then
                           MATRIX_OnNextRecord(1 - MATRIX_ColumnOrdinal);
                       end;
                       NameOnFormat;
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                Name=Container1900000001;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Name=Group1;
                IndentationColumnName=NameIndent;
                IndentationControls=Name;
                GroupType=Repeater }

    { 22  ;2   ;Field     ;
                Name=Name;
                ToolTipML=ENU=Specifies the name of the record.;
                ApplicationArea=#Suite;
                SourceExpr=Name;
                StyleExpr='Strong';
                ImplicitType=Text50 }

    { 30  ;2   ;Field     ;
                Name=Amount;
                CaptionML=ENU=Total Amount;
                ToolTipML=ENU=Specifies the total value for the amount type that you select in the Show field.;
                ApplicationArea=#Suite;
                BlankZero=true;
                SourceExpr=Amount;
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                StyleExpr='Strong';
                OnDrillDown=BEGIN
                              with ItemBuffer do
                                if not (("Line Option" = "Line Option"::"Profit Calculation") and
                                        ((Name = FIELDCAPTION("Profit (LCY)")) or (Name = FIELDCAPTION("Profit %"))) or
                                        (("Line Option" = "Line Option"::"Cost Specification") and (Name = FIELDCAPTION("Inventoriable Costs"))))
                                then begin
                                  SetCommonFilters(ItemBuffer);
                                  SetFilters(ItemBuffer,0);
                                  DrillDown;
                                end;
                            END;

                ImplicitType=Decimal }

    { 1012;2   ;Field     ;
                Name=Field1;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[1];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[1];
                Visible=Field1Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(1);
                            END;
                             }

    { 1013;2   ;Field     ;
                Name=Field2;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[2];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[2];
                Visible=Field2Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(2);
                            END;
                             }

    { 1014;2   ;Field     ;
                Name=Field3;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[3];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[3];
                Visible=Field3Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(3);
                            END;
                             }

    { 1015;2   ;Field     ;
                Name=Field4;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[4];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[4];
                Visible=Field4Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(4);
                            END;
                             }

    { 1016;2   ;Field     ;
                Name=Field5;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[5];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[5];
                Visible=Field5Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(5);
                            END;
                             }

    { 1017;2   ;Field     ;
                Name=Field6;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[6];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[6];
                Visible=Field6Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(6);
                            END;
                             }

    { 1018;2   ;Field     ;
                Name=Field7;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[7];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[7];
                Visible=Field7Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(7);
                            END;
                             }

    { 1019;2   ;Field     ;
                Name=Field8;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[8];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[8];
                Visible=Field8Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(8);
                            END;
                             }

    { 1020;2   ;Field     ;
                Name=Field9;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[9];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[9];
                Visible=Field9Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(9);
                            END;
                             }

    { 1021;2   ;Field     ;
                Name=Field10;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[10];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[10];
                Visible=Field10Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(10);
                            END;
                             }

    { 1022;2   ;Field     ;
                Name=Field11;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[11];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[11];
                Visible=Field11Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(11);
                            END;
                             }

    { 1023;2   ;Field     ;
                Name=Field12;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[12];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[12];
                Visible=Field12Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(12);
                            END;
                             }

    { 1024;2   ;Field     ;
                Name=Field13;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[13];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[13];
                Visible=Field13Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(13);
                            END;
                             }

    { 1025;2   ;Field     ;
                Name=Field14;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[14];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[14];
                Visible=Field14Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(14);
                            END;
                             }

    { 1026;2   ;Field     ;
                Name=Field15;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[15];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[15];
                Visible=Field15Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(15);
                            END;
                             }

    { 1027;2   ;Field     ;
                Name=Field16;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[16];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[16];
                Visible=Field16Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(16);
                            END;
                             }

    { 1028;2   ;Field     ;
                Name=Field17;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[17];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[17];
                Visible=Field17Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(17);
                            END;
                             }

    { 1029;2   ;Field     ;
                Name=Field18;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[18];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[18];
                Visible=Field18Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(18);
                            END;
                             }

    { 1030;2   ;Field     ;
                Name=Field19;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[19];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[19];
                Visible=Field19Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(19);
                            END;
                             }

    { 1031;2   ;Field     ;
                Name=Field20;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[20];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[20];
                Visible=Field20Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(20);
                            END;
                             }

    { 1032;2   ;Field     ;
                Name=Field21;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[21];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[21];
                Visible=Field21Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(21);
                            END;
                             }

    { 1033;2   ;Field     ;
                Name=Field22;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[22];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[22];
                Visible=Field22Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(22);
                            END;
                             }

    { 1034;2   ;Field     ;
                Name=Field23;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[23];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[23];
                Visible=Field23Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(23);
                            END;
                             }

    { 1035;2   ;Field     ;
                Name=Field24;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[24];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[24];
                Visible=Field24Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(24);
                            END;
                             }

    { 1036;2   ;Field     ;
                Name=Field25;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[25];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[25];
                Visible=Field25Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(25);
                            END;
                             }

    { 1037;2   ;Field     ;
                Name=Field26;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[26];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[26];
                Visible=Field26Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(26);
                            END;
                             }

    { 1038;2   ;Field     ;
                Name=Field27;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[27];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[27];
                Visible=Field27Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(27);
                            END;
                             }

    { 1039;2   ;Field     ;
                Name=Field28;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[28];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[28];
                Visible=Field28Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(28);
                            END;
                             }

    { 1040;2   ;Field     ;
                Name=Field29;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[29];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[29];
                Visible=Field29Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(29);
                            END;
                             }

    { 1041;2   ;Field     ;
                Name=Field30;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[30];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[30];
                Visible=Field30Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(30);
                            END;
                             }

    { 1042;2   ;Field     ;
                Name=Field31;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[31];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[31];
                Visible=Field31Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(31);
                            END;
                             }

    { 1043;2   ;Field     ;
                Name=Field32;
                ApplicationArea=#All;
                BlankZero=true;
                SourceExpr=MATRIX_CellData[32];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr;
                CaptionClass='3,' + MATRIX_CaptionSet[32];
                Visible=Field32Visible;
                OnDrillDown=BEGIN
                              MATRIX_OnDrillDown(32);
                            END;
                             }

  }
  CODE
  {
    VAR
      Item@1081 : Record Item;
      ItemBuffer@1082 : Record "Item Statistics Buffer";
      IntegerLine@1083 : Record Integer;
      MatrixRecord@1001 : Record "Dimension Code Buffer";
      MatrixRecords@1003 : ARRAY [32] OF Record "Dimension Code Buffer";
      MatrixMgt@1002 : Codeunit "Matrix Management";
      ColumnDimCode@1084 : Text[30];
      ItemName@1085 : Text[250];
      PeriodType@1086 : 'Day,Week,Month,Quarter,Year,"Accounting Period"';
      RoundingFactor@1087 : 'None,"1","1000","1000000"';
      AmountType@1088 : '"Net Change","Balance at Date"';
      DateFilter@1089 : Text;
      InternalDateFilter@1090 : Text;
      ItemFilter@1091 : Text;
      VariantFilter@1092 : Text;
      LocationFilter@1093 : Text;
      ItemChargesFilter@1094 : Text;
      PeriodInitialized@1096 : Boolean;
      PerUnit@1098 : Boolean;
      IncludeExpected@1099 : Boolean;
      Qty@1101 : Decimal;
      CellAmount@1102 : Decimal;
      Text002@1103 : TextConst 'ENU=Period';
      MATRIX_CurrentNoOfMatrixColumn@1107 : Integer;
      MATRIX_ColumnOrdinal@1000 : Integer;
      MATRIX_CellData@1108 : ARRAY [32] OF Decimal;
      MATRIX_CaptionSet@1109 : ARRAY [32] OF Text[80];
      RoundingFactorFormatString@1039 : Text;
      Field1Visible@19069335 : Boolean INDATASET;
      Field2Visible@19014807 : Boolean INDATASET;
      Field3Visible@19062679 : Boolean INDATASET;
      Field4Visible@19074839 : Boolean INDATASET;
      Field5Visible@19043543 : Boolean INDATASET;
      Field6Visible@19067287 : Boolean INDATASET;
      Field7Visible@19067863 : Boolean INDATASET;
      Field8Visible@19039959 : Boolean INDATASET;
      Field9Visible@19008663 : Boolean INDATASET;
      Field10Visible@19006501 : Boolean INDATASET;
      Field11Visible@19052468 : Boolean INDATASET;
      Field12Visible@19013039 : Boolean INDATASET;
      Field13Visible@19079726 : Boolean INDATASET;
      Field14Visible@19077225 : Boolean INDATASET;
      Field15Visible@19035896 : Boolean INDATASET;
      Field16Visible@19003763 : Boolean INDATASET;
      Field17Visible@19049730 : Boolean INDATASET;
      Field18Visible@19007213 : Boolean INDATASET;
      Field19Visible@19053180 : Boolean INDATASET;
      Field20Visible@19014629 : Boolean INDATASET;
      Field21Visible@19060596 : Boolean INDATASET;
      Field22Visible@19021167 : Boolean INDATASET;
      Field23Visible@19047854 : Boolean INDATASET;
      Field24Visible@19045353 : Boolean INDATASET;
      Field25Visible@19004024 : Boolean INDATASET;
      Field26Visible@19011891 : Boolean INDATASET;
      Field27Visible@19057858 : Boolean INDATASET;
      Field28Visible@19015341 : Boolean INDATASET;
      Field29Visible@19061308 : Boolean INDATASET;
      Field30Visible@19010597 : Boolean INDATASET;
      Field31Visible@19056564 : Boolean INDATASET;
      Field32Visible@19017135 : Boolean INDATASET;
      NameIndent@19079073 : Integer INDATASET;

    LOCAL PROCEDURE DimCodeToOption@1110(DimCode@1000 : Text[30]) : Integer;
    VAR
      Location@1111 : Record Location;
    BEGIN
      case DimCode of
        '':
          exit(-1);
        Text002:
          exit(4);
        Location.TABLECAPTION:
          exit(5);
        else
          exit(-1);
      end;
    END;

    LOCAL PROCEDURE FindRec@1112(DimOption@1000 : '"Profit Calculation","Cost Specification","Purch. Item Charge Spec.","Sales Item Charge Spec.",Period,Location';VAR DimCodeBuf@1001 : Record "Dimension Code Buffer";Which@1002 : Text[250]) : Boolean;
    VAR
      ItemCharge@1113 : Record "Item Charge";
      Location@1114 : Record Location;
      Period@1115 : Record Date;
      PeriodFormMgt@1116 : Codeunit PeriodFormManagement;
      Found@1117 : Boolean;
    BEGIN
      case DimOption of
        DimOption::"Profit Calculation",
        DimOption::"Cost Specification":
          begin
            if EVALUATE(IntegerLine.Number,DimCodeBuf.Code) then;
            Found := IntegerLine.FIND(Which);
            if Found then
              CopyDimValueToBuf(IntegerLine,DimCodeBuf);
          end;
        DimOption::"Purch. Item Charge Spec.",
        DimOption::"Sales Item Charge Spec.":
          begin
            ItemCharge."No." := DimCodeBuf.Code;
            Found := ItemCharge.FIND(Which);
            if Found then
              CopyAddChargesToBuf(ItemCharge,DimCodeBuf);
          end;
        DimOption::Period:
          begin
            if not PeriodInitialized then
              DateFilter := '';
            PeriodInitialized := true;
            Period.RESET;
            if DateFilter <> '' then
              Period.SETFILTER("Period Start",DateFilter)
            else
              if not PeriodInitialized and (InternalDateFilter <> '') then
                Period.SETFILTER("Period Start",InternalDateFilter);
            if DimCodeBuf."Period Start" = 0D then
              Period.FINDFIRST
            else
              Period."Period Start" := DimCodeBuf."Period Start";
            Found := PeriodFormMgt.FindDate(Which,Period,PeriodType);
            if Found then
              CopyPeriodToBuf(Period,DimCodeBuf);
          end;
        DimOption::Location:
          begin
            Location.Code := DimCodeBuf.Code;
            if LocationFilter <> '' then
              Location.SETFILTER(Code,LocationFilter);
            Found := Location.FIND(Which);
            if Found then
              CopyLocationToBuf(Location,DimCodeBuf);
          end;
      end;
      exit(Found);
    END;

    LOCAL PROCEDURE NextRec@1118(DimOption@1000 : '"Profit Calculation","Cost Specification","Purch. Item Charge Spec.","Sales Item Charge Spec.",Period,Location';VAR DimCodeBuf@1001 : Record "Dimension Code Buffer";Steps@1002 : Integer) : Integer;
    VAR
      ItemCharge@1119 : Record "Item Charge";
      Location@1120 : Record Location;
      Period@1121 : Record Date;
      PeriodFormMgt@1122 : Codeunit PeriodFormManagement;
      ResultSteps@1123 : Integer;
    BEGIN
      case DimOption of
        DimOption::"Profit Calculation",
        DimOption::"Cost Specification":
          begin
            if EVALUATE(IntegerLine.Number,DimCodeBuf.Code) then;
            ResultSteps := IntegerLine.NEXT(Steps);
            if ResultSteps <> 0 then
              CopyDimValueToBuf(IntegerLine,DimCodeBuf);
          end;
        DimOption::"Purch. Item Charge Spec.",
        DimOption::"Sales Item Charge Spec.":
          begin
            ItemCharge."No." := DimCodeBuf.Code;
            if ItemChargesFilter <> '' then
              ItemCharge.SETFILTER("No.",ItemChargesFilter);
            ResultSteps := ItemCharge.NEXT(Steps);
            if ResultSteps <> 0 then
              CopyAddChargesToBuf(ItemCharge,DimCodeBuf);
          end;
        DimOption::Period:
          begin
            if DateFilter <> '' then
              Period.SETFILTER("Period Start",DateFilter);
            Period."Period Start" := DimCodeBuf."Period Start";
            ResultSteps := PeriodFormMgt.NextDate(Steps,Period,PeriodType);
            if ResultSteps <> 0 then
              CopyPeriodToBuf(Period,DimCodeBuf);
          end;
        DimOption::Location:
          begin
            Location.Code := DimCodeBuf.Code;
            if LocationFilter <> '' then
              Location.SETFILTER(Code,LocationFilter);
            ResultSteps := Location.NEXT(Steps);
            if ResultSteps <> 0 then
              CopyLocationToBuf(Location,DimCodeBuf);
          end;
      end;
      exit(ResultSteps);
    END;

    LOCAL PROCEDURE CopyDimValueToBuf@1124(VAR TheDimValue@1000 : Record Integer;VAR TheDimCodeBuf@1001 : Record "Dimension Code Buffer");
    BEGIN
      with ItemBuffer do
        case "Line Option" of
          "Line Option"::"Profit Calculation":
            case TheDimValue.Number of
              1:
                InsertRow('1',FIELDCAPTION("Sales (LCY)"),0,false,TheDimCodeBuf);
              2:
                InsertRow('2',FIELDCAPTION("COGS (LCY)"),0,false,TheDimCodeBuf);
              3:
                InsertRow('3',FIELDCAPTION("Non-Invtbl. Costs (LCY)"),0,false,TheDimCodeBuf);
              4:
                InsertRow('4',FIELDCAPTION("Profit (LCY)"),0,false,TheDimCodeBuf);
              5:
                InsertRow('5',FIELDCAPTION("Profit %"),0,false,TheDimCodeBuf);
            end;
          "Line Option"::"Cost Specification":
            case TheDimValue.Number of
              1:
                InsertRow('1',FIELDCAPTION("Inventoriable Costs"),0,true,TheDimCodeBuf);
              2:
                InsertRow('2',FIELDCAPTION("Direct Cost (LCY)"),1,false,TheDimCodeBuf);
              3:
                InsertRow('3',FIELDCAPTION("Revaluation (LCY)"),1,false,TheDimCodeBuf);
              4:
                InsertRow('4',FIELDCAPTION("Rounding (LCY)"),1,false,TheDimCodeBuf);
              5:
                InsertRow('5',FIELDCAPTION("Indirect Cost (LCY)"),1,false,TheDimCodeBuf);
              6:
                InsertRow('6',FIELDCAPTION("Variance (LCY)"),1,false,TheDimCodeBuf);
              7:
                InsertRow('7',FIELDCAPTION("Inventoriable Costs, Total"),0,true,TheDimCodeBuf);
              8:
                InsertRow('8',FIELDCAPTION("COGS (LCY)"),0,true,TheDimCodeBuf);
              9:
                InsertRow('9',FIELDCAPTION("Inventory (LCY)"),0,true,TheDimCodeBuf);
            end;
        end
    END;

    LOCAL PROCEDURE CopyAddChargesToBuf@1125(VAR TheItemCharge@1000 : Record "Item Charge";VAR TheDimCodeBuf@1001 : Record "Dimension Code Buffer");
    BEGIN
      with TheDimCodeBuf do begin
        INIT;
        Code := TheItemCharge."No.";
        Name := COPYSTR(
            STRSUBSTNO('%1 %2',TheItemCharge."No.",TheItemCharge.Description),1,50);
      end;
    END;

    LOCAL PROCEDURE CopyLocationToBuf@1126(VAR TheLocation@1000 : Record Location;VAR TheDimCodeBuf@1001 : Record "Dimension Code Buffer");
    BEGIN
      with TheDimCodeBuf do begin
        INIT;
        Code := TheLocation.Code;
        Name := TheLocation.Name;
      end;
    END;

    LOCAL PROCEDURE CopyPeriodToBuf@1127(VAR ThePeriod@1000 : Record Date;VAR TheDimCodeBuf@1001 : Record "Dimension Code Buffer");
    BEGIN
      with TheDimCodeBuf do begin
        INIT;
        Code := FORMAT(ThePeriod."Period Start");
        "Period Start" := ThePeriod."Period Start";
        "Period End" := ThePeriod."Period End";
        Name := ThePeriod."Period Name";
      end;
    END;

    LOCAL PROCEDURE InsertRow@1128(Code1@1000 : Code[10];Name1@1001 : Text[80];Indentation1@1002 : Integer;Bold1@1003 : Boolean;VAR TheDimCodeBuf@1004 : Record "Dimension Code Buffer");
    BEGIN
      with TheDimCodeBuf do begin
        INIT;
        Code := Code1;
        Name := COPYSTR(Name1,1,MAXSTRLEN(Name));
        Indentation := Indentation1;
        "Show in Bold" := Bold1;
      end;
    END;

    LOCAL PROCEDURE FindPeriod@1129(SearchText@1000 : Code[10]);
    VAR
      Calendar@1130 : Record Date;
      PeriodFormMgt@1131 : Codeunit PeriodFormManagement;
    BEGIN
      if DateFilter <> '' then begin
        Calendar.SETFILTER("Period Start",DateFilter);
        if not PeriodFormMgt.FindDate('+',Calendar,PeriodType) then
          PeriodFormMgt.FindDate('+',Calendar,PeriodType::Day);
        Calendar.SETRANGE("Period Start");
      end;
      PeriodFormMgt.FindDate(SearchText,Calendar,PeriodType);
      with ItemBuffer do
        if AmountType = AmountType::"Net Change" then begin
          SETRANGE("Date Filter",Calendar."Period Start",Calendar."Period End");
          if GETRANGEMIN("Date Filter") = GETRANGEMAX("Date Filter") then
            SETRANGE("Date Filter",GETRANGEMIN("Date Filter"));
        end else
          SETRANGE("Date Filter",0D,Calendar."Period End");
      InternalDateFilter := ItemBuffer.GETFILTER("Date Filter");
    END;

    LOCAL PROCEDURE DrillDown@1139();
    VAR
      ValueEntry@1140 : Record "Value Entry";
    BEGIN
      with ItemBuffer do begin
        ValueEntry.SETCURRENTKEY(
          "Item No.","Posting Date","Item Ledger Entry Type","Entry Type","Variance Type",
          "Item Charge No.","Location Code","Variant Code");
        if GETFILTER("Item Filter") <> '' then
          COPYFILTER("Item Filter",ValueEntry."Item No.");
        if GETFILTER("Date Filter") <> '' then
          COPYFILTER("Date Filter",ValueEntry."Posting Date")
        else
          ValueEntry.SETRANGE("Posting Date",0D,DMY2DATE(31,12,9999));
        if GETFILTER("Entry Type Filter") <> '' then
          COPYFILTER("Entry Type Filter",ValueEntry."Entry Type");
        if GETFILTER("Item Ledger Entry Type Filter") <> '' then
          COPYFILTER("Item Ledger Entry Type Filter",ValueEntry."Item Ledger Entry Type");
        if GETFILTER("Variance Type Filter") <> '' then
          COPYFILTER("Variance Type Filter",ValueEntry."Variance Type");
        if GETFILTER("Item Charge No. Filter") <> '' then
          COPYFILTER("Item Charge No. Filter",ValueEntry."Item Charge No.");
        if GETFILTER("Location Filter") <> '' then
          COPYFILTER("Location Filter",ValueEntry."Location Code");
        if GETFILTER("Variant Filter") <> '' then
          COPYFILTER("Variant Filter",ValueEntry."Variant Code");
        case true of
          (("Line Option" = "Line Option"::"Profit Calculation") and (Name = FIELDCAPTION("Sales (LCY)"))) or
          ("Line Option" = "Line Option"::"Sales Item Charge Spec."):
            PAGE.RUN(0,ValueEntry,ValueEntry."Sales Amount (Actual)");
          Name = FIELDCAPTION("Non-Invtbl. Costs (LCY)"):
            PAGE.RUN(0,ValueEntry,ValueEntry."Cost Amount (Non-Invtbl.)");
          else
            PAGE.RUN(0,ValueEntry,ValueEntry."Cost Amount (Actual)");
        end;
      end;
    END;

    LOCAL PROCEDURE SetCommonFilters@1141(VAR TheItemBuffer@1000 : Record "Item Statistics Buffer");
    BEGIN
      with TheItemBuffer do begin
        RESET;
        if ItemFilter <> '' then
          SETFILTER("Item Filter",ItemFilter);
        if DateFilter <> '' then
          SETFILTER("Date Filter",DateFilter);
        if LocationFilter <> '' then
          SETFILTER("Location Filter",LocationFilter);
        if VariantFilter <> '' then
          SETFILTER("Variant Filter",VariantFilter);
      end;
    END;

    LOCAL PROCEDURE SetFilters@1142(VAR ItemBuffer@1000 : Record "Item Statistics Buffer";LineOrColumn@1001 : 'Line,Column');
    VAR
      DimCodeBuf@1002 : Record "Dimension Code Buffer";
      DimOption@1143 : '"Profit Calculation","Cost Specification","Purch. Item Charge Spec.","Sales Item Charge Spec.",Period,Location';
    BEGIN
      if LineOrColumn = LineOrColumn::Line then begin
        DimCodeBuf := Rec;
        DimOption := ItemBuffer."Line Option";
      end else begin
        DimCodeBuf := MatrixRecords[MATRIX_ColumnOrdinal];
        DimOption := ItemBuffer."Column Option";
      end;
      with ItemBuffer do begin
        case DimOption of
          DimOption::Location:
            SETRANGE("Location Filter",DimCodeBuf.Code);
          DimOption::Period:
            if AmountType = AmountType::"Net Change" then
              SETRANGE("Date Filter",DimCodeBuf."Period Start",DimCodeBuf."Period End")
            else
              SETRANGE("Date Filter",0D,DimCodeBuf."Period End");
          DimOption::"Profit Calculation",
          DimOption::"Cost Specification":
            case Name of
              FIELDCAPTION("Sales (LCY)"),
              FIELDCAPTION("COGS (LCY)"),
              FIELDCAPTION("Profit (LCY)"),
              FIELDCAPTION("Profit %"):
                begin
                  SETRANGE("Item Ledger Entry Type Filter","Item Ledger Entry Type Filter"::Sale);
                  if DimOption = DimOption::"Profit Calculation" then
                    SETFILTER("Entry Type Filter",'<>%1',"Entry Type Filter"::Revaluation);
                  SETRANGE("Variance Type Filter","Variance Type Filter"::" ");
                end;
              FIELDCAPTION("Direct Cost (LCY)"),
              FIELDCAPTION("Revaluation (LCY)"),
              FIELDCAPTION("Rounding (LCY)"),
              FIELDCAPTION("Indirect Cost (LCY)"),
              FIELDCAPTION("Variance (LCY)"),
              FIELDCAPTION("Inventoriable Costs, Total"):
                begin
                  SETFILTER(
                    "Item Ledger Entry Type Filter",'<>%1&<>%2',
                    "Item Ledger Entry Type Filter"::Sale,
                    "Item Ledger Entry Type Filter"::" ");
                  SETRANGE("Variance Type Filter","Variance Type Filter"::" ");
                  case Name of
                    FIELDCAPTION("Direct Cost (LCY)"):
                      SETRANGE("Entry Type Filter","Entry Type Filter"::"Direct Cost");
                    FIELDCAPTION("Revaluation (LCY)"):
                      SETRANGE("Entry Type Filter","Entry Type Filter"::Revaluation);
                    FIELDCAPTION("Rounding (LCY)"):
                      SETRANGE("Entry Type Filter","Entry Type Filter"::Rounding);
                    FIELDCAPTION("Indirect Cost (LCY)"):
                      SETRANGE("Entry Type Filter","Entry Type Filter"::"Indirect Cost");
                    FIELDCAPTION("Variance (LCY)"):
                      begin
                        SETRANGE("Entry Type Filter","Entry Type Filter"::Variance);
                        SETFILTER("Variance Type Filter",'<>%1',"Variance Type Filter"::" ");
                      end;
                    FIELDCAPTION("Inventoriable Costs, Total"):
                      SETRANGE("Variance Type Filter");
                  end;
                end;
              else
                SETRANGE("Item Ledger Entry Type Filter");
                SETRANGE("Variance Type Filter");
            end;
          DimOption::"Purch. Item Charge Spec.":
            begin
              SETRANGE("Variance Type Filter","Variance Type Filter"::" ");
              SETRANGE("Item Ledger Entry Type Filter","Item Ledger Entry Type Filter"::Purchase);
              SETRANGE("Item Charge No. Filter",DimCodeBuf.Code);
            end;
          DimOption::"Sales Item Charge Spec.":
            begin
              SETRANGE("Variance Type Filter","Variance Type Filter"::" ");
              SETRANGE("Item Ledger Entry Type Filter","Item Ledger Entry Type Filter"::Sale);
              SETRANGE("Item Charge No. Filter",DimCodeBuf.Code);
            end;
        end;
        if GETFILTER("Item Ledger Entry Type Filter") = '' then
          SETFILTER(
            "Item Ledger Entry Type Filter",'<>%1',
            "Item Ledger Entry Type Filter"::" ")
      end;
    END;

    LOCAL PROCEDURE Calculate@1147(SetColumnFilter@1000 : Boolean) Amount : Decimal;
    BEGIN
      with ItemBuffer do begin
        case "Line Option" of
          "Line Option"::"Profit Calculation",
          "Line Option"::"Cost Specification":
            case Name of
              FIELDCAPTION("Sales (LCY)"):
                Amount := CalcSalesAmount(SetColumnFilter);
              FIELDCAPTION("COGS (LCY)"):
                Amount := CalcCostAmount(SetColumnFilter);
              FIELDCAPTION("Non-Invtbl. Costs (LCY)"):
                Amount := CalcCostAmountNonInvnt(SetColumnFilter);
              FIELDCAPTION("Profit (LCY)"):
                Amount := CalcSalesAmount(SetColumnFilter) +
                  CalcCostAmount(SetColumnFilter) +
                  CalcCostAmountNonInvnt(SetColumnFilter);
              FIELDCAPTION("Profit %"):
                if CalcSalesAmount(SetColumnFilter) <> 0 then
                  Amount := ROUND(100 * (CalcSalesAmount(SetColumnFilter) +
                                         CalcCostAmount(SetColumnFilter) +
                                         CalcCostAmountNonInvnt(SetColumnFilter)) /
                      CalcSalesAmount(SetColumnFilter))
                else
                  Amount := 0;
              FIELDCAPTION("Direct Cost (LCY)"),FIELDCAPTION("Revaluation (LCY)"),
              FIELDCAPTION("Rounding (LCY)"),FIELDCAPTION("Indirect Cost (LCY)"),
              FIELDCAPTION("Variance (LCY)"),FIELDCAPTION("Inventory (LCY)"),
              FIELDCAPTION("Inventoriable Costs, Total"):
                Amount := CalcCostAmount(SetColumnFilter);
              else
                Amount := 0;
            end;
          "Line Option"::"Sales Item Charge Spec.":
            Amount := CalcSalesAmount(SetColumnFilter);
          "Line Option"::"Purch. Item Charge Spec.":
            Amount := CalcCostAmount(SetColumnFilter);
        end;
        if PerUnit then begin
          if ("Line Option" = "Line Option"::"Profit Calculation") and
             (Name = FIELDCAPTION("Profit %"))
          then
            Qty := 1
          else
            Qty := CalcQty(SetColumnFilter);
          if Qty <> 0 then
            Amount := Amount / ABS(Qty)
          else
            Amount := 0;
        end;
        if Name <> FIELDCAPTION("Profit %") then
          Amount := MatrixMgt.RoundValue(Amount,RoundingFactor);
      end;
    END;

    LOCAL PROCEDURE CalcSalesAmount@1148(SetColumnFilter@1000 : Boolean) : Decimal;
    BEGIN
      SetCommonFilters(ItemBuffer);
      SetFilters(ItemBuffer,0);
      if SetColumnFilter then
        SetFilters(ItemBuffer,1);
      if IncludeExpected then begin
        ItemBuffer.CALCFIELDS("Sales Amount (Actual)","Sales Amount (Expected)");
        exit(ItemBuffer."Sales Amount (Actual)" + ItemBuffer."Sales Amount (Expected)");
      end;
      ItemBuffer.CALCFIELDS("Sales Amount (Actual)");
      exit(ItemBuffer."Sales Amount (Actual)");
    END;

    LOCAL PROCEDURE CalcCostAmount@1149(SetColumnFilter@1000 : Boolean) : Decimal;
    BEGIN
      SetCommonFilters(ItemBuffer);
      SetFilters(ItemBuffer,0);
      if SetColumnFilter then
        SetFilters(ItemBuffer,1);
      if IncludeExpected then begin
        ItemBuffer.CALCFIELDS("Cost Amount (Actual)","Cost Amount (Expected)");
        exit(ItemBuffer."Cost Amount (Actual)" + ItemBuffer."Cost Amount (Expected)");
      end;
      ItemBuffer.CALCFIELDS("Cost Amount (Actual)");
      exit(ItemBuffer."Cost Amount (Actual)");
    END;

    LOCAL PROCEDURE CalcCostAmountNonInvnt@1150(SetColumnFilter@1000 : Boolean) : Decimal;
    VAR
      ValueEntry@1001 : Record "Value Entry";
      TotalCostAmountNonInvnt@1002 : Decimal;
    BEGIN
      SetCommonFilters(ItemBuffer);
      SetFilters(ItemBuffer,0);
      if SetColumnFilter then
        SetFilters(ItemBuffer,1);
      ItemBuffer.SETRANGE("Item Ledger Entry Type Filter");

      COPYValueEntryFILTERS(ValueEntry);
      if ValueEntry.FINDSET then
        repeat
          case ValueEntry."Document Type" of
            ValueEntry."Document Type"::"Purchase Credit Memo":
              TotalCostAmountNonInvnt -= ValueEntry."Cost Amount (Non-Invtbl.)";
            ValueEntry."Document Type"::"Purchase Invoice":
              TotalCostAmountNonInvnt += GetSign(ValueEntry) * ValueEntry."Cost Amount (Non-Invtbl.)"
            else
              TotalCostAmountNonInvnt += ValueEntry."Cost Amount (Non-Invtbl.)";
          end;
        until ValueEntry.NEXT = 0;

      exit(TotalCostAmountNonInvnt);
    END;

    LOCAL PROCEDURE CalcQty@1151(SetColumnFilter@1000 : Boolean) : Decimal;
    BEGIN
      SetCommonFilters(ItemBuffer);
      SetFilters(ItemBuffer,0);
      if SetColumnFilter then
        SetFilters(ItemBuffer,1);
      ItemBuffer.SETRANGE("Entry Type Filter");
      ItemBuffer.SETRANGE("Item Charge No. Filter");
      if IncludeExpected then begin
        ItemBuffer.CALCFIELDS(Quantity);
        exit(ItemBuffer.Quantity);
      end;
      ItemBuffer.CALCFIELDS("Invoiced Quantity");
      exit(ItemBuffer."Invoiced Quantity");
    END;

    [External]
    PROCEDURE SetItem@1152(VAR NewItem@1000 : Record Item);
    BEGIN
      Item.GET(NewItem."No.");
      Item.COPYFILTERS(NewItem);
    END;

    [External]
    PROCEDURE Load@1154(MatrixColumns1@1005 : ARRAY [32] OF Text[1024];VAR MatrixRecords1@1006 : ARRAY [32] OF Record "Dimension Code Buffer";CurrentNoOfMatrixColumns@1007 : Integer;_RoundingFactor@1010 : 'None,"1","1000","1000000"';_PerUnit@1009 : Boolean;_IncludeExpected@1008 : Boolean;_ItemBuffer@1004 : Record "Item Statistics Buffer";_Item@1003 : Record Item;_PeriodType@1002 : 'Day,Week,Month,Quarter,Year,"Accounting Period"';_AmountType@1000 : '"Net Change","Balance at Date"';_ColumnDimCode@1012 : Text[30];_DateFilter@1013 : Text;_ItemFilter@1014 : Text;_LocationFilter@1015 : Text;_VariantFilter@1016 : Text);
    BEGIN
      COPYARRAY(MATRIX_CaptionSet,MatrixColumns1,1);
      COPYARRAY(MatrixRecords,MatrixRecords1,1);
      MATRIX_CurrentNoOfMatrixColumn := CurrentNoOfMatrixColumns;
      RoundingFactor := _RoundingFactor;
      PerUnit := _PerUnit;
      IncludeExpected := _IncludeExpected;
      ItemBuffer := _ItemBuffer;
      Item := _Item;
      PeriodType := _PeriodType;
      AmountType := _AmountType;
      ColumnDimCode := _ColumnDimCode;
      DateFilter := _DateFilter;
      ItemFilter := _ItemFilter;
      LocationFilter := _LocationFilter;
      VariantFilter := _VariantFilter;
      RoundingFactorFormatString := MatrixMgt.GetFormatString(RoundingFactor,false);
    END;

    LOCAL PROCEDURE MATRIX_OnDrillDown@1155(_MATRIX_ColumnOrdinal@1008 : Integer);
    BEGIN
      with ItemBuffer do
        if not (("Line Option" = "Line Option"::"Profit Calculation") and
                ((Name = FIELDCAPTION("Profit (LCY)")) or (Name = FIELDCAPTION("Profit %"))) or
                (("Line Option" = "Line Option"::"Cost Specification") and (Name = FIELDCAPTION("Inventoriable Costs"))))
        then begin
          SetCommonFilters(ItemBuffer);
          SetFilters(ItemBuffer,0);
          MATRIX_ColumnOrdinal := _MATRIX_ColumnOrdinal;
          SetFilters(ItemBuffer,1);
          DrillDown;
        end;
    END;

    LOCAL PROCEDURE MATRIX_OnAfterGetRecord@1157(MATRIX_ColumnOrdinal@1010 : Integer);
    BEGIN
      CellAmount := Calculate(true);
      MATRIX_CellData[MATRIX_ColumnOrdinal] := CellAmount;
    END;

    LOCAL PROCEDURE MATRIX_OnFindRecord@1935(Which@1786 : Text[1024]) : Boolean;
    BEGIN
      exit(FindRec(ItemBuffer."Column Option",MatrixRecord,Which));
    END;

    LOCAL PROCEDURE MATRIX_OnNextRecord@1936(Steps@1787 : Integer) : Integer;
    BEGIN
      exit(NextRec(ItemBuffer."Column Option",MatrixRecord,Steps));
    END;

    LOCAL PROCEDURE NameOnFormat@19039177();
    BEGIN
      NameIndent := Indentation;
    END;

    LOCAL PROCEDURE COPYValueEntryFILTERS@1(VAR ValueEntry@1000 : Record "Value Entry");
    BEGIN
      ValueEntry.SETFILTER("Item No.",ItemFilter);
      ValueEntry.SETFILTER("Variant Code",VariantFilter);

      ValueEntry.SETFILTER("Item Ledger Entry Type",ItemBuffer.GETFILTER("Item Ledger Entry Type Filter"));
      ValueEntry.SETFILTER("Variance Type",ItemBuffer.GETFILTER("Variance Type Filter"));
      ValueEntry.SETFILTER("Entry Type",ItemBuffer.GETFILTER("Entry Type Filter"));
      ValueEntry.SETFILTER("Global Dimension 1 Code",ItemBuffer.GETFILTER("Global Dimension 1 Filter"));
      ValueEntry.SETFILTER("Global Dimension 2 Code",ItemBuffer.GETFILTER("Global Dimension 2 Filter"));
      ValueEntry.SETFILTER("Item Charge No.",ItemBuffer.GETFILTER("Item Charge No. Filter"));
      ValueEntry.SETFILTER("Source Type",ItemBuffer.GETFILTER("Source Type Filter"));
      ValueEntry.SETFILTER("Source Code",ItemBuffer.GETFILTER("Source No. Filter"));
      ValueEntry.SETFILTER("Posting Date",ItemBuffer.GETFILTER("Date Filter"));
      ValueEntry.SETFILTER("Location Code",ItemBuffer.GETFILTER("Location Filter"));
    END;

    LOCAL PROCEDURE GetSign@5(ValueEntry@1000 : Record "Value Entry") : Decimal;
    VAR
      ItemLedgerEntry@1001 : Record "Item Ledger Entry";
    BEGIN
      ItemLedgerEntry.GET(ValueEntry."Item Ledger Entry No.");
      if (ValueEntry."Item Ledger Entry Type" = ValueEntry."Item Ledger Entry Type"::Purchase) and
         (ItemLedgerEntry."Entry Type" = ItemLedgerEntry."Entry Type"::Sale)
      then
        exit(1);
      exit(-1);
    END;

    LOCAL PROCEDURE FormatStr@8() : Text;
    BEGIN
      exit(RoundingFactorFormatString);
    END;

    BEGIN
    END.
  }
}

