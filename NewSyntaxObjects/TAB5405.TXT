OBJECT Table 5405 Production Order
{
  OBJECT-PROPERTIES
  {
    Date=20171006D;
    Time=120000T;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    DataCaptionFields="No.",Description;
    OnInsert=VAR
               InvtAdjmtEntryOrder@1000 : Record "Inventory Adjmt. Entry (Order)";
             BEGIN
               MfgSetup.GET;
               if "No." = '' then begin
                 TestNoSeries;
                 NoSeriesMgt.InitSeries(GetNoSeriesCode,xRec."No. Series","Due Date","No.","No. Series");
               end;

               if Status = Status::Released then begin
                 if ProdOrder.GET(Status::Finished,"No.") then
                   ERROR(Text007,Status,TABLECAPTION,ProdOrder."No.",ProdOrder.Status);
                 InvtAdjmtEntryOrder.SETRANGE("Order Type",InvtAdjmtEntryOrder."Order Type"::Production);
                 InvtAdjmtEntryOrder.SETRANGE("Order No.","No.");
                 if not InvtAdjmtEntryOrder.ISEMPTY then
                   ERROR(Text007,Status,TABLECAPTION,ProdOrder."No.",InvtAdjmtEntryOrder.TABLECAPTION);
               end;

               InitRecord;

               "Starting Time" := MfgSetup."Normal Starting Time";
               "Ending Time" := MfgSetup."Normal Ending Time";
               "Creation Date" := TODAY;
               UpdateDatetime;
             END;

    OnModify=BEGIN
               "Last Date Modified" := TODAY;
               if Status = Status::Finished then
                 ERROR(Text006);
             END;

    OnDelete=VAR
               ItemLedgEntry@1000 : Record "Item Ledger Entry";
               CapLedgEntry@1001 : Record "Capacity Ledger Entry";
               PurchLine@1002 : Record "Purchase Line";
             BEGIN
               if Status = Status::Released then begin
                 ItemLedgEntry.SETRANGE("Order Type",ItemLedgEntry."Order Type"::Production);
                 ItemLedgEntry.SETRANGE("Order No.","No.");
                 if not ItemLedgEntry.ISEMPTY then
                   ERROR(
                     Text000,
                     Status,TABLECAPTION,"No.",ItemLedgEntry.TABLECAPTION);

                 CapLedgEntry.SETRANGE("Order Type",CapLedgEntry."Order Type"::Production);
                 CapLedgEntry.SETRANGE("Order No.","No.");
                 if not CapLedgEntry.ISEMPTY then
                   ERROR(
                     Text000,
                     Status,TABLECAPTION,"No.",CapLedgEntry.TABLECAPTION);
               end;

               if Status in [Status::Released,Status::Finished] then begin
                 PurchLine.SETRANGE("Document Type",PurchLine."Document Type"::Order);
                 PurchLine.SETRANGE(Type,PurchLine.Type::Item);
                 PurchLine.SETRANGE("Prod. Order No.","No.");
                 if not PurchLine.ISEMPTY then
                   ERROR(
                     Text000,
                     Status,TABLECAPTION,"No.",PurchLine.TABLECAPTION);
               end;

               if Status = Status::Finished then
                 DeleteFnshdProdOrderRelations
               else
                 DeleteRelations;
             END;

    OnRename=BEGIN
               ERROR(Text001,TABLECAPTION);
             END;

    CaptionML=ENU=Production Order;
    LookupPageID="Production Order List";
    DrillDownPageID="Production Order List";
  }
  FIELDS
  {
    { 1   ;   ;Status              ;Option        ;CaptionML=ENU=Status;
                                                   OptionCaptionML=ENU=Simulated,Planned,Firm Planned,Released,Finished;
                                                   OptionString=Simulated,Planned,"Firm Planned",Released,Finished }
    { 2   ;   ;No.                 ;Code20        ;TableRelation="Production Order"."No." WHERE (Status=FIELD(Status));
                                                   AltSearchField=Search Description;
                                                   OnValidate=BEGIN
                                                                if "No." <> xRec."No." then begin
                                                                  MfgSetup.GET;
                                                                  NoSeriesMgt.TestManual(GetNoSeriesCode);
                                                                  "No. Series" := '';
                                                                end;
                                                              END;

                                                   ValidateTableRelation=false;
                                                   CaptionML=ENU=No. }
    { 3   ;   ;Description         ;Text50        ;OnValidate=BEGIN
                                                                "Search Description" := Description;
                                                              END;

                                                   CaptionML=ENU=Description }
    { 4   ;   ;Search Description  ;Code50        ;CaptionML=ENU=Search Description }
    { 5   ;   ;Description 2       ;Text50        ;CaptionML=ENU=Description 2 }
    { 6   ;   ;Creation Date       ;Date          ;CaptionML=ENU=Creation Date;
                                                   Editable=false }
    { 7   ;   ;Last Date Modified  ;Date          ;CaptionML=ENU=Last Date Modified;
                                                   Editable=false }
    { 9   ;   ;Source Type         ;Option        ;OnValidate=BEGIN
                                                                if "Source Type" <> xRec."Source Type" then
                                                                  CheckProdOrderStatus(FIELDCAPTION("Source Type"));
                                                              END;

                                                   CaptionML=ENU=Source Type;
                                                   OptionCaptionML=ENU=Item,Family,Sales Header;
                                                   OptionString=Item,Family,"Sales Header" }
    { 10  ;   ;Source No.          ;Code20        ;TableRelation=IF ("Source Type"=CONST(Item)) Item WHERE (Type=CONST(Inventory))
                                                                 ELSE IF ("Source Type"=CONST(Family)) Family
                                                                 ELSE IF (Status=CONST(Simulated),
                                                                          "Source Type"=CONST("Sales Header")) "Sales Header"."No." WHERE ("Document Type"=CONST(Quote))
                                                                          ELSE IF (Status=FILTER(Planned..),
                                                                                   "Source Type"=CONST("Sales Header")) "Sales Header"."No." WHERE ("Document Type"=CONST(Order));
                                                   OnValidate=VAR
                                                                Item@1000 : Record Item;
                                                                Family@1001 : Record Family;
                                                                SalesHeader@1002 : Record "Sales Header";
                                                              BEGIN
                                                                if "Source No." <> xRec."Source No." then
                                                                  CheckProdOrderStatus(FIELDCAPTION("Source No."));

                                                                if "Source No." = '' then
                                                                  exit;

                                                                case "Source Type" of
                                                                  "Source Type"::Item:
                                                                    begin
                                                                      Item.GET("Source No.");
                                                                      Item.TESTFIELD(Blocked,false);
                                                                      Description := Item.Description;
                                                                      "Description 2" := Item."Description 2";
                                                                      "Routing No." := Item."Routing No.";
                                                                      "Inventory Posting Group" := Item."Inventory Posting Group";
                                                                      "Gen. Prod. Posting Group" := Item."Gen. Prod. Posting Group";
                                                                      "Unit Cost" := Item."Unit Cost";
                                                                      CreateDim(DATABASE::Item,"Source No.");
                                                                    end;
                                                                  "Source Type"::Family:
                                                                    begin
                                                                      Family.GET("Source No.");
                                                                      Description := Family.Description;
                                                                      "Description 2" := Family."Description 2";
                                                                      "Routing No." := Family."Routing No.";
                                                                      "Inventory Posting Group" := '';
                                                                      "Gen. Prod. Posting Group" := '';
                                                                      "Unit Cost" := 0;
                                                                    end;
                                                                  "Source Type"::"Sales Header":
                                                                    begin
                                                                      if Status = Status::Simulated then
                                                                        SalesHeader.GET(SalesHeader."Document Type"::Quote,"Source No.")
                                                                      else
                                                                        SalesHeader.GET(SalesHeader."Document Type"::Order,"Source No.");
                                                                      Description := SalesHeader."Ship-to Name";
                                                                      "Description 2" := SalesHeader."Ship-to Name 2";
                                                                      "Routing No." := '';
                                                                      "Inventory Posting Group" := '';
                                                                      "Gen. Prod. Posting Group" := '';
                                                                      "Gen. Bus. Posting Group" := SalesHeader."Gen. Bus. Posting Group";
                                                                      "Unit Cost" := 0;
                                                                      "Location Code" := SalesHeader."Location Code";
                                                                      "Due Date" := SalesHeader."Shipment Date";
                                                                      "Ending Date" := SalesHeader."Shipment Date";
                                                                      "Dimension Set ID" := SalesHeader."Dimension Set ID";
                                                                      "Shortcut Dimension 1 Code" := SalesHeader."Shortcut Dimension 1 Code";
                                                                      "Shortcut Dimension 2 Code" := SalesHeader."Shortcut Dimension 2 Code";
                                                                    end;
                                                                end;
                                                                VALIDATE(Description);
                                                                InitRecord;
                                                                UpdateDatetime;
                                                              END;

                                                   CaptionML=ENU=Source No. }
    { 11  ;   ;Routing No.         ;Code20        ;TableRelation="Routing Header";
                                                   CaptionML=ENU=Routing No. }
    { 15  ;   ;Inventory Posting Group;Code20     ;TableRelation="Inventory Posting Group";
                                                   CaptionML=ENU=Inventory Posting Group }
    { 16  ;   ;Gen. Prod. Posting Group;Code20    ;TableRelation="Gen. Product Posting Group";
                                                   CaptionML=ENU=Gen. Prod. Posting Group }
    { 17  ;   ;Gen. Bus. Posting Group;Code20     ;TableRelation="Gen. Business Posting Group";
                                                   CaptionML=ENU=Gen. Bus. Posting Group }
    { 19  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Prod. Order Comment Line" WHERE (Status=FIELD(Status),
                                                                                                       "Prod. Order No."=FIELD("No.")));
                                                   CaptionML=ENU=Comment;
                                                   Editable=false }
    { 20  ;   ;Starting Time       ;Time          ;OnValidate=BEGIN
                                                                ProdOrderLine.SETCURRENTKEY(Status,"Prod. Order No.","Planning Level Code");
                                                                ProdOrderLine.ASCENDING(false);
                                                                ProdOrderLine.SETRANGE(Status,Status);
                                                                ProdOrderLine.SETRANGE("Prod. Order No.","No.");
                                                                ProdOrderLine.SETFILTER("Item No.",'<>%1','');
                                                                ProdOrderLine.SETFILTER("Planning Level Code",'>%1',0);
                                                                if ProdOrderLine.FIND('-') then begin
                                                                  "Starting Date-Time" := CREATEDATETIME("Starting Date","Starting Time");
                                                                  MODIFY;
                                                                  MultiLevelMessage;
                                                                  exit;
                                                                end;
                                                                "Due Date" := 0D;
                                                                ProdOrderLine.SETRANGE("Planning Level Code");
                                                                if ProdOrderLine.FIND('-') then
                                                                  repeat
                                                                    ProdOrderLine."Starting Time" := "Starting Time";
                                                                    ProdOrderLine."Starting Date" := "Starting Date";
                                                                    ProdOrderLine.MODIFY;
                                                                    CalcProdOrder.SetParameter(true);
                                                                    CalcProdOrder.Recalculate(ProdOrderLine,0,true);
                                                                    if ProdOrderLine."Planning Level Code" > 0 then
                                                                      ProdOrderLine."Due Date" := ProdOrderLine."Ending Date"
                                                                    else
                                                                      ProdOrderLine."Due Date" :=
                                                                        LeadTimeMgt.PlannedDueDate(
                                                                          ProdOrderLine."Item No.",
                                                                          ProdOrderLine."Location Code",
                                                                          ProdOrderLine."Variant Code",
                                                                          ProdOrderLine."Ending Date",
                                                                          '',
                                                                          2);

                                                                    if "Due Date" = 0D then
                                                                      "Due Date" := ProdOrderLine."Due Date";
                                                                    "Starting Date-Time" := CREATEDATETIME("Starting Date","Starting Time");
                                                                    ProdOrderLine.MODIFY(true);
                                                                    ProdOrderLine.CheckEndingDate(CurrFieldNo <> 0);
                                                                  until ProdOrderLine.NEXT = 0
                                                                else begin
                                                                  "Ending Date" := "Starting Date";
                                                                  "Ending Time" := "Starting Time";
                                                                end;
                                                                AdjustStartEndingDate;
                                                                MODIFY;
                                                              END;

                                                   CaptionML=ENU=Starting Time }
    { 21  ;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                VALIDATE("Starting Time");
                                                              END;

                                                   CaptionML=ENU=Starting Date }
    { 22  ;   ;Ending Time         ;Time          ;OnValidate=BEGIN
                                                                ProdOrderLine.SETCURRENTKEY(Status,"Prod. Order No.","Planning Level Code");
                                                                ProdOrderLine.ASCENDING(true);
                                                                ProdOrderLine.SETRANGE(Status,Status);
                                                                ProdOrderLine.SETRANGE("Prod. Order No.","No.");
                                                                ProdOrderLine.SETFILTER("Item No.",'<>%1','');
                                                                ProdOrderLine.SETFILTER("Planning Level Code",'>%1',0);
                                                                if ProdOrderLine.FIND('-') then begin
                                                                  "Ending Date-Time" := CREATEDATETIME("Ending Date","Ending Time");
                                                                  MODIFY;
                                                                  MultiLevelMessage;
                                                                  exit;
                                                                end;
                                                                "Due Date" := 0D;
                                                                ProdOrderLine.SETRANGE("Planning Level Code");
                                                                if ProdOrderLine.FIND('-') then
                                                                  repeat
                                                                    ProdOrderLine."Ending Time" := "Ending Time";
                                                                    ProdOrderLine."Ending Date" := "Ending Date";
                                                                    ProdOrderLine.MODIFY;
                                                                    CalcProdOrder.SetParameter(true);
                                                                    CalcProdOrder.Recalculate(ProdOrderLine,1,true);
                                                                    if ProdOrderLine."Planning Level Code" > 0 then
                                                                      ProdOrderLine."Due Date" := ProdOrderLine."Ending Date"
                                                                    else
                                                                      ProdOrderLine."Due Date" :=
                                                                        LeadTimeMgt.PlannedDueDate(
                                                                          ProdOrderLine."Item No.",
                                                                          ProdOrderLine."Location Code",
                                                                          ProdOrderLine."Variant Code",
                                                                          ProdOrderLine."Ending Date",
                                                                          '',
                                                                          2);
                                                                    if "Due Date" = 0D then
                                                                      "Due Date" := ProdOrderLine."Due Date";
                                                                    "Ending Date-Time" := CREATEDATETIME("Ending Date","Ending Time");
                                                                    ProdOrderLine.MODIFY(true);
                                                                    ProdOrderLine.CheckEndingDate(CurrFieldNo <> 0);
                                                                  until ProdOrderLine.NEXT = 0
                                                                else begin
                                                                  "Starting Date" := "Ending Date";
                                                                  "Starting Time" := "Ending Time";
                                                                end;
                                                                AdjustStartEndingDate;
                                                                MODIFY;
                                                              END;

                                                   CaptionML=ENU=Ending Time }
    { 23  ;   ;Ending Date         ;Date          ;OnValidate=BEGIN
                                                                VALIDATE("Ending Time");
                                                              END;

                                                   CaptionML=ENU=Ending Date }
    { 24  ;   ;Due Date            ;Date          ;OnValidate=BEGIN
                                                                if "Due Date" = 0D then
                                                                  exit;
                                                                if (CurrFieldNo = FIELDNO("Due Date")) or
                                                                   (CurrFieldNo = FIELDNO("Location Code")) or
                                                                   UpdateEndDate
                                                                then begin
                                                                  ProdOrderLine.SETCURRENTKEY(Status,"Prod. Order No.","Planning Level Code");
                                                                  ProdOrderLine.ASCENDING(true);
                                                                  ProdOrderLine.SETRANGE(Status,Status);
                                                                  ProdOrderLine.SETRANGE("Prod. Order No.","No.");
                                                                  ProdOrderLine.SETFILTER("Item No.",'<>%1','');
                                                                  ProdOrderLine.SETFILTER("Planning Level Code",'>%1',0);
                                                                  if not ProdOrderLine.ISEMPTY then begin
                                                                    ProdOrderLine.SETRANGE("Planning Level Code",0);
                                                                    if "Source Type" = "Source Type"::Family then begin
                                                                      UpdateEndingDate(ProdOrderLine);
                                                                    end else begin
                                                                      if ProdOrderLine.FIND('-') then
                                                                        "Ending Date" :=
                                                                          LeadTimeMgt.PlannedEndingDate(ProdOrderLine."Item No.","Location Code",'',"Due Date",'',2)
                                                                      else
                                                                        "Ending Date" := "Due Date";
                                                                      "Ending Date-Time" := CREATEDATETIME("Ending Date","Ending Time");
                                                                      MultiLevelMessage;
                                                                      exit;
                                                                    end;
                                                                  end else begin
                                                                    ProdOrderLine.SETRANGE("Planning Level Code");
                                                                    if not ProdOrderLine.ISEMPTY then
                                                                      UpdateEndingDate(ProdOrderLine)
                                                                    else begin
                                                                      if "Source Type" = "Source Type"::Item then
                                                                        "Ending Date" :=
                                                                          LeadTimeMgt.PlannedEndingDate(
                                                                            "Source No.",
                                                                            "Location Code",
                                                                            '',
                                                                            "Due Date",
                                                                            '',
                                                                            2)
                                                                      else
                                                                        "Ending Date" := "Due Date";
                                                                      "Starting Date" := "Ending Date";
                                                                      "Starting Date-Time" := CREATEDATETIME("Starting Date","Starting Time");
                                                                      "Ending Date-Time" := CREATEDATETIME("Ending Date","Ending Time");
                                                                    end;
                                                                    AdjustStartEndingDate;
                                                                    MODIFY;
                                                                  end;
                                                                end;
                                                              END;

                                                   CaptionML=ENU=Due Date }
    { 25  ;   ;Finished Date       ;Date          ;CaptionML=ENU=Finished Date;
                                                   Editable=false }
    { 28  ;   ;Blocked             ;Boolean       ;CaptionML=ENU=Blocked }
    { 30  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE ("Global Dimension No."=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=ENU=Shortcut Dimension 1 Code;
                                                   CaptionClass='1,2,1' }
    { 31  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE ("Global Dimension No."=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=ENU=Shortcut Dimension 2 Code;
                                                   CaptionClass='1,2,2' }
    { 32  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE ("Use As In-Transit"=CONST(false));
                                                   OnValidate=BEGIN
                                                                GetDefaultBin;

                                                                VALIDATE("Due Date"); // Scheduling consider Calendar assigned to Location
                                                              END;

                                                   CaptionML=ENU=Location Code }
    { 33  ;   ;Bin Code            ;Code20        ;TableRelation=IF ("Source Type"=CONST(Item)) Bin.Code WHERE ("Location Code"=FIELD("Location Code"),
                                                                                                                "Item Filter"=FIELD("Source No."))
                                                                                                                ELSE IF ("Source Type"=FILTER(<>Item)) Bin.Code WHERE ("Location Code"=FIELD("Location Code"));
                                                   OnValidate=VAR
                                                                WhseIntegrationMgt@1000 : Codeunit "Whse. Integration Management";
                                                              BEGIN
                                                                if "Bin Code" <> '' then
                                                                  WhseIntegrationMgt.CheckBinTypeCode(DATABASE::"Production Order",
                                                                    FIELDCAPTION("Bin Code"),
                                                                    "Location Code",
                                                                    "Bin Code",0);
                                                              END;

                                                   CaptionML=ENU=Bin Code }
    { 34  ;   ;Replan Ref. No.     ;Code20        ;CaptionML=ENU=Replan Ref. No.;
                                                   Editable=false }
    { 35  ;   ;Replan Ref. Status  ;Option        ;CaptionML=ENU=Replan Ref. Status;
                                                   OptionCaptionML=ENU=Simulated,Planned,Firm Planned,Released,Finished;
                                                   OptionString=Simulated,Planned,"Firm Planned",Released,Finished;
                                                   Editable=false }
    { 38  ;   ;Low-Level Code      ;Integer       ;CaptionML=ENU=Low-Level Code;
                                                   Editable=false }
    { 40  ;   ;Quantity            ;Decimal       ;OnValidate=BEGIN
                                                                if "Source Type" = "Source Type"::Item then
                                                                  "Cost Amount" := ROUND(Quantity * "Unit Cost")
                                                                else
                                                                  "Cost Amount" := 0;
                                                              END;

                                                   CaptionML=ENU=Quantity;
                                                   DecimalPlaces=0:5;
                                                   MinValue=0 }
    { 41  ;   ;Unit Cost           ;Decimal       ;CaptionML=ENU=Unit Cost;
                                                   DecimalPlaces=2:5 }
    { 42  ;   ;Cost Amount         ;Decimal       ;CaptionML=ENU=Cost Amount;
                                                   DecimalPlaces=2:2 }
    { 47  ;   ;Work Center Filter  ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation="Work Center";
                                                   CaptionML=ENU=Work Center Filter }
    { 48  ;   ;Capacity Type Filter;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Capacity Type Filter;
                                                   OptionCaptionML=ENU=Work Center,Machine Center;
                                                   OptionString="Work Center","Machine Center" }
    { 49  ;   ;Capacity No. Filter ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=IF ("Capacity Type Filter"=CONST("Work Center")) "Machine Center"
                                                                 ELSE IF ("Capacity Type Filter"=CONST("Machine Center")) "Work Center";
                                                   CaptionML=ENU=Capacity No. Filter }
    { 50  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Date Filter }
    { 51  ;   ;Expected Operation Cost Amt.;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Routing Line"."Expected Operation Cost Amt." WHERE (Status=FIELD(Status),
                                                                                                                                    "Prod. Order No."=FIELD("No.")));
                                                   CaptionML=ENU=Expected Operation Cost Amt.;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 52  ;   ;Expected Component Cost Amt.;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Component"."Cost Amount" WHERE (Status=FIELD(Status),
                                                                                                                "Prod. Order No."=FIELD("No."),
                                                                                                                "Due Date"=FIELD("Date Filter")));
                                                   CaptionML=ENU=Expected Component Cost Amt.;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 55  ;   ;Actual Time Used    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Capacity Ledger Entry".Quantity WHERE ("Order Type"=CONST(Production),
                                                                                                           "Order No."=FIELD("No."),
                                                                                                           Type=FIELD("Capacity Type Filter"),
                                                                                                           "No."=FIELD("Capacity No. Filter"),
                                                                                                           "Posting Date"=FIELD("Date Filter")));
                                                   CaptionML=ENU=Actual Time Used;
                                                   DecimalPlaces=0:5;
                                                   Editable=false }
    { 56  ;   ;Allocated Capacity Need;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Capacity Need"."Needed Time" WHERE (Status=FIELD(Status),
                                                                                                                    "Prod. Order No."=FIELD("No."),
                                                                                                                    Type=FIELD("Capacity Type Filter"),
                                                                                                                    "No."=FIELD("Capacity No. Filter"),
                                                                                                                    "Work Center No."=FIELD("Work Center Filter"),
                                                                                                                    Date=FIELD("Date Filter"),
                                                                                                                    "Requested Only"=CONST(false)));
                                                   CaptionML=ENU=Allocated Capacity Need;
                                                   DecimalPlaces=0:5;
                                                   Editable=false }
    { 57  ;   ;Expected Capacity Need;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Capacity Need"."Needed Time" WHERE (Status=FIELD(Status),
                                                                                                                    "Prod. Order No."=FIELD("No."),
                                                                                                                    Type=FIELD("Capacity Type Filter"),
                                                                                                                    "No."=FIELD("Capacity No. Filter"),
                                                                                                                    "Work Center No."=FIELD("Work Center Filter"),
                                                                                                                    Date=FIELD("Date Filter"),
                                                                                                                    "Requested Only"=CONST(false)));
                                                   CaptionML=ENU=Expected Capacity Need;
                                                   DecimalPlaces=0:5;
                                                   Editable=false }
    { 80  ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   CaptionML=ENU=No. Series;
                                                   Editable=false }
    { 82  ;   ;Planned Order No.   ;Code20        ;CaptionML=ENU=Planned Order No. }
    { 83  ;   ;Firm Planned Order No.;Code20      ;CaptionML=ENU=Firm Planned Order No. }
    { 85  ;   ;Simulated Order No. ;Code20        ;CaptionML=ENU=Simulated Order No. }
    { 92  ;   ;Expected Material Ovhd. Cost;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Component"."Overhead Amount" WHERE (Status=FIELD(Status),
                                                                                                                    "Prod. Order No."=FIELD("No.")));
                                                   CaptionML=ENU=Expected Material Ovhd. Cost;
                                                   DecimalPlaces=2:2;
                                                   Editable=false }
    { 94  ;   ;Expected Capacity Ovhd. Cost;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Prod. Order Routing Line"."Expected Capacity Ovhd. Cost" WHERE (Status=FIELD(Status),
                                                                                                                                    "Prod. Order No."=FIELD("No.")));
                                                   CaptionML=ENU=Expected Capacity Ovhd. Cost;
                                                   Editable=false;
                                                   AutoFormatType=1 }
    { 98  ;   ;Starting Date-Time  ;DateTime      ;OnValidate=BEGIN
                                                                "Starting Date" := DT2DATE("Starting Date-Time");
                                                                "Starting Time" := DT2TIME("Starting Date-Time");
                                                                VALIDATE("Starting Time");
                                                              END;

                                                   CaptionML=ENU=Starting Date-Time }
    { 99  ;   ;Ending Date-Time    ;DateTime      ;OnValidate=BEGIN
                                                                "Ending Date" := DT2DATE("Ending Date-Time");
                                                                "Ending Time" := DT2TIME("Ending Date-Time");
                                                                VALIDATE("Ending Time");
                                                              END;

                                                   CaptionML=ENU=Ending Date-Time }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnValidate=BEGIN
                                                                DimMgt.UpdateGlobalDimFromDimSetID("Dimension Set ID","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
                                                              END;

                                                   OnLookup=BEGIN
                                                              ShowDocDim;
                                                            END;

                                                   CaptionML=ENU=Dimension Set ID;
                                                   Editable=false }
    { 7300;   ;Completely Picked   ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Min("Prod. Order Component"."Completely Picked" WHERE (Status=FIELD(Status),
                                                                                                                      "Prod. Order No."=FIELD("No."),
                                                                                                                      "Supplied-by Line No."=FILTER(0)));
                                                   CaptionML=ENU=Completely Picked }
    { 9000;   ;Assigned User ID    ;Code50        ;TableRelation="User Setup";
                                                   CaptionML=ENU=Assigned User ID }
  }
  KEYS
  {
    {    ;Status,"No."                            ;Clustered=true }
    {    ;"No.",Status                             }
    {    ;"Search Description"                     }
    {    ;"Low-Level Code","Replan Ref. No.","Replan Ref. Status" }
    { false;"Source Type","Source No."             }
    {    ;Description                              }
    {    ;"Source No."                             }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;"No.",Description,"Source No.","Source Type" }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst '@@@="%1 = Document status; %2 = Table caption; %3 = Field value; %4 = Table Caption";ENU=You cannot delete %1 %2 %3 because there is at least one %4 associated with it.';
      Text001@1001 : TextConst 'ENU=You cannot rename a %1.';
      Text002@1002 : TextConst '@@@="%1 = Field caption; %2 = Document status; %3 = Table caption; %4 = Field value; %5 = Table Caption";ENU=You cannot change %1 on %2 %3 %4 because there is at least one %5 associated with it.';
      Text003@1003 : TextConst 'ENU=The production order contains lines connected in a multi-level structure and the production order lines have not been automatically rescheduled.\';
      Text005@1005 : TextConst 'ENU=Use Refresh if you want to reschedule the lines.';
      MfgSetup@1006 : Record "Manufacturing Setup";
      ProdOrder@1007 : Record "Production Order";
      ProdOrderLine@1008 : Record "Prod. Order Line";
      Location@1004 : Record Location;
      NoSeriesMgt@1010 : Codeunit NoSeriesManagement;
      CalcProdOrder@1011 : Codeunit "Calculate Prod. Order";
      LeadTimeMgt@1013 : Codeunit "Lead-Time Management";
      DimMgt@1014 : Codeunit DimensionManagement;
      Text006@1016 : TextConst 'ENU=A Finished Production Order cannot be modified.';
      Text007@1017 : TextConst 'ENU=%1 %2 %3 cannot be created, because a %4 %2 %3 already exists.';
      ItemTrackingMgt@1020 : Codeunit "Item Tracking Management";
      CalendarMgt@1025 : Codeunit CalendarManagement;
      HideValidationDialog@1018 : Boolean;
      Text008@1019 : TextConst 'ENU=Nothing to handle.';
      UpdateEndDate@1012 : Boolean;
      Text010@1023 : TextConst 'ENU=You may have changed a dimension.\\Do you want to update the lines?';
      Text011@1024 : TextConst 'ENU=You cannot change Finished Production Order dimensions.';

    [External]
    PROCEDURE InitRecord@10();
    BEGIN
      if "Due Date" = 0D then
        VALIDATE("Due Date",WORKDATE);
      if ("Source Type" = "Source Type"::Item) and ("Source No." <> '') then
        "Ending Date" :=
          LeadTimeMgt.PlannedEndingDate(
            "Source No.",
            "Location Code",
            '',
            "Due Date",
            '',
            2)
      else
        "Ending Date" := "Due Date";
      "Starting Date" := "Ending Date";
      "Starting Date-Time" := CREATEDATETIME("Starting Date","Starting Time");
      "Ending Date-Time" := CREATEDATETIME("Ending Date","Ending Time");
    END;

    [External]
    PROCEDURE TestNoSeries@5();
    BEGIN
      MfgSetup.GET;

      case Status of
        Status::Simulated:
          MfgSetup.TESTFIELD("Simulated Order Nos.");
        Status::Planned:
          MfgSetup.TESTFIELD("Planned Order Nos.");
        Status::"Firm Planned":
          MfgSetup.TESTFIELD("Firm Planned Order Nos.");
        Status::Released:
          MfgSetup.TESTFIELD("Released Order Nos.");
      end;
    END;

    [External]
    PROCEDURE AssistEdit@7(OldProdOrder@1000 : Record "Production Order") : Boolean;
    BEGIN
      with ProdOrder do begin
        ProdOrder := Rec;
        MfgSetup.GET;
        TestNoSeries;
        if NoSeriesMgt.SelectSeries(GetNoSeriesCode,OldProdOrder."No. Series","No. Series") then begin
          NoSeriesMgt.SetSeries("No.");
          Rec := ProdOrder;
          exit(true);
        end;
      end;
    END;

    [External]
    PROCEDURE GetNoSeriesCode@6() : Code[10];
    BEGIN
      MfgSetup.GET;

      case Status of
        Status::Simulated:
          exit(MfgSetup."Simulated Order Nos.");
        Status::Planned:
          exit(MfgSetup."Planned Order Nos.");
        Status::"Firm Planned":
          exit(MfgSetup."Firm Planned Order Nos.");
        Status::Released:
          exit(MfgSetup."Released Order Nos.");
      end;
    END;

    LOCAL PROCEDURE CheckProdOrderStatus@3(Name@1000 : Text[80]);
    VAR
      ItemLedgEntry@1001 : Record "Item Ledger Entry";
      CapLedgEntry@1002 : Record "Capacity Ledger Entry";
    BEGIN
      if Status <> Status::Released then
        exit;

      if Status in [Status::Released,Status::Finished] then begin
        ItemLedgEntry.SETRANGE("Order Type",ItemLedgEntry."Order Type"::Production);
        ItemLedgEntry.SETRANGE("Order No.","No.");
        if not ItemLedgEntry.ISEMPTY then
          ERROR(
            Text002,
            Name,Status,TABLECAPTION,"No.",ItemLedgEntry.TABLECAPTION);

        CapLedgEntry.SETRANGE("Order Type",CapLedgEntry."Order Type"::Production);
        CapLedgEntry.SETRANGE("Order No.","No.");
        if not CapLedgEntry.ISEMPTY then
          ERROR(
            Text002,
            Name,Status,TABLECAPTION,"No.",CapLedgEntry.TABLECAPTION);
      end;
    END;

    LOCAL PROCEDURE DeleteRelations@2();
    VAR
      ProdOrderComment@1000 : Record "Prod. Order Comment Line";
      WhseRequest@1001 : Record "Whse. Pick Request";
      ReservMgt@1002 : Codeunit "Reservation Management";
    BEGIN
      ProdOrderComment.SETRANGE(Status,Status);
      ProdOrderComment.SETRANGE("Prod. Order No.","No.");
      ProdOrderComment.DELETEALL;

      ReservMgt.DeleteDocumentReservation(DATABASE::"Prod. Order Line",Status,"No.",HideValidationDialog);

      ProdOrderLine.LOCKTABLE;
      ProdOrderLine.SETRANGE(Status,Status);
      ProdOrderLine.SETRANGE("Prod. Order No.","No.");
      ProdOrderLine.DELETEALL(true);

      WhseRequest.SETRANGE("Document Type",WhseRequest."Document Type"::Production);
      WhseRequest.SETRANGE("Document Subtype",Status);
      WhseRequest.SETRANGE("Document No.","No.");
      if not WhseRequest.ISEMPTY then
        WhseRequest.DELETEALL(true);
      ItemTrackingMgt.DeleteWhseItemTrkgLines(
        DATABASE::"Prod. Order Component",Status,"No.",'',0,0,'',false);
    END;

    LOCAL PROCEDURE DeleteFnshdProdOrderRelations@12();
    VAR
      FnshdProdOrderRtngLine@1001 : Record "Prod. Order Routing Line";
      FnshdProdOrderLine@1003 : Record "Prod. Order Line";
      FnshdProdOrderComp@1004 : Record "Prod. Order Component";
      FnshdProdOrderRtngTool@1005 : Record "Prod. Order Routing Tool";
      FnshdProdOrderRtngPers@1006 : Record "Prod. Order Routing Personnel";
      FnshdProdOrderRtngQltyMeas@1007 : Record "Prod. Order Rtng Qlty Meas.";
      FnshdProdOrderComment@1008 : Record "Prod. Order Comment Line";
      FnshdProdOrderRtngCmt@1009 : Record "Prod. Order Rtng Comment Line";
      FnshdProdOrderBOMComment@1010 : Record "Prod. Order Comp. Cmt Line";
    BEGIN
      FnshdProdOrderRtngLine.SETRANGE(Status,Status);
      FnshdProdOrderRtngLine.SETRANGE("Prod. Order No.","No.");
      FnshdProdOrderRtngLine.DELETEALL;

      FnshdProdOrderLine.SETRANGE(Status,Status);
      FnshdProdOrderLine.SETRANGE("Prod. Order No.","No.");
      FnshdProdOrderLine.DELETEALL;

      FnshdProdOrderComp.SETRANGE(Status,Status);
      FnshdProdOrderComp.SETRANGE("Prod. Order No.","No.");
      FnshdProdOrderComp.DELETEALL;

      FnshdProdOrderRtngTool.SETRANGE(Status,Status);
      FnshdProdOrderRtngTool.SETRANGE("Prod. Order No.","No.");
      FnshdProdOrderRtngTool.DELETEALL;

      FnshdProdOrderRtngPers.SETRANGE(Status,Status);
      FnshdProdOrderRtngPers.SETRANGE("Prod. Order No.","No.");
      FnshdProdOrderRtngPers.DELETEALL;

      FnshdProdOrderRtngQltyMeas.SETRANGE(Status,Status);
      FnshdProdOrderRtngQltyMeas.SETRANGE("Prod. Order No.","No.");
      FnshdProdOrderRtngQltyMeas.DELETEALL;

      FnshdProdOrderComment.SETRANGE(Status,Status);
      FnshdProdOrderComment.SETRANGE("Prod. Order No.","No.");
      FnshdProdOrderComment.DELETEALL;

      FnshdProdOrderRtngCmt.SETRANGE(Status,Status);
      FnshdProdOrderRtngCmt.SETRANGE("Prod. Order No.","No.");
      FnshdProdOrderRtngCmt.DELETEALL;

      FnshdProdOrderBOMComment.SETRANGE(Status,Status);
      FnshdProdOrderBOMComment.SETRANGE("Prod. Order No.","No.");
      FnshdProdOrderBOMComment.DELETEALL;
    END;

    LOCAL PROCEDURE AdjustStartEndingDate@1();
    BEGIN
      ProdOrderLine.RESET;
      ProdOrderLine.SETRANGE(Status,Status);
      ProdOrderLine.SETRANGE("Prod. Order No.","No.");

      if not ProdOrderLine.FIND('-') then
        exit;

      "Starting Date" := CalendarMgt.GetMaxDate;
      "Starting Time" := 235959T;
      "Ending Date" := 0D;
      "Ending Time" := 000000T;

      repeat
        if (ProdOrderLine."Starting Date" < "Starting Date") or
           ((ProdOrderLine."Starting Date" = "Starting Date") and
            (ProdOrderLine."Starting Time" < "Starting Time"))
        then begin
          "Starting Time" := ProdOrderLine."Starting Time";
          "Starting Date" := ProdOrderLine."Starting Date";
        end;
        if (ProdOrderLine."Ending Date" > "Ending Date") or
           ((ProdOrderLine."Ending Date" = "Ending Date") and
            (ProdOrderLine."Ending Time" > "Ending Time"))
        then begin
          "Ending Time" := ProdOrderLine."Ending Time";
          "Ending Date" := ProdOrderLine."Ending Date";
        end;
      until ProdOrderLine.NEXT = 0;
      UpdateDatetime;
    END;

    LOCAL PROCEDURE MultiLevelMessage@4();
    BEGIN
      MESSAGE(
        Text003 +
        Text005);
    END;

    [External]
    PROCEDURE UpdateDatetime@11();
    BEGIN
      if ("Starting Date" <> 0D) and ("Starting Time" <> 000000T) then
        "Starting Date-Time" := CREATEDATETIME("Starting Date","Starting Time")
      else
        "Starting Date-Time" := 0DT;

      if ("Ending Date" <> 0D) and ("Ending Time" <> 000000T) then
        "Ending Date-Time" := CREATEDATETIME("Ending Date","Ending Time")
      else
        "Ending Date-Time" := 0DT;
    END;

    LOCAL PROCEDURE CreateDim@8(Type1@1000 : Integer;No1@1001 : Code[20]);
    VAR
      TableID@1002 : ARRAY [10] OF Integer;
      No@1003 : ARRAY [10] OF Code[20];
    BEGIN
      TableID[1] := Type1;
      No[1] := No1;
      OnAfterCreateDimTableIDs(Rec,CurrFieldNo,TableID,No);

      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      "Dimension Set ID" :=
        DimMgt.GetRecDefaultDimID(
          Rec,CurrFieldNo,TableID,No,'',"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",0,0);
    END;

    LOCAL PROCEDURE ValidateShortcutDimCode@13(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      OldDimSetID@1002 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");

      if OldDimSetID <> "Dimension Set ID" then begin
        if Status = Status::Finished then
          ERROR(Text011);
        MODIFY;
        if SalesLinesExist then
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      end;
    END;

    [External]
    PROCEDURE Navigate@9();
    VAR
      NavigateForm@1000 : Page Navigate;
    BEGIN
      NavigateForm.SetDoc("Due Date","No.");
      NavigateForm.RUN;
    END;

    [External]
    PROCEDURE CreatePick@7300(AssignedUserID@1009 : Code[50];SortingMethod@1008 : Option;SetBreakBulkFilter@1007 : Boolean;DoNotFillQtyToHandle@1006 : Boolean;PrintDocument@1005 : Boolean);
    VAR
      ProdOrderCompLine@1001 : Record "Prod. Order Component";
      WhseWkshLine@1004 : Record "Whse. Worksheet Line";
      CreatePickFromWhseSource@1002 : Report "Whse.-Source - Create Document";
      ItemTrackingMgt@1003 : Codeunit "Item Tracking Management";
    BEGIN
      ProdOrderCompLine.RESET;
      ProdOrderCompLine.SETRANGE(Status,Status);
      ProdOrderCompLine.SETRANGE("Prod. Order No.","No.");
      if ProdOrderCompLine.FIND('-') then
        repeat
          ItemTrackingMgt.InitItemTrkgForTempWkshLine(
            WhseWkshLine."Whse. Document Type"::Production,ProdOrderCompLine."Prod. Order No.",
            ProdOrderCompLine."Prod. Order Line No.",DATABASE::"Prod. Order Component",
            ProdOrderCompLine.Status,ProdOrderCompLine."Prod. Order No.",
            ProdOrderCompLine."Prod. Order Line No.",ProdOrderCompLine."Line No.");
        until ProdOrderCompLine.NEXT = 0;
      COMMIT;

      TESTFIELD(Status,Status::Released);
      CALCFIELDS("Completely Picked");
      if "Completely Picked" then
        ERROR(Text008);

      ProdOrderCompLine.RESET;
      ProdOrderCompLine.SETRANGE(Status,Status);
      ProdOrderCompLine.SETRANGE("Prod. Order No.","No.");
      ProdOrderCompLine.SETFILTER(
        "Flushing Method",'%1|%2|%3',
        ProdOrderCompLine."Flushing Method"::Manual,
        ProdOrderCompLine."Flushing Method"::"Pick + Forward",
        ProdOrderCompLine."Flushing Method"::"Pick + Backward");
      ProdOrderCompLine.SETRANGE("Planning Level Code",0);
      ProdOrderCompLine.SETFILTER("Expected Quantity",'>0');
      if ProdOrderCompLine.FIND('-') then begin
        CreatePickFromWhseSource.SetProdOrder(Rec);
        CreatePickFromWhseSource.SetHideValidationDialog(HideValidationDialog);
        if HideValidationDialog then
          CreatePickFromWhseSource.Initialize(AssignedUserID,SortingMethod,PrintDocument,DoNotFillQtyToHandle,SetBreakBulkFilter);
        CreatePickFromWhseSource.USEREQUESTPAGE(not HideValidationDialog);
        CreatePickFromWhseSource.RUNMODAL;
        CreatePickFromWhseSource.GetResultMessage(2);
        CLEAR(CreatePickFromWhseSource);
      end else
        if not HideValidationDialog then
          MESSAGE(Text008);
    END;

    [External]
    PROCEDURE SetHideValidationDialog@7301(NewHideValidationDialog@1000 : Boolean);
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    [External]
    PROCEDURE CreateInvtPutAwayPick@29();
    VAR
      WhseRequest@1000 : Record "Warehouse Request";
    BEGIN
      TESTFIELD(Status,Status::Released);

      WhseRequest.RESET;
      WhseRequest.SETCURRENTKEY("Source Document","Source No.");
      WhseRequest.SETFILTER(
        "Source Document",'%1|%2',
        WhseRequest."Source Document"::"Prod. Consumption",
        WhseRequest."Source Document"::"Prod. Output");
      WhseRequest.SETRANGE("Source No.","No.");
      REPORT.RUNMODAL(REPORT::"Create Invt Put-away/Pick/Mvmt",true,false,WhseRequest);
    END;

    LOCAL PROCEDURE GetDefaultBin@50();
    VAR
      WMSManagement@1000 : Codeunit "WMS Management";
    BEGIN
      "Bin Code" := '';
      if "Source Type" <> "Source Type"::Item then
        exit;

      if "Location Code" <> '' then begin
        GetLocation("Location Code");
        if Location."Bin Mandatory" and not Location."Directed Put-away and Pick" then
          "Bin Code" := Location."From-Production Bin Code";
      end;
      if ("Bin Code" = '') and ("Source No." <> '') then
        WMSManagement.GetDefaultBin("Source No.",'',"Location Code","Bin Code");
    END;

    LOCAL PROCEDURE GetLocation@15(LocationCode@1000 : Code[10]);
    BEGIN
      if Location.Code <> LocationCode then
        Location.GET(LocationCode);
    END;

    [External]
    PROCEDURE SetUpdateEndDate@16();
    BEGIN
      UpdateEndDate := true;
    END;

    LOCAL PROCEDURE UpdateEndingDate@17(VAR ProdOrderLine@1000 : Record "Prod. Order Line");
    BEGIN
      if ProdOrderLine.FINDSET(true) then
        repeat
          ProdOrderLine."Due Date" := "Due Date";
          ProdOrderLine.MODIFY;
          CalcProdOrder.SetParameter(true);
          ProdOrderLine."Ending Date" :=
            LeadTimeMgt.PlannedEndingDate(
              ProdOrderLine."Item No.",
              ProdOrderLine."Location Code",
              ProdOrderLine."Variant Code",
              ProdOrderLine."Due Date",
              '',
              2);
          CalcProdOrder.Recalculate(ProdOrderLine,1,true);
          "Starting Date-Time" := CREATEDATETIME("Starting Date","Starting Time");
          "Ending Date-Time" := CREATEDATETIME("Ending Date","Ending Time");
          ProdOrderLine.MODIFY(true);
          ProdOrderLine.CheckEndingDate(CurrFieldNo <> 0);
        until ProdOrderLine.NEXT = 0
    END;

    [External]
    PROCEDURE ShowDocDim@18();
    VAR
      OldDimSetID@1000 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      TESTFIELD("No.");
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2',TABLECAPTION,"No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      if OldDimSetID <> "Dimension Set ID" then begin
        if Status = Status::Finished then
          ERROR(Text011);
        MODIFY;
        if SalesLinesExist then
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      end;
    END;

    LOCAL PROCEDURE SalesLinesExist@14() : Boolean;
    BEGIN
      ProdOrderLine.RESET;
      ProdOrderLine.SETRANGE("Prod. Order No.","No.");
      ProdOrderLine.SETRANGE(Status,Status);
      exit(ProdOrderLine.FINDFIRST);
    END;

    LOCAL PROCEDURE UpdateAllLineDim@34(NewParentDimSetID@1000 : Integer;OldParentDimSetID@1001 : Integer);
    VAR
      NewDimSetID@1002 : Integer;
      OldDimSetID@1003 : Integer;
    BEGIN
      // Update all lines with changed dimensions.

      if NewParentDimSetID = OldParentDimSetID then
        exit;
      if not CONFIRM(Text010) then
        exit;

      ProdOrderLine.RESET;
      ProdOrderLine.SETRANGE("Prod. Order No.","No.");
      ProdOrderLine.SETRANGE(Status,Status);
      ProdOrderLine.LOCKTABLE;
      if ProdOrderLine.FIND('-') then
        repeat
          OldDimSetID := ProdOrderLine."Dimension Set ID";
          NewDimSetID := DimMgt.GetDeltaDimSetID(ProdOrderLine."Dimension Set ID",NewParentDimSetID,OldParentDimSetID);
          if ProdOrderLine."Dimension Set ID" <> NewDimSetID then begin
            ProdOrderLine."Dimension Set ID" := NewDimSetID;
            DimMgt.UpdateGlobalDimFromDimSetID(
              ProdOrderLine."Dimension Set ID",ProdOrderLine."Shortcut Dimension 1 Code",ProdOrderLine."Shortcut Dimension 2 Code");
            ProdOrderLine.MODIFY;
            ProdOrderLine.UpdateProdOrderCompDim(NewDimSetID,OldDimSetID);
          end;
        until ProdOrderLine.NEXT = 0;
    END;

    [Integration]
    LOCAL PROCEDURE OnAfterCreateDimTableIDs@138(VAR ProductionOrder@1000 : Record "Production Order";FieldNo@1001 : Integer;TableID@1003 : ARRAY [10] OF Integer;No@1002 : ARRAY [10] OF Code[20]);
    BEGIN
    END;

    BEGIN
    END.
  }
}

