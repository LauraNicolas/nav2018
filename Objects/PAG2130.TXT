OBJECT Page 2130 O365 Business Info Settings
{
  OBJECT-PROPERTIES
  {
    Date=28.05.17;
    Time=12:00:00;
    Version List=NAVW110.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Business Information;
    DeleteAllowed=No;
    SourceTable=Table79;
    OnInit=BEGIN
             Initialize;
           END;

    OnAfterGetCurrRecord=VAR
                           TempStandardAddress@1000 : TEMPORARY Record 730;
                         BEGIN
                           TempStandardAddress.CopyFromCompanyInformation(Rec);
                           FullAddress := TempStandardAddress.ToString;
                         END;

  }
  CONTROLS
  {
    { 1   ;    ;Container ;
                ContainerType=ContentArea }

    { 11  ;1   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU=Check your business information. This will be shown on your invoice layout. }

    { 10  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the name of your company.;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                NotBlank=Yes;
                SourceExpr=Name }

    { 13  ;2   ;Field     ;
                CaptionML=ENU=Add your logo;
                ToolTipML=ENU=Specifies your company's logo.;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr=Picture;
                OnValidate=BEGIN
                             MODIFY(TRUE);
                           END;
                            }

    { 4   ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="Brand Color Code";
                OnLookup=VAR
                           O365BrandColor@1001 : Record 2121;
                           O365BrandColors@1000 : Page 2158;
                         BEGIN
                           O365BrandColors.LOOKUPMODE := TRUE;
                           IF O365BrandColors.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             O365BrandColors.GETRECORD(O365BrandColor);
                             VALIDATE("Brand Color Code",O365BrandColor.Code);
                           END;
                         END;
                          }

    { 3   ;2   ;Field     ;
                Name=SocialsLink;
                DrillDown=Yes;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr=SocialsLbl;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              PAGE.RUNMODAL(PAGE::"O365 Social Networks");
                            END;

                ShowCaption=No }

    { 2   ;2   ;Field     ;
                CaptionML=ENU=Address;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr=FullAddress;
                OnAssistEdit=VAR
                               TempStandardAddress@1000 : TEMPORARY Record 730;
                             BEGIN
                               CurrPage.SAVERECORD;
                               COMMIT;
                               TempStandardAddress.CopyFromCompanyInformation(Rec);
                               IF PAGE.RUNMODAL(PAGE::"O365 Address",TempStandardAddress) = ACTION::LookupOK THEN BEGIN
                                 GET;
                                 FullAddress := TempStandardAddress.ToString;
                               END;
                             END;

                QuickEntry=FALSE }

    { 25  ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="VAT Registration No." }

    { 9   ;2   ;Field     ;
                ExtendedDatatype=E-Mail;
                ToolTipML=ENU=Specifies your company's email address.;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="E-Mail";
                OnValidate=VAR
                             MailManagement@1000 : Codeunit 9520;
                           BEGIN
                             IF "E-Mail" <> '' THEN
                               MailManagement.CheckValidEmailAddress("E-Mail");
                           END;
                            }

    { 8   ;2   ;Field     ;
                ToolTipML=ENU=Specifies your company's web site.;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="Home Page";
                Visible=FALSE }

    { 7   ;2   ;Field     ;
                ToolTipML=ENU=Specifies your company's phone number.;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr="Phone No." }

  }
  CODE
  {
    VAR
      FullAddress@1000 : Text;
      SocialsLbl@1001 : TextConst 'ENU=Social networks';

    LOCAL PROCEDURE Initialize@3();
    BEGIN
      RESET;
      IF NOT GET THEN BEGIN
        INIT;
        INSERT;
      END;
    END;

    BEGIN
    END.
  }
}

