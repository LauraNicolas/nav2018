OBJECT Page 1881 Sandbox Environment
{
  OBJECT-PROPERTIES
  {
    Date=06.10.17;
    Time=12:00:00;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Sandbox Environment (Preview);
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    PageType=NavigatePage;
    ShowFilter=No;
    OnInit=BEGIN
             LoadTopBanners;
           END;

    OnOpenPage=VAR
                 PermissionManager@1000 : Codeunit 9002;
               BEGIN
                 IF NOT PermissionManager.SoftwareAsAService OR PermissionManager.IsSandboxConfiguration THEN
                   ERROR(EnvironmentErr);
               END;

    ActionList=ACTIONS
    {
      { 2       ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 3       ;1   ;Action    ;
                      Name=Create;
                      CaptionML=ENU=Create;
                      ToolTipML=ENU=Create a sandbox environment.;
                      ApplicationArea=#Basic,#Suite;
                      InFooterBar=Yes;
                      OnAction=VAR
                                 EnvironmentMgt@1000 : Codeunit 9005;
                               BEGIN
                                 IF EnvironmentMgt.IsPROD THEN
                                   HYPERLINK(CreatePRODUrlTxt);
                                 IF EnvironmentMgt.IsTIE THEN
                                   HYPERLINK(CreateTIEUrlTxt);
                                 IF EnvironmentMgt.IsPPE THEN
                                   HYPERLINK(CreatePPEUrlTxt);
                               END;
                                }
      { 4       ;1   ;Action    ;
                      Name=Reset;
                      CaptionML=ENU=Reset;
                      ToolTipML=ENU=Reset the sandbox environment.;
                      ApplicationArea=#Basic,#Suite;
                      InFooterBar=Yes;
                      OnAction=VAR
                                 EnvironmentMgt@1000 : Codeunit 9005;
                               BEGIN
                                 IF EnvironmentMgt.IsPROD THEN
                                   HYPERLINK(ResetPRODUrlTxt);
                                 IF EnvironmentMgt.IsTIE THEN
                                   HYPERLINK(ResetTIEUrlTxt);
                                 IF EnvironmentMgt.IsPPE THEN
                                   HYPERLINK(ResetPPEUrlTxt);
                               END;
                                }
      { 11      ;1   ;Action    ;
                      Name=Open;
                      CaptionML=ENU=Open;
                      ToolTipML=ENU=Open the sandbox environment.;
                      ApplicationArea=#Basic,#Suite;
                      InFooterBar=Yes;
                      OnAction=VAR
                                 EnvironmentMgt@1000 : Codeunit 9005;
                               BEGIN
                                 IF EnvironmentMgt.IsPROD THEN
                                   HYPERLINK(CreatePRODUrlTxt);
                                 IF EnvironmentMgt.IsTIE THEN
                                   HYPERLINK(CreateTIEUrlTxt);
                                 IF EnvironmentMgt.IsPPE THEN
                                   HYPERLINK(CreatePPEUrlTxt);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;    ;Container ;
                CaptionML=ENU="";
                ContainerType=ContentArea }

    { 6   ;1   ;Group     ;
                Visible=TopBannerVisible;
                Editable=FALSE;
                GroupType=Group }

    { 5   ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaResourcesStandard."Media Reference";
                Editable=FALSE;
                ShowCaption=No }

    { 7   ;1   ;Group     ;
                CaptionML=ENU="";
                GroupType=Group;
                InstructionalTextML=ENU=In addition to your production environment, you can create an environment for sandbox activities, such as test, demonstration, or development. }

    { 8   ;1   ;Group     ;
                CaptionML=ENU="";
                GroupType=Group;
                InstructionalTextML=ENU=A new sandbox environment (preview) only contains the CRONUS demonstration company. Actions that you perform in the sandbox environment (preview) do not affect data or settings in your production environment. }

    { 12  ;1   ;Group     ;
                CaptionML=ENU="";
                GroupType=Group;
                InstructionalTextML=ENU=This Sandbox environment feature is provided as a free preview solely for testing, development and evaluation. You will not use the Sandbox in a live operating environment. Microsoft may, in its sole discretion, change the Sandbox environment or subject it to a fee for a final, commercial version, if any, or may elect not to release one. }

    { 9   ;1   ;Group     ;
                CaptionML=ENU="";
                GroupType=Group;
                InstructionalTextML=ENU=Choose Create to start a new sandbox environment (preview). }

    { 10  ;1   ;Group     ;
                CaptionML=ENU="";
                GroupType=Group;
                InstructionalTextML=ENU=Choose Reset to clean and restart the sandbox environment (preview). }

  }
  CODE
  {
    VAR
      CreatePRODUrlTxt@1000 : TextConst '@@@={Locked};ENU="https://portal.financials.dynamics.com/?env=sandbox&redirectedFromSignup=false"';
      CreateTIEUrlTxt@1001 : TextConst '@@@={Locked};ENU="https://portal.financials.dynamics-servicestie.com/?env=sandbox&redirectedFromSignup=false"';
      CreatePPEUrlTxt@1002 : TextConst '@@@={Locked};ENU="https://portal.financials.dynamics-tie.com/?env=sandbox&redirectedFromSignup=false"';
      ResetPRODUrlTxt@1005 : TextConst '@@@={Locked};ENU="https://portal.financials.dynamics.com/reset?env=sandbox&redirectedFromSignup=false"';
      ResetTIEUrlTxt@1004 : TextConst '@@@={Locked};ENU="https://portal.financials.dynamics-servicestie.com/reset?env=sandbox&redirectedFromSignup=false"';
      ResetPPEUrlTxt@1003 : TextConst '@@@={Locked};ENU="https://portal.financials.dynamics-tie.com/reset?env=sandbox&redirectedFromSignup=false"';
      MediaRepositoryStandard@1009 : Record 9400;
      MediaRepositoryDone@1008 : Record 9400;
      MediaResourcesStandard@1007 : Record 2000000182;
      MediaResourcesDone@1006 : Record 2000000182;
      TopBannerVisible@1010 : Boolean;
      EnvironmentErr@1011 : TextConst 'ENU=This feature is only available in the online production version of the product.';

    LOCAL PROCEDURE LoadTopBanners@40();
    BEGIN
      IF MediaRepositoryStandard.GET('AssistedSetup-NoText-400px.png',FORMAT(CURRENTCLIENTTYPE)) AND
         MediaRepositoryDone.GET('AssistedSetupDone-NoText-400px.png',FORMAT(CURRENTCLIENTTYPE))
      THEN
        IF MediaResourcesStandard.GET(MediaRepositoryStandard."Media Resources Ref") AND
           MediaResourcesDone.GET(MediaRepositoryDone."Media Resources Ref")
        THEN
          TopBannerVisible := MediaResourcesDone."Media Reference".HASVALUE;
    END;

    BEGIN
    END.
  }
}

