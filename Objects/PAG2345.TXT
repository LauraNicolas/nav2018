OBJECT Page 2345 BC O365 PayPal Std. Settings
{
  OBJECT-PROPERTIES
  {
    Date=06.10.17;
    Time=12:00:00;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=PayPal;
    LinksAllowed=No;
    SourceTable=Table7860;
    PageType=CardPart;
    ShowFilter=No;
    OnOpenPage=BEGIN
                 // Initialized via a subscriber in codeunit 1070 if it is loaded
                 OnOpenPageInit(Rec);
               END;

    OnModifyRecord=VAR
                     SalesHeader@1000 : Record 36;
                   BEGIN
                     HideAllDialogs;
                     IF "Account ID" <> '' THEN BEGIN
                       VALIDATE(Enabled,TRUE);
                       VALIDATE("Always Include on Documents",TRUE);
                       MODIFY(TRUE);
                     END ELSE BEGIN
                       VALIDATE(Enabled,FALSE);
                       MODIFY(TRUE);
                     END;

                     SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Invoice);
                     IF  SalesHeader.FINDSET(TRUE,FALSE) THEN
                       REPEAT
                         SalesHeader.SetDefaultPaymentServices;
                         SalesHeader.MODIFY
                       UNTIL SalesHeader.NEXT = 0;
                   END;

    OnAfterGetCurrRecord=BEGIN
                           AccountID := "Account ID";
                         END;

  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                CaptionML=ENU=PayPal Information;
                GroupType=Group;
                InstructionalTextML=ENU=Enter your email address for PayPal payments. All invoices that are paid through PayPal will be marked as paid automatically. }

    { 3   ;1   ;Field     ;
                ExtendedDatatype=E-Mail;
                CaptionML=ENU=PayPal Email;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr=AccountID;
                OnValidate=VAR
                             PayPalURL@1000 : Text;
                           BEGIN
                             HideAllDialogs;
                             VALIDATE("Account ID",AccountID);

                             IF STRPOS(AccountID,SandboxPrefixTok) = 1 THEN
                               IF CONFIRM(PayPalSandBoxModeQst) THEN BEGIN
                                 FIND;
                                 OnGetPayPalSandboxURL(PayPalURL);
                                 SetTargetURL(PayPalURL);
                                 EXIT;
                               END;

                             OnGetPayPalTargetURL(PayPalURL);
                             SetTargetURL(PayPalURL);
                           END;
                            }

    { 4   ;1   ;Field     ;
                Name=Terms of Service;
                ApplicationArea=#Basic,#Suite,#Invoicing;
                SourceExpr=TermsOfServiceLbl;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              HYPERLINK("Terms of Service");
                            END;

                ShowCaption=No }

  }
  CODE
  {
    VAR
      AccountID@1001 : Text[250];
      TermsOfServiceLbl@1002 : TextConst 'ENU=Terms of service';
      SandboxPrefixTok@1003 : TextConst '@@@={Locked};ENU=sandbox.';
      PayPalSandBoxModeQst@1004 : TextConst 'ENU=Do you want to enable PayPal Sandbox setup?';

    [Integration]
    LOCAL PROCEDURE OnOpenPageInit@1(VAR MSPayPalStandardAccount@1000 : Record 7860);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnGetPayPalSandboxURL@3(VAR SandboxURL@1000 : Text);
    BEGIN
    END;

    [Integration]
    LOCAL PROCEDURE OnGetPayPalTargetURL@4(VAR TargetURL@1000 : Text);
    BEGIN
    END;

    BEGIN
    END.
  }
}

