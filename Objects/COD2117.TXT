OBJECT Codeunit 2117 Coupons Sync
{
  OBJECT-PROPERTIES
  {
    Date=06.10.17;
    Time=12:00:00;
    Version List=NAVW111.0;
  }
  PROPERTIES
  {
    TableNo=36;
    OnRun=BEGIN
            RenewCouponsAndShowNotificationForDocument(Rec);
          END;

  }
  CODE
  {
    VAR
      GraphIntContact@1000 : Codeunit 5461;
      CouponsManagement@1001 : Codeunit 2116;

    PROCEDURE RenewCouponsAndShowNotificationForDocument@6(SalesHeader@1000 : Record 36) : Boolean;
    VAR
      Customer@1004 : Record 18;
      GraphContactID@1008 : Text[250];
    BEGIN
      IF NOT Customer.GET(SalesHeader."Sell-to Customer No.") THEN
        EXIT;

      IF NOT GraphIntContact.FindGraphContactIdFromCustomerNo(GraphContactID,SalesHeader."Sell-to Customer No.") THEN
        EXIT;

      CouponsManagement.GetCouponsForGraphContactId(GraphContactID);

      EXIT(CouponsManagement.ShowNotificationIfAnyNotApplied(SalesHeader,GraphContactID,Customer.Name));
    END;

    BEGIN
    END.
  }
}

