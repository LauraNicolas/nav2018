OBJECT Page 321 ECSL Report
{
  OBJECT-PROPERTIES
  {
    Date=28.05.17;
    Time=12:00:00;
    Version List=NAVW110.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=ECSL Report;
    LinksAllowed=No;
    SourceTable=Table740;
    SourceTableView=WHERE(VAT Report Config. Code=FILTER(EC Sales List));
    PageType=Document;
    ShowFilter=No;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 16      ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions;
                      Image=Action }
      { 22      ;2   ;Action    ;
                      Name=SuggestLines;
                      CaptionML=ENU=Suggest Lines;
                      ToolTipML=ENU=Create EC Sales List entries based on information gathered from sales-related documents.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=SuggestLines;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 UpdateSubForm;
                                 // VATReportMediator.GetLines(Rec);
                               END;
                                }
      { 28      ;2   ;Action    ;
                      Name=Submit;
                      CaptionML=ENU=Submit;
                      ToolTipML=ENU=Submits the EC Sales List report to the tax authority's reporting service.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=SendElectronicDocument;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 VATReportMediator.Export(Rec);
                                 MESSAGE(ReportSubmittedMsg);
                               END;
                                }
      { 19      ;2   ;Action    ;
                      Name=Mark as Submitted;
                      CaptionML=ENU=Mark as Su&bmitted;
                      ToolTipML=ENU=Indicate that the tax authority has approved and returned the report.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Approve;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 VATReportMediator.Submit(Rec);
                                 MESSAGE(MarkAsSubmittedMsg);
                               END;
                                }
      { 25      ;2   ;Action    ;
                      Name=Cancel Submission;
                      CaptionML=ENU=Cancel Submission;
                      ToolTipML=ENU=Cancels previously submitted report.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Cancel;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 VATReportMediator.Reopen(Rec);
                                 MESSAGE(CancelReportSentMsg);
                               END;
                                }
      { 27      ;2   ;Action    ;
                      Name=Log Entries;
                      CaptionML=ENU=Log Entries;
                      ToolTipML=ENU=View a history of communications with the tax authority.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=ErrorLog;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 // MESSAGE('Show errors');
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Name=Release;
                      CaptionML=ENU=Release;
                      ToolTipML=ENU=Verify that the report includes all of the required information, and prepare it for submission.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 // MESSAGE('Release');
                               END;
                                }
      { 31      ;2   ;Action    ;
                      Name=Reopen;
                      CaptionML=ENU=Reopen;
                      ToolTipML=ENU=Open the report again to make changes.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 // MESSAGE('Reopen');
                               END;
                                }
      { 33      ;1   ;Action    ;
                      Name=Print;
                      CaptionML=ENU=&Print;
                      ToolTipML=ENU=Prepare the report for printing by specifying the information it will include.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 VATReportMediator.Print(Rec);
                               END;
                                }
      { 7       ;1   ;Action    ;
                      Name=Report Setup;
                      CaptionML=ENU=Report Setup;
                      ToolTipML=ENU=Specifies the setup that will be used for the VAT reports submission.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 743;
                      Image=Setup }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 2   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the unique identifier for the report.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No.";
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the appropriate configuration code.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Report Config. Code";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the original VAT report if the VAT Report Type field is set to a value other than Standard.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Original Report No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=ENU=Specifies whether the report is in progress, is completed, or contains errors.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Status }

    { 3   ;2   ;Field     ;
                Name=ViewErrors;
                CaptionML=ENU=View Errors;
                ToolTipML=ENU=Specifies the link to a page where you can view errors that the tax authority found in the report.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=ViewErrors;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                Name=DateFilter;
                CaptionML=ENU=Date Filter;
                ToolTipML=ENU=Specifies the dates to use to filter the amounts.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=DateFilter;
                Visible=FALSE;
                OnValidate=VAR
                             ApplicationManagement@1000 : Codeunit 1;
                           BEGIN
                             IF ApplicationManagement.MakeDateFilter(DateFilter) = 0 THEN;
                             // SETFILTER("Date Filter",DateFilter);
                             CurrPage.UPDATE;
                           END;
                            }

    { 15  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the year of the reporting period.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Period No." }

    { 38  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the length of the reporting period.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Period Type" }

    { 20  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the specific reporting period to use.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Period Year";
                LookupPageID=Date Lookup }

    { 8   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the first date of the reporting period.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Start Date";
                Importance=Additional;
                OnValidate=BEGIN
                             ClearPeriod;
                           END;
                            }

    { 10  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the last date of the reporting period.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="End Date";
                Importance=Additional;
                OnValidate=BEGIN
                             ClearPeriod;
                           END;
                            }

    { 13  ;1   ;Part      ;
                Name=ECSLReportLines;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page322 }

    { 6   ;0   ;Container ;
                Name=Error Messages;
                ContainerType=FactBoxArea }

    { 5   ;1   ;Part      ;
                Name=ErrorMessagesPart;
                CaptionML=ENU=Errors and Warnings;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page701;
                PartType=Page }

  }
  CODE
  {
    VAR
      VATReportMediator@1000 : Codeunit 740;
      DateFilter@1003 : Text[30];
      ViewErrors@1004 : Text;
      ReportSubmittedMsg@1002 : TextConst 'ENU=The report has been successfully submitted.';
      CancelReportSentMsg@1005 : TextConst 'ENU=The cancel request has been sent.';
      MarkAsSubmittedMsg@1006 : TextConst 'ENU=The report has been marked as submitted.';

    LOCAL PROCEDURE UpdateSubForm@3();
    BEGIN
      // VATStatementName.FINDFIRST;
      // VATStatementName.SETFILTER("Date Filter",DateFilter);
      // CurrPage.VATReportLines.PAGE.UpdateForm(VATStatementName,Selection,PeriodSelection,UseAmtsInAddCurr);

      // TO DO - Update ECSL
    END;

    LOCAL PROCEDURE ClearPeriod@99();
    BEGIN
      "Period No." := 0;
      "Period Type" := "Period Type"::" ";
    END;

    BEGIN
    END.
  }
}

