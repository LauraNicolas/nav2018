OBJECT Page 740 VAT Report
{
  OBJECT-PROPERTIES
  {
    Date=28.05.17;
    Time=12:00:00;
    Version List=NAVW110.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=VAT Report;
    LinksAllowed=No;
    SourceTable=Table740;
    PageType=Document;
    OnInit=BEGIN
             ErrorsExist := TRUE;
           END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 16      ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions;
                      Image=Action }
      { 22      ;2   ;Action    ;
                      Name=SuggestLines;
                      CaptionML=ENU=Suggest Lines;
                      ToolTipML=ENU="Create VAT Report entries based on information gathered from documents related to sales and purchases. ";
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=SuggestLines;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 VATReportMediator.GetLines(Rec);
                               END;
                                }
      { 27      ;2   ;Action    ;
                      Name=Submit;
                      CaptionML=ENU=Submit;
                      ToolTipML=ENU=Submits the VAT Report to the tax authority's reporting service.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=SendElectronicDocument;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 VATReportMediator.Export(Rec);
                                 MESSAGE(ReportSubmittedMsg);
                               END;
                                }
      { 19      ;2   ;Action    ;
                      Name=Mark as Submitted;
                      CaptionML=ENU=Mark as Submitted;
                      ToolTipML=ENU=Indicate that you submitted the report to the tax authority manually.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Approve;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 VATReportMediator.Submit(Rec);
                                 MESSAGE(MarkAsSubmittedMsg);
                               END;
                                }
      { 17      ;2   ;Action    ;
                      Name=Cancel Submission;
                      CaptionML=ENU=Cancel Submission;
                      ToolTipML=ENU=Cancels previously submitted report.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Cancel;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 VATReportMediator.Reopen(Rec);
                                 MESSAGE(CancelReportSentMsg);
                               END;
                                }
      { 24      ;2   ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=ENU=Release;
                      ToolTipML=ENU=Verify that the report includes all of the required information, and prepare it for submission.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 VATReportMediator.Release(Rec);
                               END;
                                }
      { 25      ;2   ;Action    ;
                      Name=Reopen;
                      CaptionML=ENU=Reopen;
                      ToolTipML=ENU=Open the report again to make changes.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 VATReportMediator.Reopen(Rec);
                               END;
                                }
      { 3       ;2   ;Action    ;
                      Name=Log Entries;
                      CaptionML=ENU=Log Entries;
                      ToolTipML=ENU=View a history of communications with the tax authority.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=ErrorLog;
                      PromotedCategory=Process;
                      PromotedOnly=Yes }
      { 33      ;1   ;Action    ;
                      Name=Print;
                      CaptionML=ENU=Print;
                      ToolTipML=ENU=Prepare the report for printing by specifying the information it will include.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=FALSE;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 VATReportMediator.Print(Rec);
                               END;
                                }
      { 12      ;1   ;Action    ;
                      Name=Report Setup;
                      CaptionML=ENU=Report Setup;
                      ToolTipML=ENU=Specifies the setup that will be used for the VAT reports submission.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 743;
                      Image=Setup }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 2   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the unique identifier for the report.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No.";
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the appropriate configuration code.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Report Config. Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=ENU=Specifies if the VAT report is a standard report, or if it is related to a previously submitted VAT report.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Report Type";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the number of a related VAT report, for example, if you are supplementing the current submission, or correcting an earlier submission.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Original Report No.";
                Visible=FALSE }

    { 11  ;2   ;Field     ;
                CaptionML=ENU=Include VAT entries;
                ToolTipML=ENU=Specifies whether to include VAT entries based on their status. For example, Open is useful when submitting for the first time, Open and Closed is useful when resubmitting.;
                OptionCaptionML=ENU=Open,Closed,Open and Closed;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Selection }

    { 9   ;2   ;Field     ;
                CaptionML=ENU=Include VAT entries;
                ToolTipML=ENU="Specifies whether to include VAT entries only from the specified period, or also from previous periods within the specified year. ";
                OptionCaptionML=ENU=Before and Within Period,Within Period;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=PeriodSelection }

    { 14  ;2   ;Field     ;
                ToolTipML=ENU=Specifies whether the report is in progress, is completed, or contains errors.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Status }

    { 35  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the year of the reporting period.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Period Year";
                LookupPageID=Date Lookup }

    { 34  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the length of the reporting period.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Period Type" }

    { 15  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the specific reporting period to use.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Period No." }

    { 8   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the first date of the reporting period.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Start Date";
                Importance=Additional }

    { 10  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the last date of the reporting period.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="End Date";
                Importance=Additional }

    { 13  ;1   ;Part      ;
                Name=VATReportLines;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page742 }

    { 5   ;0   ;Container ;
                ContainerType=FactBoxArea }

    { 7   ;1   ;Part      ;
                ApplicationArea=#Basic,#Suite;
                PagePartID=Page701;
                Visible=ErrorsExist;
                PartType=Page }

  }
  CODE
  {
    VAR
      VATReportMediator@1000 : Codeunit 740;
      ErrorsExist@1001 : Boolean;
      Selection@1003 : 'Open,Closed,Open and Closed';
      PeriodSelection@1002 : 'Before and Within Period,Within Period';
      ReportSubmittedMsg@1006 : TextConst 'ENU=The report has been successfully submitted.';
      CancelReportSentMsg@1005 : TextConst 'ENU=The cancel request has been sent.';
      MarkAsSubmittedMsg@1004 : TextConst 'ENU=The report has been marked as submitted.';

    BEGIN
    END.
  }
}

